"use strict";var asyncRetry=require("async-retry"),EventEmitter=require("events"),lodash=require("lodash"),cliColor=(require("dotenv/config"),require("cli-color")),fs=require("fs"),path=require("path"),mkdirp=require("mkdirp"),getAppDataPath=require("appdata-path"),level=require("level"),hash=require("object-hash"),gpt3Encoder=require("gpt-3-encoder"),openai=require("openai"),titleCase=require("title-case"),excelJs=require("exceljs"),extract=require("extract-zip"),walkdir=require("walkdir"),esprima=require("esprima"),PrettyError=require("pretty-error"),crypto=require("crypto"),childProcess=require("child_process"),stream=require("stream"),deepAssign=require("deep-assign"),parseCSV=require("csv-parser"),pdf=require("pdf-parse"),pdfLib=require("pdf-lib"),sentenceSplitter=require("sentence-splitter"),strip=require("strip-comments");function __awaiter(e,i,n,s){return new(n=n||Promise)(function(t,r){function fulfilled(e){try{step(s.next(e))}catch(e){r(e)}}function rejected(e){try{step(s.throw(e))}catch(e){r(e)}}function step(e){e.done?t(e.value):function adopt(t){return t instanceof n?t:new n(function(e){e(t)})}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,i||[])).next())})}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&i>=e.length?void 0:e)&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){var n,s,o;if(Symbol.asyncIterator)return n=r.apply(e,t||[]),s=[],o={},verb("next"),verb("throw"),verb("return"),o[Symbol.asyncIterator]=function(){return this},o;throw new TypeError("Symbol.asyncIterator is not defined.");function verb(i){n[i]&&(o[i]=function(r){return new Promise(function(e,t){1<s.push([i,r,e,t])||resume(i,r)})})}function resume(e,t){try{!function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(s[0][2],e)}(n[e](t))}catch(e){settle(s[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),s.shift(),s.length&&resume(s[0][0],s[0][1])}}function __asyncValues(n){var e,t;if(Symbol.asyncIterator)return(e=n[Symbol.asyncIterator])?e.call(n):(n="function"==typeof __values?__values(n):n[Symbol.iterator](),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);throw new TypeError("Symbol.asyncIterator is not defined.");function verb(i){t[i]=n[i]&&function(r){return new Promise(function(e,t){(function settle(t,e,r,i){Promise.resolve(i).then(function(e){t({value:e,done:r})},e)})(e,t,(r=n[i](r)).done,r.value)})}}}function arrSortedInsertionIndex(e,t,r){let i=0,n=e.length;for(;0<n;){var s=Math.trunc(n/2),o=i+s;r(e[o],t)<=0?(i=++o,n-=s+1):n=s}return i}class PriorityQueue{constructor(){this.queue=[]}get size(){return this.queue.length}enqueue(e,t){e={priority:(t=Object.assign({priority:0},t)).priority,run:e};this.size&&this.queue[this.size-1].priority>=t.priority?this.queue.push(e):(t=arrSortedInsertionIndex(this.queue,e,(e,t)=>t.priority-e.priority),this.queue.splice(t,0,e))}dequeue(){var e=this.queue.shift();return null==e?void 0:e.run}filter(t){return this.queue.filter(e=>e.priority===t.priority).map(e=>e.run)}}class PromiseQueue extends EventEmitter{constructor(e){var t;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pending=0,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue},e)).intervalCap&&1<=e.intervalCap))throw new TypeError(`Expected 'intervalCap' to be a number from 1 and up, got '${null!=(t=null==(t=e.intervalCap)?void 0:t.toString())?t:""}' (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&0<=e.interval))throw new TypeError(`Expected 'interval' to be a finite number >= 0, got '${null!=(t=null==(t=e.interval)?void 0:t.toString())?t:""}' (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pending<this._concurrency}_next(){this._pending--,this._tryToStartAnother(),this.emit("next")}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}get _isIntervalPaused(){var e=Date.now();if(void 0===this._intervalId){e=this._intervalEnd-e;if(!(e<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},e)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pending:0}return!1}_tryToStartAnother(){if(0===this._queue.size)this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this.emit("empty"),0===this._pending&&this.emit("idle");else if(!this._isPaused){var e,t=!this._isIntervalPaused;if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother)return!!(e=this._queue.dequeue())&&(this.emit("active"),e(),t&&this._initializeIntervalIfNeeded(),!0)}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pending&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pending:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&1<=e))throw new TypeError(`Expected 'concurrency' to be a number from 1 and up, got '${e}' (${typeof e})`);this._concurrency=e,this._processQueue()}_throwOnAbort(r){return __awaiter(this,void 0,void 0,function*(){return new Promise((e,t)=>{r.addEventListener("abort",()=>{t(new Error("The task was aborted."))},{once:!0})})})}add(s,o={}){return __awaiter(this,void 0,void 0,function*(){return o=Object.assign({},o),new Promise((i,n)=>{this._queue.enqueue(()=>__awaiter(this,void 0,void 0,function*(){var t;this._pending++,this._intervalCount++;try{if(null!=(t=o.signal)&&t.aborted)throw new Error("The task was aborted.");let e=s({signal:o.signal});var r=yield e=o.signal?Promise.race([e,this._throwOnAbort(o.signal)]):e;i(r),this.emit("completed",r)}catch(e){n(e),this.emit("error",e)}finally{this._next()}}),o),this.emit("add"),this._tryToStartAnother()})})}addAll(e,t){return __awaiter(this,void 0,void 0,function*(){return Promise.all(e.map(e=>__awaiter(this,void 0,void 0,function*(){return this.add(e,t)})))})}start(){return this._isPaused&&(this._isPaused=!1,this._processQueue()),this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}onEmpty(){return __awaiter(this,void 0,void 0,function*(){0!==this._queue.size&&(yield this._onEvent("empty"))})}onSizeLessThan(e){return __awaiter(this,void 0,void 0,function*(){this._queue.size<e||(yield this._onEvent("next",()=>this._queue.size<e))})}onIdle(){return __awaiter(this,void 0,void 0,function*(){0===this._pending&&0===this._queue.size||(yield this._onEvent("idle"))})}_onEvent(r,i){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>{const t=()=>{i&&!i()||(this.off(r,t),e())};this.on(r,t)})})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pending}get isPaused(){return this._isPaused}}function funSetName(e,t){return Object.defineProperty(t,"name",{value:e,configurable:!0}),t}function funAsyncRateLimit(t,e={}){const r=new PromiseQueue(e);e=funSetName(t.name,function(...e){return __awaiter(this,void 0,void 0,function*(){return yield r.add(()=>__awaiter(this,void 0,void 0,function*(){return yield t.call(r,...e)}))})});return[r,e]}const MS_IN_DAY=864e5;function isoDateTimestampForFilename(e=new Date){return e.toISOString().replace(/[-:T.]/g,"-").replace("Z","")}function createDirectory(e){return __awaiter(this,void 0,void 0,function*(){return yield mkdirp.mkdirp(e),e})}function appendLineToFile(e,t,r=!1){return __awaiter(this,void 0,void 0,function*(){fs.existsSync(e)||(yield createDirectory(path.dirname(e)),yield fs.promises.writeFile(e,"")),yield fs.promises.appendFile(e,r?"\n"+t:t+"\n")})}function cleanDirectorySync(e,t){for(const i of fs.readdirSync(e)){var r=path.join(e,i);t(r,fs.statSync(r))&&fs.unlinkSync(r)}}function createDirectorySync(e){return mkdirp.mkdirpSync(e),e}function strRepeat(e,t){return new Array(t).fill(e).join("")}function isObject(e){return null!==e&&"object"==typeof e}exports.LogLevel=void 0,function(e){e.NONE="none",e.DEBUG="debug",e.INFO="info",e.WARN="warn",e.ERROR="error"}(exports.LogLevel||(exports.LogLevel={}));class Logger{constructor(e={}){var t=Logger.optionDefaults,t=Object.assign(Object.assign({},t),e);this.debugColor=t.debugColor,this.infoColor=t.infoColor,this.warnColor=t.warnColor,this.errorColor=t.errorColor,this.consoleLogLevel=t.consoleLogLevel,this.debugToConsole=this.consoleLogLevel===exports.LogLevel.DEBUG,this.infoToConsole=this.debugToConsole||this.consoleLogLevel===exports.LogLevel.INFO,this.warnToConsole=this.infoToConsole||this.consoleLogLevel===exports.LogLevel.WARN,this.errorToConsole=this.warnToConsole||this.consoleLogLevel===exports.LogLevel.ERROR,this.fileLogLevel=t.fileLogLevel,this.debugToFile=this.fileLogLevel===exports.LogLevel.DEBUG,this.infoToFile=this.debugToFile||this.fileLogLevel===exports.LogLevel.INFO,this.warnToFile=this.infoToFile||this.fileLogLevel===exports.LogLevel.WARN,this.errorToFile=this.warnToFile||this.fileLogLevel===exports.LogLevel.ERROR,this.logDirpath=path.resolve(t.logDirpath),this.fileLogLevel!==exports.LogLevel.NONE&&createDirectorySync(this.logDirpath),this.logFilepath=path.join(this.logDirpath,isoDateTimestampForFilename()+".txt"),this.deleteLogFiles(t.deleteFilesOlderThan),this.fileLogLevel!==exports.LogLevel.NONE&&this.info("Log file created.")}initialize(e={}){Object.assign(this,new Logger(e))}debug(e,t){return this.debugToFile&&this._logToFile(exports.LogLevel.DEBUG,e),this.debugToConsole&&this._logToConsole(exports.LogLevel.DEBUG,e,this.debugColor,t),e}info(e,t){return this.infoToFile&&this._logToFile(exports.LogLevel.INFO,e),this.infoToConsole&&this._logToConsole(exports.LogLevel.INFO,e,this.infoColor,t),e}warn(e,t){return this.warnToFile&&this._logToFile(exports.LogLevel.WARN,e),this.warnToConsole&&this._logToConsole(exports.LogLevel.WARN,e,this.warnColor,t),e}error(e,t){return this.errorToFile&&this._logToFile(exports.LogLevel.ERROR,e),this.errorToConsole&&this._logToConsole(exports.LogLevel.ERROR,e,this.errorColor,t),e}task(r,i){return __awaiter(this,void 0,void 0,function*(){this.info(`Began: ${r}.`);var e=Date.now(),t=yield i();return this.debug(`Ended: ${r}. (${((Date.now()-e)/1e3).toString()} seconds)`),t})}taskSync(e,t){this.info(`Began: ${e}.`);var r=Date.now(),t=t();return this.debug(`Ended: ${e}. (${((Date.now()-r)/1e3).toString()} seconds)`),t}deleteLogFiles(r=0){0!==r&&fs.existsSync(this.logDirpath)&&cleanDirectorySync(this.logDirpath,(e,t)=>{t=(Date.now()-t.ctimeMs)/MS_IN_DAY;return r<t})}newline(e=10){console.log(strRepeat("\n",e))}dashline(t=1,e=80){var r=cliColor.blackBright(strRepeat("-",e));for(let e=0;e<t;e++)console.log(r)}logEmitterEvents(e,t={}){const{eventNamePrefix:i,debug:r,info:n,warn:s,error:o}=t;for(const[a,l]of Object.entries({debug:r,info:n,warn:s,error:o}))if(l)for(const u of l)e.on(u,(e,t,r)=>{this[a](Object.assign({type:i,info:e},isObject(t)?t:void 0===t?{}:{data:t}))})}_logToFile(e,t){var r=(new Date).toISOString(),t=JSON.stringify({message:t}),e=e.padEnd(5," ")+`|${r}|`+t;appendLineToFile(this.logFilepath,e,!1).catch(e=>{console.error(e)})}_logToConsole(t,r,i,e){var n=t===exports.LogLevel.WARN?console.warn:t===exports.LogLevel.ERROR?console.error:console.log;if(isObject(r))n(`[${i(t)}]:`),void 0!==e?console.dir(r,{depth:e}):n(r);else{let e=r+"";e.includes("\n")&&(e="\n"+e),n(`[${i(t)}]: `+i(e)+"")}}getProperties(){return{consoleLogLevel:this.consoleLogLevel,debugToConsole:this.debugToConsole,infoToConsole:this.infoToConsole,warnToConsole:this.warnToConsole,errorToConsole:this.errorToConsole,fileLogLevel:this.fileLogLevel,debugToFile:this.debugToFile,infoToFile:this.infoToFile,warnToFile:this.warnToFile,errorToFile:this.errorToFile,logDirpath:this.logDirpath,logFilepath:this.logFilepath,debugColor:this.debugColor,infoColor:this.infoColor,warnColor:this.warnColor,errorColor:this.errorColor}}}Logger.optionDefaults={consoleLogLevel:exports.LogLevel.DEBUG,fileLogLevel:exports.LogLevel.NONE,logDirpath:path.join(process.cwd(),"logs"),deleteFilesOlderThan:0,debugColor:cliColor.blackBright,infoColor:cliColor.green,warnColor:cliColor.yellow,errorColor:cliColor.red};const log=new Logger({});function objUpdatePropertyDescriptors(e,t,r){for(const n of t){if(!Object.hasOwn(e,n))throw new Error(`Property, '${n}' does not exist on object.`);var i=r(Object.getOwnPropertyDescriptor(e,n),n);Object.defineProperty(e,n,i)}}function setNonEnumerable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.enumerable=!1,e))}class ApiReponseCache{constructor(e){this.events=new EventEmitter;var e=Object.assign({},ApiReponseCache.optionsDefaults,e),{name:t,dirpath:r,maxAgeMs:i,logAllEvents:n}=e,n=(!0===n?this.logAllEvents():void 0===n&&this.logWarnErrorEvents(),this.emit("options",e),this.maxAgeMs=i,createDirectorySync(path.join(r,t)));this.db=new level.Level(n),setNonEnumerable(this,"db")}hashKey(e){return hash(void 0===e?"undefined":e,{algorithm:"sha1",encoding:"base64"})}getOrElse(r,i){return __awaiter(this,void 0,void 0,function*(){try{var t=yield this.get(r);return this.emit("hit",r),t}catch(e){this.emit("miss",r);t=yield i();return yield this.put(r,t)}})}get(t){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){var e=yield this.db.get(t);return yield this.ensureNotExpired(t,e),this.emit("get",t),this.parseSerializedValue(e)}))})}getSafe(t){return __awaiter(this,void 0,void 0,function*(){try{var e=yield this.db.get(t);return yield this.ensureNotExpired(t,e),this.emit("get",t),this.parseSerializedValue(e)}catch(e){}})}has(e){return __awaiter(this,void 0,void 0,function*(){try{return yield this.db.get(e),!0}catch(e){return!1}})}put(t,r){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){var e=this.serializeValue(r);return yield this.db.put(t,e),this.emit("put",t),r}))})}delete(e){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){yield this.db.del(e),this.emit("delete",e)}))})}deleteExpired(){var i,n,s;return __awaiter(this,void 0,void 0,function*(){try{for(var e,t=!0,r=__asyncValues(this.entries());e=yield r.next(),!(i=e.done);t=!0){e.value;t=!1}}catch(e){n={error:e}}finally{try{t||i||!(s=r.return)||(yield s.call(r))}finally{if(n)throw n.error}}return this})}deleteEverything(){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){yield this.db.clear(),this.emit("delete","All cache data was deleted.")}))})}entries(){return __asyncGenerator(this,arguments,function*entries_1(){var e,t,r,i;try{try{for(var n,s=!0,o=__asyncValues(this.db.iterator());!(e=(n=yield __await(o.next())).done);s=!0){i=n.value,s=!1;const[a,l]=i;this.isExpired(l)&&this.db.del(a).then(()=>this.emit("expired",a)),yield yield __await([a,this.parseSerializedValue(l)])}}catch(e){t={error:e}}finally{try{s||e||!(r=o.return)||(yield __await(r.call(o)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}keys(){return __asyncGenerator(this,arguments,function*keys_1(){var e,t,r;try{try{for(var i,n=!0,s=__asyncValues(this.entries());!(e=(i=yield __await(s.next())).done);n=!0){var o=i.value,n=!1,[a]=o;yield yield __await(a)}}catch(e){t={error:e}}finally{try{n||e||!(r=s.return)||(yield __await(r.call(s)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}values(){return __asyncGenerator(this,arguments,function*values_1(){var e,t,r;try{try{for(var i,n=!0,s=__asyncValues(this.entries());!(e=(i=yield __await(s.next())).done);n=!0){var o=i.value,n=!1,[,a]=o;yield yield __await(a)}}catch(e){t={error:e}}finally{try{n||e||!(r=s.return)||(yield __await(r.call(s)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}size(){var n,s,o;return __awaiter(this,void 0,void 0,function*(){let e=0;try{for(var t,r=!0,i=__asyncValues(this.entries());t=yield i.next(),!(n=t.done);r=!0){t.value;r=!1;e++}}catch(e){s={error:e}}finally{try{r||n||!(o=i.return)||(yield o.call(i))}finally{if(s)throw s.error}}return e})}ensureNotExpired(e,t){return __awaiter(this,void 0,void 0,function*(){if(this.isExpired(t))throw yield this.db.del(e),this.emit("expired",e),new Error("Expired")})}isExpired(e){return!!this.maxAgeMs&&Date.now()-this.parseSerializedTimestamp(e)>this.maxAgeMs}serializeValue(e){return Date.now()+JSON.stringify(e)}parseSerializedTimestamp(e){return parseInt(e.substring(0,13))}parseSerializedValue(e){return JSON.parse(e.substring(13))}orThrow(e){try{return e()}catch(e){throw this.emit("error",e)}}emit(e,t){return this.events.emit(e,t,this),t}logAllEvents(){log.logEmitterEvents(this.events,{debug:["options","put","get"],info:["expired","hit","miss"],warn:["delete"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}logWarnErrorEvents(){log.logEmitterEvents(this.events,{warn:["delete"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}}ApiReponseCache.optionsDefaults={name:"default",dirpath:getAppDataPath("ApiReponseCache"),maxAgeMs:0,logAllEvents:void 0};class AbstractApiClient{constructor(e={}){this.events=new EventEmitter,this.retryDefaults={minTimeout:1e3,retries:5,factor:2.5,randomize:!0},this.cacheDefaults={overwrite:!1},null!=(t=null==(e=this.handleOptions(e))?void 0:e.cache)&&t.enable&&(this.cache=new ApiReponseCache(e.cache));var[t,e]=funAsyncRateLimit((o=>__awaiter(this,void 0,void 0,function*(){const{apiRequest:i,args:n,retry:e,cache:t}=o;var r=this.handleRetryOptions(e);const s=this.handleCacheOptions(t);r=yield asyncRetry((e,r)=>__awaiter(this,void 0,void 0,function*(){try{return this.cache?(t=this.cache.hashKey({args:n,task:i.toString()}),null!==s&&void 0!==s&&s.overwrite&&(yield this.cache.delete(t)),yield this.cache.getOrElse(t,i)):yield i()}catch(e){var t={attempt:r,error:e,args:n};throw 1<r?this.emit("retry",t):this.emit("error",t),e}}),r);return this.emit("response",{response:r,args:n}),r})).bind(this),e.concurrency);this.queue=t,this.sendRequest=e,this.emit("ready",this)}handleOptions(e){e=lodash.cloneDeep(e);var t=Object.getPrototypeOf(this).constructor;return e.cache||(e.cache={}),e.cache.name||(e.cache.name=t.name),void 0===e.cache.logAllEvents&&(e.cache.logAllEvents=e.logAllEvents),e.concurrency=Object.assign({},t.concurrencyDefaults,e.concurrency),e.logAllEvents?this.logAllEvents():void 0===e.logAllEvents&&this.logWarnErrorEvents(),Object.assign(this.retryDefaults,e.retryDefaults),Object.assign(this.cacheDefaults,e.cacheDefaults),this.emit("options",e),e}handleRetryOptions(e){return e?Object.assign({},this.retryDefaults,e):this.retryDefaults}handleCacheOptions(e){return e?Object.assign({},this.cacheDefaults,e):this.cacheDefaults}emit(e,t){return this.events.emit(e,t,this),t}logAllEvents(){return log.logEmitterEvents(this.events,{debug:["options","ready"],info:["response","retry"],warn:["concurrency"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name}),this}logWarnErrorEvents(){log.logEmitterEvents(this.events,{warn:["concurrency"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}}AbstractApiClient.concurrencyDefaults={concurrency:100,autoStart:!0};const openaiApiErrorCodes=new Map([[401,"Invalid Authentication. Ensure the correct API key and requesting organization are being used."],[429,"Rate limit reached or hard limit quota reached. You can apply for a quota increase."],[500,"The server had an error. Retry your request after a brief wait and contact us if the issue persists. Check the status page."],[503,"The engine is currently overloaded, please try again later. Please retry your requests after a brief wait."]]);function assertInteger(e){if(Number.isInteger(e))return e;throw new TypeError("Expected int to be an integer. Got: "+e)}function randomIntBetween(e,t){return Math.floor(Math.random()*(assertInteger(t)-assertInteger(e)+1)+e)}function objOmitKeysMutable(e,...t){for(const r of t)Reflect.deleteProperty(e,r);return e}class OpenaiApiClient extends AbstractApiClient{constructor(e={}){super(e),this.apiDefaults={completionModel:"text-davinci-003",chat3_8Model:"gpt-3.5-turbo",chat3_16Model:"gpt-3.5-turbo-16k",chat4_8Model:"gpt-4",choicesDelimiter:"\n---------------\n"},this.concurrencyJustReduced=!1;e=e.apiKey||process.env.OPENAI_API_KEY;this.client=new openai.OpenAIApi(new openai.Configuration({apiKey:e}))}completion(e){return __awaiter(this,void 0,void 0,function*(){return yield this._completion(...this.handleCompletionOptions(e))})}gpt3_8k(e){return __awaiter(this,void 0,void 0,function*(){return yield this._chat(...this.handleChatOptions(e))})}gpt3_16k(e){return __awaiter(this,void 0,void 0,function*(){return e.model=this.apiDefaults.chat3_16Model,yield this._chat(...this.handleChatOptions(e))})}gpt4_8k(e){return __awaiter(this,void 0,void 0,function*(){return e.model=this.apiDefaults.chat4_8Model,yield this._chat(...this.handleChatOptions(e))})}transcribe(e){return __awaiter(this,void 0,void 0,function*(){return yield this._transcribe(...this.handleTranscribeOptions(e))})}handleCompletionOptions(e){(e=this.deleteDefaultOrUndefinedOptions(e,{presence_penalty:0,frequency_penalty:0,best_of:1})).model||(e.model=this.apiDefaults.completionModel),e.instruction&&(e.prompt=e.instruction+"\n\n"+e.prompt),e.max_tokens||(t=this.countTokens(e.prompt),e.response_max_tokens?e.max_tokens=t+e.response_max_tokens:e.max_tokens=4096-t);var t=e=objOmitKeysMutable(e,"retry","cache","instruction","response_max_tokens"),r=this.handleRetryOptions(e.retry),e=this.handleCacheOptions(e.cache);return this.emit("request",[t,r,e])}handleChatOptions(e){e=this.deleteDefaultOrUndefinedOptions(e,{presence_penalty:0,frequency_penalty:0});var t=this.handleRetryOptions(e.retry),r=this.handleCacheOptions(e.cache),i=this.apiDefaults.chat3_8Model,n=[],i=(e.instruction&&n.push({role:"system",content:e.instruction}),e.prompt&&n.push({role:"user",content:e.prompt}),e.messages&&n.push(...e.messages),n.length||n.push({role:"user",content:""}),e=objOmitKeysMutable(e,"prompt","instruction","retry","cache"),Object.assign(Object.assign({model:i},e),{messages:n}));return this.emit("request",[i,t,r])}handleTranscribeOptions(e){var t=e.request,r=this.handleRetryOptions(e.retry),e=this.handleCacheOptions(e.cache);return this.emit("request",[t,r,e])}_completion(t,e,r){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){var e=(yield this.client.createCompletion(t))["data"];return this.assertReponseDataComplete(e),this.parseChoices(e.choices).join(this.apiDefaults.choicesDelimiter)}),args:[t],retry:e,cache:r})})}_chat(r,e,t){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){let e;try{var t=yield this.client.createChatCompletion(r);e=t.data}catch(e){this.handleApiError(e)}return this.assertReponseDataComplete(e),this.parseChoices(e.choices)[0]}),args:[r],retry:e,cache:t})})}_transcribe(t,e,r){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){try{var e=(yield this.client.createTranscription(fs.createReadStream(t.filepath),"whisper-1",void 0,t.format,void 0,t.language))["data"];return e.toString().trim()}catch(e){console.error(e.toJSON())}return""}),args:[t],retry:e,cache:r})})}handleApiError(e){var t=e.toJSON(),r=t.status,i=(429===r&&this.lowerConcurrency(),openaiApiErrorCodes.get(r));throw i&&(e=new Error("Error code "+r+": "+i)),this.emit("error",t),e}lowerConcurrency(e=7,t=6,r=9e4){this.concurrencyJustReduced||this.queue.concurrency<=20||(this.concurrencyJustReduced=!0,setTimeout(()=>{this.concurrencyJustReduced=!1},1e3),this.queue.concurrency-=e,this.emit("concurrency","Reducing concurrency to "+this.queue.concurrency+" to prevent rate limiting."),r=randomIntBetween(5e3,r),setTimeout(()=>{this.queue.concurrency+=t,this.emit("concurrency","Trying to raise concurrency again to "+this.queue.concurrency+".")},r))}parseChoices(e){return e.map(e=>Reflect.has(e,"text")?Reflect.get(e,"text").trim():Reflect.has(e,"message")?Reflect.get(e,"message").content.trim():void 0)}deleteDefaultOrUndefinedOptions(e,t={}){e=Object.assign({},e),t.temperature=1,t.top_p=1,t.n=1;for(var[r,i]of Object.entries(t))Reflect.get(e,r)===i&&Reflect.deleteProperty(e,r);for(var[n,s]of Object.entries(e))s||0===s||Reflect.deleteProperty(e,n);return e}assertReponseDataComplete(e){for(const t of e.choices)"stop"!==t.finish_reason&&this.emit("error","Expected finish_reason to be: stop. Got: "+t.finish_reason)}stringTokens(e){return gpt3Encoder.encode(e)}countTokens(e){return gpt3Encoder.encode(e).length}}class OpenaiApiClientExtended extends OpenaiApiClient{constructor(e={}){super(e)}proofread(e,t,r={}){return __awaiter(this,void 0,void 0,function*(){return r.instruction=(r.instruction?r.instruction+"\n\n":"")+`You will be provided with statements, and your task is to convert them to standard ${titleCase.titleCase(e)}.

`+"Respond with the corrected text and nothing else.",yield this.gpt3_8k(Object.assign(Object.assign({temperature:0},r),{prompt:t}))})}proofreadEnglish(e,t={}){return __awaiter(this,void 0,void 0,function*(){return yield this.proofread("English",e,t)})}translateFromTo(e,t,r,i={}){return __awaiter(this,void 0,void 0,function*(){return i.instruction=(i.instruction?i.instruction+"\n\n":"")+`Translate from ${titleCase.titleCase(e)} to ${titleCase.titleCase(t)}.`,yield this.gpt3_8k(Object.assign(Object.assign({temperature:.3},i),{prompt:r}))})}translateEnglishTo(e,t,r={}){return __awaiter(this,void 0,void 0,function*(){return yield this.translateFromTo("English",e,t,r)})}}function arrSum(e){return e.reduce((e,t)=>e+t,0)}function arrAverage(e){if(e.length)return arrSum(e)/e.length;throw new Error("Cannot take an average of zero values.")}function arrEachToString(e){return e.map(e=>""+e)}function arrEvery(r,i){for(let e=0,t=r.length;e<t;e++)if(!1===i(r[e],e,r))return!1;return!0}function arrFindIndicesOf(t,r){var i=[];for(let e=0;e<t.length;e++)r(t[e])&&i.push(e);return i}function arrFindLast(t,r){for(let e=t.length-1;0<=e;e--)if(!0===r(t[e]))return t[e]}function arrFindLastIndexOf(t,r){for(let e=t.length-1;0<=e;e--)if(r(t[e]))return e;return-1}function arrFlatten(e,i=Number.MAX_SAFE_INTEGER){const n=[];return function recurse(t,r){for(let e=0;e<t.length;e++)Array.isArray(t[e])&&r<i?recurse(t[e],r+1):n.push(t[e])}(e,0),n}function arrIndicesOf(t,r){var i=[];for(let e=0;e<t.length;e++)r===t[e]&&i.push(e);return i}function arrLast(e){if(e.length)return e[e.length-1];throw new Error("Cannot get last element of empty array.")}function arrMapMutable(t,r){for(let e=0;e<t.length;e++)t[e]=r(t[e],e,t);return t}function arrObjectsUniqueKeys(e){var t=new Set;for(const r of e)for(const i of Object.keys(r))t.add(i);return Array.from(t)}function arrObjectsToTable(e,t={}){var r,i=(null==(r=null==t?void 0:t.headers)?void 0:r.slice())||arrObjectsUniqueKeys(e),n=[i];for(const o of e){var s=i.map(e=>{e=o[e];return void 0!==e?e:t.emptyCell});n.push(s)}return n}function arrRemoveDuplicates(e){return Array.from(new Set(e))}function arrShallowEquals(e,r){return e.length===r.length&&arrEvery(e,(e,t)=>e===r[t])}function arrSwap(e,t,r){return t!==r&&([e[t],e[r]]=[e[r],e[t]]),e}function arrShuffle(t){if(!(t.length<=1)){var r=t.slice();let e=!0;for(;e;){for(let e=0;e<t.length;e++){var i=randomIntBetween(0,t.length-1);arrSwap(t,e,i)}e=arrShallowEquals(t,r)}}return t}function arrSome(r,i){for(let e=0,t=r.length;e<t;e++)if(!0===i(r[e],e,r))return!0;return!1}function compareNumeric(e,t){return e<t?-1:t<e?1:0}function arrSortNumeric(e){return e.sort(compareNumeric)}function arrTableAssertRowsSameLength(e,t){var r=(t||e[0]).length;for(const i of e)if(i.length!==r)throw new Error(`Expected ${r} columns, got `+i.length)}function arrTableEachToString(e){return e.map(arrEachToString)}function regexEscapeString(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function strReplaceAll(e,t,r,i="g"){return e&&t?e.replace(new RegExp(regexEscapeString(t),i),r):e}function arrTableToCsv(e,t=";",r="|"){return e.map(e=>e.map(e=>strReplaceAll(e+"",t,"").replace(/\r*\n/g,r)).join(t)).join("\n")}function createObjectFactory(n,s){const e=n.length;if(s&&s.length>e)throw new Error("defaultValues length larger than keys length.");return function factory(r){if(r&&r.length>e)throw new Error("values length larger than keys length.");var i={};for(let t=0;t<e;t++){let e;r?void 0===(e=r[t])&&s&&(e=s[t]):s&&(e=s[t]),Object.defineProperty(i,n[t],{enumerable:!0,writable:!0,configurable:!0,value:e})}return i}}function arrTableToObjects(e,t){if(t){if(!e.length)return[]}else{if(e.length<=1)return[];t=e[0].map(e=>null==e?"":String(e)),e=e.slice(1)}const r=createObjectFactory(t);return e.map(e=>r(e))}function asyncTasksLimit(o,a,l){return __awaiter(this,void 0,void 0,function*(){const t=new Set,r=[];let e=0;for(const i of a){const n=e++,s=(t.size===o&&(yield Promise.race(t)),i());t.add(s),s.then(e=>{r[n]=e,l&&l(e,n),t.delete(s)})}return yield Promise.all(t),r})}function asyncTasksParallel(e){return __awaiter(this,void 0,void 0,function*(){return yield Promise.all(e.map(e=>e()))})}function asyncTasksSerial(r){return __awaiter(this,void 0,void 0,function*(){var e=[];for(const t of r)e.push(yield t());return e})}function asyncWithTimeout(e,i){return new Promise((t,r)=>{setTimeout(()=>{r(new Error(`Timed out after ${e} ms.`))},e),i().then(e=>{t(e)},e=>{r(e)})})}function assertPositiveInteger(e){if(Number.isInteger(e)&&0<=e)return e;throw new TypeError("Expected a positive integer. Got: "+e)}function wait(t=0){return new Promise(e=>{assertPositiveInteger(t),setTimeout(e,t)})}function waitSeconds(t=0){return new Promise(e=>{if(t<0)throw new Error("secs must be a positive number");setTimeout(e,Math.floor(1e3*t))})}function atob(e){return Buffer.from(e,"base64")}function btoa(e){return e.toString("base64")}function bytesToInt(n){return 1===n.length&&n[0]<251?n[0]:2===n.length&&251===n[0]?251+n[1]:3===n.length&&252===n[0]?251+256*n[1]+n[2]:4===n.length&&253===n[0]?251+65536*n[1]+256*n[2]+n[3]:5===n.length&&254===n[0]?251+16777216*n[1]+65536*n[2]+256*n[3]+n[4]:(5<n.length&&255===n[0]?()=>{let t=0,r=1;var i=Math.max(2,n.length-6);for(let e=n.length-1;e>=i;e--)t+=r*n[e],r*=256;var e=n[1]+32<251?bytesToInt([n[1]+32])-11:255===n[0]&&n[1]<251?n[1]+21:3===i?bytesToInt([n[1],n[2]+21]):4===i?bytesToInt([n[1],n[2],n[3]+21]):0,e=251+t/Math.pow(2,32-e);if(!Number.isInteger(e))throw new Error(`Invalid bytes. Got [${n.join(", ")}] = `+e);if(1099511627776<e)throw new Error(`Bytes must correspond to an integer less than or equal to 256^5. Got [${n.join(", ")}] = `+e);return e}:()=>{throw new Error(`Invalid first byte. Got length: ${n.length}, and bytes: [${n.join(", ")}]`)})()}function intToArrayBytes(e){var t;return e<256?[e]:(t=new Uint8Array(new Uint32Array([e]).buffer),e<65536?[t[0],t[1]]:e<16777216?[t[0],t[1],t[2]]:e<4294967296?[t[0],t[1],t[2],t[3]]:[256,256,256,256])}function intToBuffer(e){return Buffer.from(intToArrayBytes(e))}function intToBytes(e){if(!Number.isInteger(e)||e<0)throw new Error("input must be a positive integer. Got "+e);if(1099511627776<e)throw new Error("input must be less than or equal to 256^5. Got "+e);const t=e-251;{if(e<251)return[e];if(t<256)return[251,t];if(t<65536)return[252,Math.floor(t/256),t%256];if(t<16777216)return[253,Math.floor(t/65536),Math.floor(t/256)%256,t%256];if(t<4294967296)return[254,Math.floor(t/16777216),Math.floor(t/65536)%256,Math.floor(t/256)%256,t%256];var e,r=[255,...intToBytes(e=Math.floor(Math.log(t)/Math.log(2))-32)],i=Math.floor(t/Math.pow(2,e-11));for(let e=5,t=1099511627776;0<=e;e--,t/=256)r.push(Math.floor(i/t)%256);return r}}function padArrayBytesLeft(e){var t;return e.length?4===(t=e.length)?e:1===t?[0,0,0,e[0]]:2===t?[0,0,e[0],e[1]]:[0,e[0],e[1],e[2]]:[0,0,0,0]}function padArrayBytesRight(e){var t;return e.length?4===(t=e.length)?e:1===t?[e[0],0,0,0]:2===t?[e[0],e[1],0,0]:[e[0],e[1],e[2],0]:[0,0,0,0]}function trimArrayBytesLeft(e){return 0===e[0]?0===e[1]?0===e[2]?[e[3]]:[e[2],e[3]]:[e[1],e[2],e[3]]:e}function trimArrayBytesRight(e){return 0===e[3]?0===e[2]?0===e[1]?[e[0]]:[e[0],e[1]]:[e[0],e[1],e[2]]:e}class Matrix{static fromArray(r){var i=r[0].length,n=new this(r.length,i);for(let t=0;t<r.length;t++){if(r[t].length!==i)throw new Error("All rows must have the same length.");for(let e=0;e<i;e++)n.matrix[t][e]=r[t][e]}return n}static fromIterable(e){var t=[];for(const r of e)t.push([...r]);return this.fromArray(t)}static identity(t){var r=new Matrix(t,t);for(let e=0;e<t;e++)r.matrix[e][e]=1;return r}constructor(t,r){if(this.immutable=!1,t<1)throw new Error("Expected rows to be greater than zero.");if(r<1)throw new Error("Expected cols to be greater than zero.");this.matrix=new Array(t);for(let e=0;e<t;e++)this.matrix[e]=new Array(r).fill(0)}get rows(){return this.matrix.length}get cols(){return this.matrix[0].length}isSameInstanceAs(e){return this===e}getImmutable(){return this.immutable}setImmutable(e){return this.immutable=e,this}deepEquals(e){var r=e instanceof Matrix?e.matrix:e;for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(this.matrix[t][e]!==r[t][e])return!1;return!0}set(e,t,r){var i=this.immutable?this.clone():this;return i.matrix[e][t]=r,i}get(e,t){return this.matrix[e][t]}has(e,t){return e<this.rows&&t<this.cols&&0<=e&&0<=t}toArray(){var t=new Array(this.rows);for(let e=0;e<this.rows;e++)t[e]=this.matrix[e].slice();return t}clone(){var r=new Matrix(this.rows,this.cols);for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)r.matrix[t][e]=this.matrix[t][e];return r}forEach(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(!1===r(this.matrix[t][e],t,e))return this;return this}forEachInRow(t,r){for(let e=0;e<this.cols;e++)if(!1===r(this.matrix[t][e],e))return this;return this}forEachInCol(t,r){for(let e=0;e<this.rows;e++)if(!1===r(this.matrix[e][t],e))return this;return this}forEachInDiagonal(t){for(let e=0;e<Math.min(this.rows,this.cols);e++)if(!1===t(this.matrix[e][e],e,e))return this;return this}map(r){var i=this.immutable?this.clone():this;for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)i.matrix[t][e]=r(this.matrix[t][e],t,e);return i}*[Symbol.iterator](){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)yield this.matrix[t][e]}*values(){yield*this}mapRow(t,r){var i=this.immutable?this.clone():this;for(let e=0;e<this.cols;e++)i.matrix[t][e]=r(this.matrix[t][e],e);return i}mapCol(t,r){var i=this.immutable?this.clone():this;for(let e=0;e<this.rows;e++)i.matrix[e][t]=r(this.matrix[e][t],e);return i}appendRow(e){var t=this.immutable?this.clone():this;if(e){if(e.length!==this.cols)throw new Error("Row must have length "+this.cols)}else e=new Array(this.cols).fill(0);return t.matrix.push(e),t}appendCol(t){var r=this.immutable?this.clone():this;if(t){if(t.length!==this.rows)throw new Error("Col must have length "+this.rows)}else t=new Array(this.rows).fill(0);for(let e=0;e<this.rows;e++)r.matrix[e].push(t[e]);return r}addBy(t){return(this.immutable?this.clone():this).map(e=>e+t)}subtractBy(t){return(this.immutable?this.clone():this).map(e=>e-t)}multiplyBy(t){return(this.immutable?this.clone():this).map(e=>e*t)}divideBy(t){return(this.immutable?this.clone():this).map(e=>e/t)}addRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e+t)}subtractRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e-t)}multiplyRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e*t)}divideRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e/t)}addColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e+t)}subtractColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e-t)}multiplyColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e*t)}divideColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e/t)}swapRows(e,t){var r=this.immutable?this.clone():this,i=r.matrix[e],n=r.matrix[t];return r.matrix[e]=n,r.matrix[t]=i,r}swapCols(t,r){var i=this.immutable?this.clone():this;for(let e=0;e<this.rows;e++){var n=i.matrix[e][t],s=i.matrix[e][r];i.matrix[e][t]=s,i.matrix[e][r]=n}return i}some(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(r(this.matrix[t][e],t,e))return!0;return!1}every(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(!r(this.matrix[t][e],t,e))return!1;return!0}hasDimensions(e,t){return this.rows===e&&this.cols===t}isSquareMatrix(){return this.rows===this.cols}isScalarMatrix(){if(!this.isSquareMatrix())return!1;var t=this.matrix[0][0];for(let e=1;e<this.rows;e++)if(this.matrix[e][e]!==t)return!1;return!0}isZeroMatrix(){return this.every(e=>0===e)}dotProduct(i){if(this.cols!==i.rows)throw new Error("A*B dot product not possible unless the number of columns in A and number of rows in B are the same.");var e=this.rows,n=i.cols,s=this.cols,o=new Matrix(e,n);for(let r=0;r<e;r++)for(let t=0;t<n;t++)for(let e=0;e<s;e++)o.matrix[r][t]+=this.matrix[r][e]*i.matrix[e][t];return o}}class MixinBase{getConstructor(){return Object.getPrototypeOf(this).constructor}getPrototype(){return Object.getPrototypeOf(this)}setNonEnumerableProperties(...e){setNonEnumerable(this,...e)}}class Queue extends MixinBase{constructor(){super(...arguments),this.queue=[]}static from(e){var t=new Queue;return t.queue=[...e],t}static fromJSON(e){return Queue.from(JSON.parse(e))}enqueue(e){return this.queue.push(e),this}dequeue(){var e=this.queue.shift();if(e)return e;throw new Error("Queue is empty")}get size(){return this.queue.length}toArray(){return this.queue.slice()}toJSON(){return this.queue}*[Symbol.iterator](){yield*this.queue}}class SimpleTable extends MixinBase{static fromJSON(e){var{headers:e,data:t}=JSON.parse(e);return new SimpleTable(t,e)}constructor(e,t){if(super(),this._colIndexMap={},this._data=[],t?(this._headers=t.slice(),this._data=e.map(e=>(this.assertRowValidLength(e),e.slice()))):(this._headers=e[0].map(e=>""+e),this._data=e.slice(1).map(e=>(this.assertRowValidLength(e),e.slice()))),!this._headers.length)throw new Error("Table must have at least one column.");if(!this._data.length)throw new Error("Table must have at least one row.");this._headers.forEach((e,t)=>{this._colIndexMap[e]=t})}assertRowValidLength(e){if(e.length!==this._headers.length)throw new Error("Row length does not match headers length.")}get numColumns(){return this._data[0].length}get numRows(){return this._data.length}get headers(){return this._headers.slice()}get data(){return this._data.slice().map(e=>e.slice())}get(e,t){return"string"==typeof e&&(e=this._colIndexMap[e]),this._data[t][e]}set(e,t,r){return"string"==typeof e&&(e=this._colIndexMap[e]),this._data[t][e]=r,this}toArray(){return[this.headers].concat(this.data)}toJSON(){return{headers:this._headers,data:this._data}}}function compareNumber(e,t){return e-t}function compareString(e,t){return e.localeCompare(t)}class SortedArray extends Array{constructor(e={}){if(super(),this.compare=compareString,this.allowDuplicates=!0,setNonEnumerable(this,"compare","allowDuplicates"),e.compare&&(this.compare=e.compare),!1===e.allowDuplicates&&(this.allowDuplicates=!1),e.data){for(const t of this.allowDuplicates?e.data:new Set(e.data))super.push(t);e.compare||"number"!=typeof this[0]||(this.compare=compareNumber),this.sort(this.compare)}}toArray(){return Array.from(this)}add(e){var t,r;return 0===this.length?super.push(e):([t,r]=this.insertionIndex(e),r&&!this.allowDuplicates||super.splice(t,0,e)),this}addMany(...e){if(0!==e.length)for(const t of e)this.add(t);return this}unique(){let i=this.length;if(!(i<=1))for(let e,t,r=1;r<i;r++)e=this[r-1],t=this[r],0===this.compare(e,t)&&(super.splice(r,1),i--,r--);return this}insertionIndex(e){if(0===this.length)return[0,!1];let t=0,r=this.length;for(;t<r;){var i=t+r>>>1,n=this.compare(this[i],e);if(0===n)return[i,!0];n<0?t=1+i:r=i}return[t,!1]}firstInsertionIndex(e){var[t,r]=this.insertionIndex(e);if(!r)return[t,r];let i=t-1;for(;0<=i;){if(0!==this.compare(this[i],e))return[i+1,r];i--}return[0,r]}lastInsertionIndex(e){var[t,r]=this.insertionIndex(e);if(!r)return[t,r];let i=t+1;for(;i<this.length;){if(0!==this.compare(this[i],e))return[i,r];i++}return[this.length,r]}indexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.insertionIndex(e),t?e:-1)}firstIndexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.firstInsertionIndex(e),t?e:-1)}lastIndexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.lastInsertionIndex(e),t?e-1:-1)}indicesOfCompare(t){var r=this.indexOfCompare(t);if(-1===r)return[];var i=[];if(this.allowDuplicates){let e=r-1;for(;0<=e&&0===this.compare(this[e],t);)i.push(e),e--;for(i.push(r),e=r+1;e<this.length&&0===this.compare(this[e],t);)i.push(e),e++;i.sort(compareNumber)}return i}intersection(e){var t=[];let r=0,i=0;for(;r<this.length&&i<e.length;)this.compare(this[r],e[i])<0?r++:(0===this.compare(this[r],e[i])&&(t.push(this[r]),r++),i++);return t}push(...e){return this.addMany(...e),this.length}reverse(){throw new Error("Cannot reverse a SortedArray since it would then no longer be sorted.")}splice(e,t){return super.splice(e,t)}}function isValidDate(e,t,r,i,n,s,o){e=e?Number(e):0,t=t?Number(t):0,r=r?Number(r):0,i=i?Number(i):0,n=n?Number(n):0,s=s?Number(s):0,o=o?Number(o):0;var a=new Date(e,t-1,r,i,n,s,o);return a.getFullYear()===e&&a.getMonth()+1===t&&a.getDate()===r&&a.getHours()===i&&a.getMinutes()===n&&a.getSeconds()===s&&a.getMilliseconds()===o}function assertValidDate(e,t,r,i,n,s,o){if(!isValidDate(e,t,r,i,n,s,o))throw new Error(`Expected valid date. Got: ${JSON.stringify({year:e,month:t,day:r,hour:i,minute:n,second:s,millisecond:o})}.`)}function isValidDateMonth(e){return Number.isInteger(e)&&1<=e&&e<=12}function assertValidDateMonth(e){if(!isValidDateMonth(e))throw new Error(`Invalid month: ${e}.`)}function isValidDateYear(e){return Number.isInteger(e)&&0<=e}function assertValidDateYear(e){if(!isValidDateYear(e))throw new Error(`Invalid year: ${e}.`)}function isLeapYear(e){return assertValidDateYear(e),0==e%4&&0!=e%100||0==e%400}function numDaysInMonth(e,t){assertValidDateMonth(e);return 2===e&&void 0!==t&&isLeapYear(t)?29:[0,31,28,31,30,31,30,31,31,30,31,30,31][e]}function isValidDateDay(e,t,r){return!!Number.isInteger(e)&&!!Number.isInteger(t)&&!(r&&!Number.isInteger(r)||e<1||e>numDaysInMonth(t,r))}function assertValidDateDay(e,t,r){if(!isValidDateDay(e,t,r))throw new Error(`Invalid day of the month: ${e}.`)}const MS_IN_HOUR=36e5,MS_IN_MINUTE=6e4,MS_IN_MONTH=2628e6,MS_IN_SECOND=1e3,MS_IN_WEEK=6048e5,MS_IN_YEAR=31536e6;function dateDaysAgo(e){var t=new Date;return t.setDate(t.getDate()-e),t}function dateWeekDayName(e){return names[e.getDay()]}const names=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function msSinceDate(e){return Date.now()-e.getTime()}function daysSinceDate(e){return msSinceDate(e)/MS_IN_DAY}function getCentury(e){return assertValidDateYear(e),Math.floor(e/100)+1}function getCurrentYear(){return(new Date).getUTCFullYear()}function hoursSinceDate(e){return msSinceDate(e)/MS_IN_HOUR}function isoDateTimestamp(e=new Date){return e.toISOString().replace(/\D/g,"")}function minutesSinceDate(e){return msSinceDate(e)/MS_IN_MINUTE}function monthsSinceDate(e){return msSinceDate(e)/MS_IN_MONTH}function prettyIsoDateString(e,t=" ",r="millisecond"){return e.substring(0,map[r]).replace(/T/,t).replace(/-|:/g,".")}const map={year:4,month:7,day:10,hour:13,minute:16,second:19,millisecond:23};function secondsSinceDate(e){return msSinceDate(e)/MS_IN_SECOND}function weeksSinceDate(e){return msSinceDate(e)/MS_IN_WEEK}function yearsSinceDate(e){return msSinceDate(e)/MS_IN_YEAR}function absoluteToRelativePath(e,t=process.cwd()){return path.normalize(e).replace(new RegExp(regexEscapeString(path.normalize(t)+path.sep),"i"),"")}function normalizeFileExtension(e){if(""===e||"."===e)return"";if(/[<>"|?*:]/g.test(e))throw new Error(`Illegal characters in file extension: ${e}  |  Illegal characters are: <>"|?:*`);return e.includes(".")?e.substring(e.lastIndexOf(".")):"."+e}function createFileExtensionFilter(...r){return r.length?e=>{for(const t of r.map(normalizeFileExtension))if(path.extname(e)===t)return!0;return!1}:()=>!0}function cwdpath(...e){return path.join(process.cwd(),...e)}function deleteDirectory(e){return __awaiter(this,void 0,void 0,function*(){yield fs.promises.rm(e,{recursive:!0,force:!0})})}function deleteDirectorySafe(e){return __awaiter(this,void 0,void 0,function*(){fs.existsSync(e)&&(yield fs.promises.rm(e,{recursive:!0,force:!0}))})}function deleteDirectorySafeSync(e){return fs.existsSync(e)&&fs.rmSync(e,{recursive:!0,force:!0}),e}function deleteDirectorySync(e){return fs.rmSync(e,{recursive:!0,force:!0}),e}function ensureValidWindowsPath(t,r){var e=e=>{if(r&&!0===r.assert)throw new Error(`Invalid windows path. ${e}  |  input received: `+t);return!1};if(0===t.length)return e("Path string is length 0.");if(-1!==t.indexOf("/")&&-1!==t.indexOf("\\"))return e("Path contains both backslash and forward slash.");var i=(r&&r.extendedMaxLength?32767:260)-12;if(t.length>i)return e(`Maximum length of ${i} exceeded`);let n=t;return/^\w:(\\|\/)/g.test(t)&&(n=t.substring(2)),/[<>"|?*:]/g.test(n)?e(`Illegal characters in: ${t}  |  Illegal characters are: <>"|?:*`):!/(\\|\/)(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])((\\|\/)|$)/g.test(t)||e("Illegal name in path string")}class AbstractFsPath extends String{constructor(e,t=!1){if(t)super(e);else{if(!(e="string"!=typeof e?path.join(...e):e)||!path.isAbsolute(e))throw new Error("Expected absolute filepath. Got: "+e);super(path.normalize(e))}}get absolute(){return super.toString()}get relative(){return absoluteToRelativePath(this.absolute)}get root(){return path.parse(this.absolute).root}get base(){return path.basename(this.absolute)}get name(){return path.parse(this.absolute).name}get parentPath(){return path.dirname(this.absolute)}get exists(){return fs.existsSync(this.absolute)}statSync(){return fs.statSync(this.absolute)}stat(){return __awaiter(this,void 0,void 0,function*(){return fs.promises.stat(this.absolute)})}isValidWindowsPath(e=!1){return ensureValidWindowsPath(this.absolute,{extendedMaxLength:e})}toArray(){return this.absolute.split(path.sep)}relativeToArray(){return this.relative.split(path.sep)}get isDirectoryPath(){return!1}get isFilePath(){return!1}get isBlockDevicePath(){return!1}get isSymbolicLinkPath(){return!1}get isCharacterDevicePath(){return!1}get isFIFOPath(){return!1}get isSocketPath(){return!1}isDirectory(e=this.statSync()){return e.isDirectory()}isFile(e=this.statSync()){return e.isFile()}isBlockDevice(e=this.statSync()){return e.isBlockDevice()}isSymbolicLink(e=this.statSync()){return e.isSymbolicLink()}isCharacterDevice(e=this.statSync()){return e.isCharacterDevice()}isFIFO(e=this.statSync()){return e.isFIFO()}isSocket(e=this.statSync()){return e.isSocket()}}class FilePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isFilePath(){return!0}get parent(){return new DirectoryPath(this.parentPath,!0)}get filepath(){return this.absolute}get filename(){return path.basename(this.filepath)}get extension(){return path.extname(this.filepath)}readFileSync(e){return fs.readFileSync(this.filepath,e)}readFile(e){return __awaiter(this,void 0,void 0,function*(){return fs.promises.readFile(this.filepath,e)})}readFileStringSync(e="utf8"){return fs.readFileSync(this.filepath,e)}readFileString(e="utf8"){return __awaiter(this,void 0,void 0,function*(){return fs.promises.readFile(this.filepath,e)})}writeFileSync(e,t="utf8"){createDirectorySync(this.parentPath),fs.writeFileSync(this.filepath,e,t)}writeFile(e,t="utf8"){return __awaiter(this,void 0,void 0,function*(){createDirectory(this.parentPath),yield fs.promises.writeFile(this.filepath,e,t)})}}class BlockDevicePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isBlockDevicePath(){return!0}}class CharacterDevicePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isCharacterDevicePath(){return!0}}class FIFOPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isFIFOPath(){return!0}}class SocketPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isSocketPath(){return!0}}class SymbolicLinkPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isSymbolicLinkPath(){return!0}}function instantiateCorrectFsPathSubclass(e,t){return new(t.isFile()?FilePath:t.isDirectory()?DirectoryPath:t.isSymbolicLink()?SymbolicLinkPath:t.isBlockDevice()?BlockDevicePath:t.isCharacterDevice()?CharacterDevicePath:t.isFIFO()?FIFOPath:SocketPath)(e,!0)}class DirectoryPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get dirpath(){return this.absolute}get isDirectoryPath(){return!0}get parent(){return new DirectoryPath(this.parentPath)}subdir(...e){return new DirectoryPath(path.join(this.dirpath,...e),!0)}file(e){return new FilePath(path.join(this.dirpath,e),!0)}readdirSync(){return fs.readdirSync(this.dirpath).map(e=>{e=path.join(this.dirpath,e);return instantiateCorrectFsPathSubclass(e,fs.statSync(e))})}readdir(){return __awaiter(this,void 0,void 0,function*(){return yield Promise.all((yield fs.promises.readdir(this.dirpath)).map(t=>__awaiter(this,void 0,void 0,function*(){var e=path.join(this.dirpath,t);return instantiateCorrectFsPathSubclass(e,yield fs.promises.stat(e))})))})}}function getLastMofifiedFileIn(t,r){return __awaiter(this,void 0,void 0,function*(){var e=(yield new DirectoryPath(t).readdir()).filter(e=>e.isFilePath&&r(e));return(yield Promise.all(e.map(e=>__awaiter(this,void 0,void 0,function*(){return[e,(yield e.stat()).mtimeMs]})))).sort((e,t)=>t[1]-e[1])[0][0]})}function readExcelFile(r){return __awaiter(this,void 0,void 0,function*(){var e=new excelJs.Workbook;yield e.xlsx.readFile(r);const t={};return e.eachSheet(e=>{const r=[];e.eachRow(e=>{const t=[];e.eachCell(e=>{t.push(String(e.value).trim())}),r.push(t)}),t[e.name]=r}),t})}function readJsonFile(e){return __awaiter(this,void 0,void 0,function*(){return JSON.parse(yield fs.promises.readFile(e,"utf8"))})}function readJsonFileSync(e){return JSON.parse(fs.readFileSync(e,"utf8"))}function removeIllegalFilenameCharacters(e){return e.replace(/[/\\?%*:|"<>]/g,"")}function unzipFile(e,t){return __awaiter(this,void 0,void 0,function*(){yield extract(e,{dir:t})})}function unzipMergeFiles(t,r){return __awaiter(this,void 0,void 0,function*(){for(const e of t="string"==typeof t?fs.readdirSync(t).map(e=>path.join(t,e)):t)(yield fs.promises.stat(e)).isDirectory()||e.endsWith(".zip")&&(yield extract(e,{dir:r}))})}function convertFilter(r){return(t,e)=>e.filter(e=>{e=path.join(t,e);return r(e,fs.statSync(e))})}function findFile(s,t,o={}){return __awaiter(this,void 0,void 0,function*(){t=t.replace(/\\|\//g,path.sep);const n=new RegExp(regexEscapeString(t),"i"),e=o.filter?convertFilter(o.filter):void 0;return yield new Promise((t,r)=>{const i=walkdir(s,Object.assign(Object.assign({},o),{no_return:!0,filter:e}));i.on("file",e=>{n.test(e)&&(i.end(),t(e))}),i.on("end",()=>t(void 0)),i.on("error",e=>r(e))})})}function walkDirectory(r,i={},n){return __awaiter(this,void 0,void 0,function*(){var e=!!n,t=i.filter?convertFilter(i.filter):void 0;return yield walkdir.async(r,Object.assign(Object.assign({},i),{no_return:e,return_object:!1,filter:t}),n)})}function walkDirectoryEmitter(e,t={}){var r=t.filter?convertFilter(t.filter):void 0;return walkdir(e,Object.assign(Object.assign({},t),{no_return:!0,filter:r}))}function walkDirectorySync(e,t={},r){var i=!!r,n=t.filter?convertFilter(t.filter):void 0;return walkdir.sync(e,Object.assign(Object.assign({},t),{no_return:i,return_object:!1,filter:n}),r)}function wipeDirectorySafe(e){return __awaiter(this,void 0,void 0,function*(){yield deleteDirectorySafe(e),yield createDirectory(e)})}function writeExcelFile(i,n){return __awaiter(this,void 0,void 0,function*(){var e,t,r=new excelJs.Workbook;for([e,t]of Object.entries(n))r.addWorksheet(e).addRows(t);yield r.xlsx.writeFile(i)})}function toJson(e,t=!1){return t?JSON.stringify(e,null,2):JSON.stringify(e)}function writeJsonFile(e,t,r=!1){return __awaiter(this,void 0,void 0,function*(){yield fs.promises.writeFile(e,toJson(t,r))})}function writeJsonFileSync(e,t,r=!1){fs.writeFileSync(e,toJson(t,r))}class ExtensibleFunction extends Function{constructor(e,t){return Object.defineProperty(t,"name",{value:e}),super("string"==typeof t?t:t.toString()),Object.setPrototypeOf(t,new.target.prototype)}}function funAsyncAutoRateLimit(i,e){let n=!1;const[s,o]=funAsyncRateLimit(function(...r){return __awaiter(this,void 0,void 0,function*(){try{return yield e.call(s,...r)}catch(e){if(!n){n=!0,s.concurrency=Math.max(1,Math.floor(s.concurrency/10)),yield wait(250),n=!1;var t=9*s.concurrency;if((s.concurrency=t)<i/10)throw new Error("funAsyncAutoRateLimit: concurrency is below 10% of the original value.")}return yield o(...r)}})},{concurrency:i});return funSetName(o.name,o)}function funParseClass(e){var e=null==(e=esprima.parseScript(e.toString(),{tolerant:!0}).body)?void 0:e[0],t=null==(t=Reflect.get(e,"id"))?void 0:t.name;if("ClassDeclaration"!==e.type)throw new Error("Expected Class source code.");if(!e.body.body)throw new Error("Expected Class body.");const i=[];e=null==(e=e.body)?void 0:e.body.filter(e=>"MethodDefinition"===e.type).map(e=>{var t=e.kind,r=("constructor"===t&&null!=(r=null==(r=null==(r=e.value)?void 0:r.body)?void 0:r.body)&&r.forEach(e=>{"ExpressionStatement"===e.type&&"AssignmentExpression"===e.expression.type&&"MemberExpression"===e.expression.left.type&&"ThisExpression"===e.expression.left.object.type&&i.push(e.expression.left.property.name)}),null==(r=null==e?void 0:e.key)?void 0:r.name);return{kind:t,name:r,params:(null==(r=null==(t=null==e?void 0:e.value)?void 0:t.params)?void 0:r.map(e=>null==e?void 0:e.name))||[]}});return{name:t,properties:i,methods:e}}function funParseFunction(e){var t,e=null==(e=esprima.parseScript(e.toString(),{tolerant:!0}).body)?void 0:e[0];let r="",i=[];return"FunctionDeclaration"===(null==e?void 0:e.type)?(r=(null==(t=null==e?void 0:e.id)?void 0:t.name)||"",i=(null==(t=null==e?void 0:e.params)?void 0:t.map(e=>null==e?void 0:e.name))||[]):"ExpressionStatement"===(null==e?void 0:e.type)&&"ArrowFunctionExpression"===(null==e?void 0:e.expression.type)&&(i=(null==(e=null==(t=null==e?void 0:e.expression)?void 0:t.params)?void 0:e.map(e=>null==e?void 0:e.name))||[]),{name:r,params:i}}const _HTML_BOOLEAN_ATTRIBUTES=new Set(["async","autocomplete","autofocus","autoplay","border","challenge","checked","compact","contenteditable","controls","default","defer","disabled","formNoValidate","frameborder","hidden","indeterminate","ismap","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","readonly","required","reversed","scoped","scrolling","seamless","selected","sortable","spellcheck","translate"]),_HTML_EVENT_ATTRIBUTES=new Set(["onabort","onautocomplete","onautocompleteerror","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onshow","onsort","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting"]),_HTML_GLOBAL_ATTRIBUTES=new Set(["accesskey","autocapitalize","class","contenteditable","contextmenu","dir","draggable","dropzone","hidden","id","itemprop","lang","slot","spellcheck","style","tabindex","title"]),_HTML_ATTRIBUTES=new Set([..._HTML_GLOBAL_ATTRIBUTES,..._HTML_EVENT_ATTRIBUTES,..._HTML_BOOLEAN_ATTRIBUTES,"charset","coords","datafld","datasrc","download","href","hreflang","methods","name","ping","referrerpolicy","rel","shape","target","type","urn","alt","crossorigin","preload","alink","background","bgcolor","link","marginbottom","marginheight","marginleft","marginright","margintop","marginwidth","text","vlink","clear","dataformatas","formaction","formenctype","formmethod","formnovalidate","formtarget","align","char","charoff","span","valign","width","src","action","accept","method","profile","color","size","version","allowtransparency","hspace","vspace","decoding","lowsrc","srcset","capture","inputmode","usemap","as","blocking","integrity","display","overflow","content","http-equiv","scheme","archive","classid","code","codebase","codetype","data","declare","standby","valuetype","event","for","language","nomodule","bordercolor","cellpadding","cellspacing","datapagesize","frame","rules","summary","axis","colspan","height","rowspan","scope","cols","maxlength","minlength","rows","wrap","allow","buffered","cite","csp","datetime","dirname","enctype","enterkeyhint","form","headers","high","icon","importance","intrinsicsize","keytype","kind","label","loading","list","low","manifest","max","media","min","optimum","pattern","placeholder","poster","radiogroup","sandbox","sizes","srcdoc","srclang","start","step","value"]),_HTML_VOID_ELEMENTS=new Set(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),_HTML_ELEMENTS=new Set([..._HTML_VOID_ELEMENTS,"a","area","audio","button","col","colgroup","details","dialog","embed","fieldset","form","html","iframe","img","input","link","map","math","meta","object","ol","optgroup","option","script","select","td","textarea","th","video","abbr","acronym","address","applet","article","aside","b","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","canvas","caption","center","cite","code","data","datalist","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","i","ins","isindex","kbd","label","legend","li","listing","main","mark","marquee","menu","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","output","p","picture","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","section","slot","small","spacer","span","strike","strong","style","sub","summary","sup","svg","svg:desc","svg:title","table","tbody","template","tfoot","thead","time","title","tr","tt","u","ul","var","xmp"]);class _HtmlAttribute{constructor(e,t){this.name=e,this.value=t}get isBoolean(){return _HTML_BOOLEAN_ATTRIBUTES.has(this.name)}toString(){return""+this.name+(this.isBoolean?"":`="${this.value||""}"`)}}class _HtmlElement{constructor(e,...t){this.tag=e,this.attributes=new Map,this.children=[];for(const r of t.flat())r instanceof _HtmlAttribute?this.attributes.set(r.name,r):"string"==typeof r&&"script"!==e&&"style"!==e?this.children.push(r.replace(/\r*\n/g,"<br />")):this.children.push(r);if(this.children.length&&this.isVoid)throw new Error("Void elements cannot have children.")}get isVoid(){return _HTML_VOID_ELEMENTS.has(this.tag)}toHtmlElement(){var e,t=document.createElement(this.tag);for(const r of this.attributes.values())t.setAttribute(r.name,(null==(e=r.value)?void 0:e.toString())||"");for(const i of this.children)"string"==typeof i?t.appendChild(document.createTextNode(i)):t.appendChild(i.toHtmlElement());return t}toString(){return"<"+this.tag+(this.attributes.size?" "+Array.from(this.attributes.values()).join(" "):"")+(this.isVoid?" />":`>${this.children.join("")}</${this.tag}>`)}}const attr=(()=>{var e={};for(const t of _HTML_ATTRIBUTES)e[t]=e=>new _HtmlAttribute(t,e);return e})(),comment=e=>"\x3c!-- "+e+" --\x3e",el=(()=>{var e={};for(const t of _HTML_ELEMENTS)e[t]=(...e)=>new _HtmlElement(t,...e);return e.html=(...e)=>new _HtmlDocument("html",...e),e})(),tableFrom=(e,t=!0)=>{var r=el.thead();return t&&(e=e.slice(),r.children.push(el.tr((e.shift()||[]).map(e=>el.th(e))))),el.table(attr.class("table table-striped table-hover table-sm"),r,el.tbody(e.map(e=>el.tr(e.map(e=>el.td(e))))))};class _HtmlDocument extends _HtmlElement{static simple(e){return new _HtmlDocument(attr.lang("en"),el.head(el.meta(attr.charset("utf-8")),el.meta(attr.name("viewport"),attr.content("width=device-width, initial-scale=1")),el.title(e.title||"index"),comment("Bootstrap CSS"),el.link(attr.rel("stylesheet"),attr.href("https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"),attr.integrity("sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"),attr.crossorigin("anonymous")),comment("Custom CSS"),el.style("body { margin: 50px; font-family: Arial, Helvetica, sans-serif; font-size: 12px; }"),...e.head||[]),el.body(comment("Content"),el.div(attr.id("root"),attr.class("container"),...e.body||[]),comment("Bootstrap JS"),el.script(attr.src("https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"),attr.integrity("sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"),attr.crossorigin("anonymous")),comment("Custom JS"),...e.scripts||[]))}constructor(...e){super("html",...e)}toString(){return"<!DOCTYPE html>"+super.toString()}}function mapGetOrElse(e,t,r){var i=e.get(t);return void 0===i&&(i=r(t),e.set(t,i)),i}function mapReverse(e){return new Map([...e.entries()].reverse())}function mapUpdate(e,t,r){r=r(e.get(t),t);return e.set(t,r),r}function isValidNumber(e){return isFinite(e)&&!isNaN(e)}function assertValidNumber(e){if(isValidNumber(e))return e;throw new TypeError("Expected number to be finite and not NaN. Got: "+e)}function roundWith(e,t,r=Math.round){e=(assertValidNumber(e)+"e").split("e"),r=(r(+(e[0]+"e"+(+e[1]+t)))+"e").split("e");return+(r[0]+"e"+(+r[1]-t))}function round(e,t=0){return roundWith(e,t,Math.round)}function MixinEventEmitter(e){return class Emitter extends e{constructor(...e){super(...e),this.events=new EventEmitter}taskSync(e,t){try{this.emit("start",e,{task:"started"});var r=Date.now(),i=t(),n=(void 0!==i&&""!==i&&this.emit("data",e,{data:i}),round((Date.now()-r)/1e3,4)+" sec");return this.emit("completed",e,{task:"completed",elapsed:n}),i}catch(e){this.emit("error",e)}}task(i,n){return __awaiter(this,void 0,void 0,function*(){try{this.emit("start",i,{task:"started"});var e=Date.now(),t=yield n(),r=(void 0!==t&&""!==t&&this.emit("data",i,{data:t}),round((Date.now()-e)/1e3,4)+" sec");return this.emit("completed",i,{task:"completed",elapsed:r}),t}catch(e){this.emit("error",e)}})}taskStatus(e,t){this.emit("status",e,{task:"status",message:t})}emit(e,t,r){t instanceof Error?this.events.emit(e,t.stack,t,this):this.events.emit(e,t,r,this)}}}function strHashToBuffer(e,t="sha256"){return crypto.createHash(t).update(e).digest()}function strHashToString(e,t="sha256",r="base64"){return strHashToBuffer(e,t).toString(r)}(new PrettyError).start();const nextIndex=new Map;function MixinIndexed(e){return class Indexed extends e{constructor(...e){super(...e);var e=this.getConstructor(),t=nextIndex.get(e);void 0===t?nextIndex.set(e,this.i=0):nextIndex.set(e,this.i=t+1)}get uid(){return[this.getConstructor().name,this.i]}get uidString(){return this.uid.join(":")}get uidHashMd5(){return strHashToString(this.uidString,"md5","base64url")}get uidHashSha1(){return strHashToString(this.uidString,"sha1","base64url")}get uidHashSha256(){return strHashToString(this.uidString,"sha256","base64url")}}}function MixinTimestamped(e){return class Timestamped extends e{constructor(...e){super(...e),this.timestamp=Date.now()}}}function normalizeLineLengths(e,t,r){function singlePass(r,i,n){if(void 0===i||void 0===n){let e=0,t=0;for(const a of r){var s=a.length;e+=s,s>t&&(t=s)}e=Math.floor(e/r.length),void 0===i&&(i=e-Math.floor(e/2)),void 0===n&&(n=t-Math.floor(e/2))}for(let e=1;e<r.length;e++){var t=r[e],o=r[e-1];t.length+o.length<n&&(t.length<i||o.length<i)&&(r[e]=o+" "+t,r[e-1]="")}return r.filter(e=>!!e)}let i=singlePass(e,t,r);for(;i.length!==e.length;)i=singlePass(e=i,t,r);return i}function getHomeDirectory(){var e=path.resolve(process.env.HOME||process.env.USERPROFILE||"");if(e)return e;throw new Error("Home directory not found")}function getDownloadsDirectory(){return path.join(getHomeDirectory(),"Downloads")}function memoryUsage(){var e=e=>Math.floor(1e-6*e),t=process.memoryUsage();return{processAllocationMB:e(t.rss),heapAllocationMB:e(t.heapTotal),heapUsedMB:e(t.heapUsed),extenalV8:e(t.external)}}function shellSpawnProgram(n,...s){return new Promise((t,r)=>{let e;var i=s.indexOf("--no-inherit");(e=-1!==i?(s.splice(i,1),childProcess.spawn(n,s)):childProcess.spawn(n,s,{stdio:"inherit"})).on("error",e=>{r(e)}),e.on("close",e=>{t(n+" "+s.join(" "))})})}function streamToString(t){var r,i,n,s,o,a,l;return __awaiter(this,void 0,void 0,function*(){var e=[];try{try{for(r=!0,i=__asyncValues(t);n=yield i.next(),!(s=n.done);r=!0)l=n.value,r=!1,e.push(Buffer.from(l).toString())}catch(e){o={error:e}}finally{try{r||s||!(a=i.return)||(yield a.call(i))}finally{if(o)throw o.error}}}catch(e){return""}return e.join("")})}class StringStream extends stream.Readable{constructor(e){super(),this.string=e,this.ended=!1}_read(){this.ended||(process.nextTick(()=>{this.push(Buffer.from(this.string)),this.push(null)}),this.ended=!0)}}function isEven(e){if(Number.isInteger(e))return e%2==0;throw new Error("Expected integer. Got "+e)}function isInRange(e,t,r=[!1,!1]){return(r[0]?e>t[0]:e>=t[0])&&(r[1]?e<t[1]:e<=t[1])}function isOdd(e){if(Number.isInteger(e))return e%2!=0;throw new Error("Expected integer. Got "+e)}const locales=new Map([["en-US",[",","."]],["da-DK",[".",","]]]);class NumberFormatter{constructor(e=2){this.thousandSeparator=",",this.decimalSeparator=".",this.precision=e}static defineLocale(e,t,r){locales.set(e,[t,r])}static getLocales(){var e=new Map;for(const t of locales.entries())e.set(t[0],[t[1][0],t[1][1]]);return e}locale(e){var t=locales.get(e);if(t)return this.thousandSeparator=t[0],this.decimalSeparator=t[1],this;throw new Error(`Invalid locale: ${e}. Valid: ${Array.from(locales.keys())}}.`)}format(e){assertValidNumber(e);var t=0<=e?"":"-",r=Math.abs(round(e,this.precision)).toString().split("."),e=this.precision?this.decimalSeparator+(r[1]||"").padEnd(this.precision,"0"):"";let i="";for(let e=0;e<r[0].length;e++)e%3==0&&0!==e&&(i=this.thousandSeparator+i),i=r[0][r[0].length-e-1]+i;return t+i+e}parse(e){e=strReplaceAll(e,this.thousandSeparator,"").replace(this.decimalSeparator,".").replace(/[^\d.-]/g,"").split(".").map(e=>parseInt(e)).join(".");e=Number(e);return assertValidNumber(e),e}}function numRange(t,r){if(r<t)throw new Error(`Expected start to be less than or equal to end. Got: ${t} > `+r);if(t===r)return[t];var i=[];for(let e=t;e<=r;e++)i.push(e);return i}function roundDown(e,t=0){return roundWith(e,t,Math.floor)}function roundToNearest(e,t=1){return Math.round(assertInteger(e)/assertInteger(t))*t}const regPowerOfTen=/^10*$/;function isPowerOfTen(e){return regPowerOfTen.test(e.toString())}function assertPowerOfTen(e){if(isPowerOfTen(e))return e;throw new TypeError("Expected number to be a power of ten. Got: "+e)}function roundToNearestPow10(e,t=1){return Math.round(assertInteger(e)/assertInteger(assertPowerOfTen(t)))*t}function roundUp(e,t=0){return roundWith(e,t,Math.ceil)}function getConstructor(e){return Object.getPrototypeOf(e).constructor}function getOrElse(e,t){return void 0===e?t():e}function getOrThrow(e,t){if(void 0===e)throw t;return e}function getPrototype(e){return Object.getPrototypeOf(e)}function inheritStaticMembers(e,t,r=[]){var i,n=new Set([...r,"prototype","name","constructor"]);for(const s of Reflect.ownKeys(t))n.has(s)||Reflect.has(e,s)||(i=Object.getOwnPropertyDescriptor(t,s),Object.defineProperty(e,s,i));return e}function iterableFirstElement(e){for(const t of e)return t}function isConstructor(e){return"function"==typeof e&&!!e.prototype&&e.prototype.constructor===e}function isPrototype(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor.prototype===e}function*iteratePrototypeChain(e){isPrototype(e)||isConstructor(e)||e===Function.prototype||(yield e,e=e.constructor.prototype);let t=e;for(;t;)yield t,t=Reflect.getPrototypeOf(t)}function objAssignDeep(e,t){return deepAssign(e,t)}function objDeepFreeze(e){for(const r of Reflect.ownKeys(e)){var t=e[r];(t&&"object"==typeof t||"function"==typeof t)&&objDeepFreeze(t)}return Object.freeze(e)}function objDelete(e,t){return delete e[t],e}function*objEntries(e){yield*Object.entries(e)}function objEntriesArray(e){return Array.from(Object.entries(e))}function objFilter(e,t,r=Object.keys){var i={};for(const n of r(e))t(e[n],n)&&(i[n]=e[n]);return i}function objForEach(e,t,r=Object.keys){for(const i of r(e))t(e[i],i);return e}function objGet(e,t){return e[t]}function objGetOrElse(e,t,r){var i=e[t];return void 0!==i?i:e[t]=r(t)}function objHas(e,t){return Object.hasOwn(e,t)}function objIsEmpty(e){for(const t of Object.keys(e))if(void 0!==t)return!1;return!0}function*objKeys(e){yield*Object.keys(e)}function objKeysArray(e){return Array.from(Object.keys(e))}function objMap(e,t,r=Object.keys){var i={};for(const n of r(e))i[n]=t(e[n],n);return i}function objMapKeys(e,t,r=Object.keys){var i={};for(const n of r(e))i[t(n,e[n])]=e[n];return i}function objMapMutable(e,t,r=Object.keys){for(const i of r(e))e[i]=t(e[i],i);return e}function objOmitKeys(e,...r){return objFilter(e,(e,t)=>!r.includes(t))}function objPropertyValueToGetter(e,...t){for(const i of t){var r=Object.getOwnPropertyDescriptor(e,i);if(!r)throw new Error(`Property descriptor for '${String(i)}' not found.`);const{enumerable:n,configurable:s,value:o}=r;Object.defineProperty(e,i,{enumerable:n,configurable:s,get:()=>o})}return e}function objReduce(e,t,r,i=Object.keys){for(const n of i(e))r=t(r,e[n],n);return r}function objReverse(e){return Object.fromEntries(objEntriesArray(e).reverse())}function objSet(e,t,r){return e[t]=r}function objSize(e){return Object.keys(e).length}function objSortKeys(e){return Object.fromEntries(Object.entries(e).sort((e,t)=>e[0].localeCompare(t[0])))}function objToMap(e){return new Map(Object.entries(e))}function objUpdate(e,t,r){return e[t]=r(e[t],t)}function*objValues(e){yield*Object.values(e)}function objValuesArray(e){return Array.from(Object.values(e))}function objWalk(e,n){!function recurse(e,r=[]){for(const[i,t]of Object.entries(e))"object"==typeof t&&null!==t?Array.isArray(t)?t.forEach((e,t)=>{recurse(e,r.concat([i+`[${t}]`]))}):recurse(t,r.concat(i)):n(t,r.concat(i))}(e)}function setEnumerable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.enumerable=!0,e))}function setNonConfigurable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.configurable=!1,e))}function setNonWritable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.writable=!1,e))}function setWritable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.writable=!0,e))}function csvParseStream(i,n){return new Promise((e,t)=>{const r=[];i.pipe(parseCSV(n)).on("data",e=>{r.push(e)}).on("end",()=>{e(r)}).on("error",t)})}function markdownWrapCodeBlock(e,t=""){return"```"+t+"\n"+e.trim()+"\n```"}function regexClone(e){return new RegExp(e.source,e.flags)}function*rexec(e,t){var r;for(e=regexClone(e);null!==(r=e.exec(t));)yield{index:r.index,lastIndex:e.lastIndex,groups:Object.assign({},r.groups),match:r[0]}}function rexecFirstMatch(e,t){return iterableFirstElement(rexec(new RegExp(e.source,e.flags),t))}function parseMarkdownCodeBlock(e){var t,e=null==(e=rexecFirstMatch(/```(?<language>\w+)?(?<code>.+)```/gs,e.trim()))?void 0:e.groups;if(e)return{language:e,code:t}=e,{language:e,code:t.trim()};throw new Error("Could not parse the markdown code block.")}function parseMarkdownTable(e){return e.trim().split("\n").map(e=>e.trim()).filter((e,t)=>!!e).filter((e,t)=>1!==t).map(e=>e.trim().replace(/^\|/,"").replace(/\|$/,"").split("|").map(e=>e.trim()))}function pdfIteratePages(a,l,u){return __asyncGenerator(this,arguments,function*pdfIteratePages_1(){var e=yield __await(fs.promises.readFile(a)),t=yield __await(pdfLib.PDFDocument.load(e.buffer));u=u||t.getPages().length;for(let e=l=l||0;e<u;e++)try{var r=yield __await(pdfLib.PDFDocument.create()),[i]=yield __await(r.copyPages(t,[e])),n=(r.addPage(i),yield __await(r.save())),s=Buffer.from(n),o=yield __await(pdf(s));yield yield __await(o.text)}catch(e){yield yield __await("")}})}function pdfGetPages(n,s,o){var a,l,u,c;return __awaiter(this,void 0,void 0,function*(){var e=[];try{for(var t,r=!0,i=__asyncValues(pdfIteratePages(n,s,o));t=yield i.next(),!(a=t.done);r=!0){c=t.value;r=!1;e.push(c)}}catch(e){l={error:e}}finally{try{r||a||!(u=i.return)||(yield u.call(i))}finally{if(l)throw l.error}}return e})}function pdfSplitPages(l,u){return __awaiter(this,void 0,void 0,function*(){var e=yield fs.promises.readFile(l),t=yield pdfLib.PDFDocument.load(e),r=t.getPages().length,i=r.toString().length,n=[];yield mkdirp.mkdirp(u);for(let e=0;e<r;e++){var s=yield pdfLib.PDFDocument.create(),[o]=yield s.copyPages(t,[e]),o=(s.addPage(o),e),s=yield s.save(),a=o.toString().padStart(i,"0")+".pdf",a=path.join(u,a);yield fs.promises.writeFile(a,s),n[o]=a}return n})}class _AbstractSubtitle{constructor(e,t){this.interval=e,this.text=t}}class SRTSubtitle extends _AbstractSubtitle{constructor(e,t){super(e,t)}toString(){return this.interval.toString(" --\x3e ",",")+`
`+this.text}}function isValidHours(e){return 0<=e&&e<=23&&Number.isInteger(e)}function assertValidHours(e){if(!isValidHours(e))throw new Error("Expected hours to be between 0 and 23. Got: "+e)}function isValidMilliseconds(e){return 0<=e&&e<=999&&Number.isInteger(e)}function assertValidMilliseconds(e){if(!isValidMilliseconds(e))throw new Error("Expected milliseconds to be between 0 and 999. Got: "+e)}function isValidMinutes(e){return 0<=e&&e<=59&&Number.isInteger(e)}function assertValidMinutes(e){if(!isValidMinutes(e))throw new Error("Expected minutes to be between 0 and 59. Got: "+e)}function isValidSeconds(e){return 0<=e&&e<=59&&Number.isInteger(e)}function assertValidSeconds(e){if(!isValidSeconds(e))throw new Error("Expected seconds to be between 0 and 59. Got: "+e)}function isValidTimeInt(e){return 0<=e&&e<864e5&&Number.isInteger(e)}function assertValidTimeInt(e){if(!isValidTimeInt(e))throw new Error("Expected time int to be between 0 and 86399999. Got: "+e)}function assertValidTime(e,t,r,i){assertValidHours(e),assertValidMinutes(t),assertValidSeconds(r),assertValidMilliseconds(i)}function assertValidTimeArray(e){if(4!==e.length)throw new Error("Expected array of length 4.");assertValidTime(e[0],e[1],e[2],e[3])}function timeArrayToIntUnsafe(e){var[e,t,r,i]=e;return 36e5*e+6e4*t+1e3*r+i}function timeArrayToInt(e){return assertValidTimeArray(e),timeArrayToIntUnsafe(e)}function timeIntToArrayUnsafe(e){var t=Math.floor(e/36e5),r=(e%=36e5,Math.floor(e/6e4)),i=(e%=6e4,Math.floor(e/1e3));return[t,r,i,e%=1e3]}function timeArrayToStringUnsafe(e,t="."){return e[0].toString().padStart(2,"0")+`:${e[1].toString().padStart(2,"0")}:`+e[2].toString().padStart(2,"0")+t+e[3].toString().padStart(3,"0")}function timeIntToStringUnsafe(e,t="."){return timeArrayToStringUnsafe(timeIntToArrayUnsafe(e),t)}function isValidTimeStringFormatting(e){return/^\s*([0-1][0-9]|2[0-3])[^0-9-]+[0-5][0-9][^0-9-]+[0-5][0-9][^0-9-]+[0-9][0-9][0-9]\s*$/.test(e)}function assertValidTimeStringFormatting(e){if(!isValidTimeStringFormatting(e))throw new Error("Expected timestring to be of format hh:mm:ss:mmm with any desired delimiters. Got: "+e)}function timeStringToArrayUnsafe(e){return e.trim().split(/[^0-9]+/).map(e=>parseInt(e))}function timeStringToArray(e){assertValidTimeStringFormatting(e);e=timeStringToArrayUnsafe(e);return assertValidTimeArray(e),e}function timeStringToInt(e){return assertValidTimeStringFormatting(e),timeArrayToIntUnsafe(timeStringToArray(e))}class Time{constructor(e){"number"==typeof e?(assertValidTimeInt(e),this.ms=e):this.ms=("string"==typeof e?timeStringToInt:timeArrayToInt)(e)}addHours(e){return this.ms+=36e5*e,assertValidTimeInt(this.ms),this}addMinutes(e){return this.ms+=6e4*e,assertValidTimeInt(this.ms),this}addSeconds(e){return this.ms+=1e3*e,assertValidTimeInt(this.ms),this}addMilliseconds(e){return this.ms+=e,assertValidTimeInt(this.ms),this}subtractHours(e){return this.ms-=36e5*e,assertValidTimeInt(this.ms),this}subtractMinutes(e){return this.ms-=6e4*e,assertValidTimeInt(this.ms),this}subtractSeconds(e){return this.ms-=1e3*e,assertValidTimeInt(this.ms),this}subtractMilliseconds(e){return this.ms-=e,assertValidTimeInt(this.ms),this}get hours(){return Math.floor(this.ms/36e5)}set hours(e){assertValidHours(e),this.addHours(e-this.hours)}get minutes(){return Math.floor(this.ms/6e4)%60}set minutes(e){assertValidMinutes(e),this.addMinutes(e-this.minutes)}get seconds(){return Math.floor(this.ms/1e3)%60}set seconds(e){assertValidSeconds(e),this.addSeconds(e-this.seconds)}get milliseconds(){return this.ms%1e3}set milliseconds(e){assertValidMilliseconds(e),this.addMilliseconds(e-this.ms)}toArray(){return timeIntToArrayUnsafe(this.ms)}toString(e="."){return timeIntToStringUnsafe(this.ms,e)}toNumber(){return this.ms}valueOf(){return this.ms}compareTo(e){return this.ms-e.ms}difference(e){return new Time(Math.abs(this.compareTo(e)))}clone(){return new Time(this.ms)}}class TimeInterval{constructor(e,t){if(t<e)throw new Error("Start time must be before end time");this.start=e,this.end=t}getDuration(){return this.end.difference(this.start)}toString(e=" --\x3e ",t="."){return""+this.start.toString(t)+e+this.end.toString(t)}}class SRTSubtitles{constructor(e){this.subtitles=e.trim().split(/\r?\n\r?\n/).map(e=>{var[,e,t]=e.trim().split(/\r?\n/),[e,r]=e.split(" --\x3e ").map(e=>new Time(e));return new SRTSubtitle(new TimeInterval(e,r),t)})}toString(){let t="";for(let e=0;e<this.subtitles.length;e++){var r=this.subtitles[e];t+=Number(e+1)+"\n"+r.toString()+"\n\n"}return t.trimEnd()}}class VTTSubtitle extends _AbstractSubtitle{constructor(e,t){super(e,t)}toString(){return this.interval.toString(" --\x3e ",".")+`
`+this.text}}class VTTSubtitles{constructor(e){this.subtitles=e.replace("WEBVTT","").trim().split(/\r?\n\r?\n/).map(e=>{var[e,t]=e.trim().split(/\r?\n/),[e,r]=e.split(" --\x3e ").map(e=>new Time(e));return new VTTSubtitle(new TimeInterval(e,r),t)})}toString(){return`WEBVTT

`+this.subtitles.join("\n\n")}}function strRemoveDuplicateChars(e){return Array.from(new Set(e)).join("")}function buildRegexBetween(e,t,r){return e="string"==typeof e?regexEscapeString(e):e.source,t="string"==typeof t?regexEscapeString(t):t.source,r=r?strRemoveDuplicateChars("gs"+r):"gs",new RegExp(`(?<left>${e})(?<mid>.*?)(?=${t})(?<right>${t})`,r)}function strSortChars(e){return Array.from(e).sort().join("")}function regexFixFlags(e){return e&&strSortChars(strRemoveDuplicateChars(e).replace(/[^gimsuy]/gi,""))}function regexGetGroupNames(e){var t=[];for(const r of rexec(/\(\?<(?<name>\w+)>/g,e.toString()))t.push(r.groups.name);return t}function regexIsValidFlags(e){return/^[gimsuy]*$/.test(e)&&strRemoveDuplicateChars(e).length===e.length}function regexMatcherToValidater(e){return new RegExp(`^${e.source}$`,e.flags.replace("g",""))}function compareArray(r,e=!1){const a=e?-1:1;return(e,t)=>function recursiveCompare(n,s,e){var t;if(!Array.isArray(n))return Array.isArray(s)?-1*a:0===(t=r(n,s))&&e||t;{if(!Array.isArray(s))return a;let r,i;i=n.length>s.length?(r=n.length,a):n.length<s.length?(r=s.length,-1*a):(r=n.length,0);for(let e=0,t=r;e<t;e++){var o=recursiveCompare(n[e],s[e],i);if(0!==o)return o}}return 0}(e,t)}function regexScopeTree(e,t){function parseParam(e){e="string"==typeof e?new RegExp(regexEscapeString(e),"g"):new RegExp(e.source,strRemoveDuplicateChars(e.flags+"g"));return[e,new RegExp("^"+e.source+"$","")]}const[c,p]=parseParam(e),[h,d]=parseParam(t);return function*(e,t=!1){var r=[...rexec(c,e)].concat([...rexec(h,e)]),i=(r.sort(compareArray((e,t)=>e.index-t.index)),[]),n=[];for(const u of r)if(p.test(u.match))n.push(u);else if(d.test(u.match)){var s=n.pop(),o=u,a=n.length,l={parent:null,depth:a,left:s,right:o,between:{index:s.lastIndex,lastIndex:o.index,groups:{},match:e.substring(s.lastIndex,o.index)},children:[]};setNonEnumerable(l,"parent");for(let e=i.length-1;0<=e&&!(s.index>=i[e].left.index||o.lastIndex<=i[e].right.lastIndex);e--)l.children.push(i[e]),null===i[e].parent&&(i[e].parent=l);i.push(l),t&&0<a||(yield l)}}}function regexValidFlags(){return["g","i","m","s","u","y"]}const regBlockCommentsWithIndent=buildRegexBetween(/(^|\n| *)\/\*\*/g,/\n +\*\//g),regFunctionsExports=buildRegexBetween(/(^|\n)export (default )?(async )?function/,/\n\}(\n|$)/),regHex=/^(0x|0h|(\\?u)|#)?[0-9A-F]+$/i,regHexPrefix=/^(0x|0h|(\\?u)|#)/i,regInteger$1=/-?\d+/g,regJestTests=buildRegexBetween(/(^|\n)describe\(/,"\n})"),regLocaleAlpha=new Map([["en-US",/^[A-Z]+$/i],["az-AZ",/^[A-VXYZÇƏĞİıÖŞÜ]+$/i],["bg-BG",/^[А-Я]+$/i],["cs-CZ",/^[A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i],["da-DK",/^[A-ZÆØÅ]+$/i],["de-DE",/^[A-ZÄÖÜß]+$/i],["el-GR",/^[Α-ώ]+$/i],["es-ES",/^[A-ZÁÉÍÑÓÚÜ]+$/i],["fa-IR",/^[ابپتثجچحخدذرزژسشصضطظعغفقکگلمنوهی]+$/i],["fr-FR",/^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i],["it-IT",/^[A-ZÀÉÈÌÎÓÒÙ]+$/i],["nb-NO",/^[A-ZÆØÅ]+$/i],["nl-NL",/^[A-ZÁÉËÏÓÖÜÚ]+$/i],["nn-NO",/^[A-ZÆØÅ]+$/i],["hu-HU",/^[A-ZÁÉÍÓÖŐÚÜŰ]+$/i],["pl-PL",/^[A-ZĄĆĘŚŁŃÓŻŹ]+$/i],["pt-PT",/^[A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i],["ru-RU",/^[А-ЯЁ]+$/i],["sl-SI",/^[A-ZČĆĐŠŽ]+$/i],["sk-SK",/^[A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i],["sr-RS@latin",/^[A-ZČĆŽŠĐ]+$/i],["sr-RS",/^[А-ЯЂЈЉЊЋЏ]+$/i],["sv-SE",/^[A-ZÅÄÖ]+$/i],["th-TH",/^[ก-๐\s]+$/i],["tr-TR",/^[A-ZÇĞİıÖŞÜ]+$/i],["uk-UA",/^[А-ЩЬЮЯЄIЇҐі]+$/i],["vi-VN",/^[A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i],["ku-IQ",/^[ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i],["he",/^[א-ת]+$/],["fa",/^['آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی']+$/i]]),regLocaleAlphaNumeric=new Map([["en-US",/^[0-9A-Z]+$/i],["az-AZ",/^[0-9A-VXYZÇƏĞİıÖŞÜ]+$/i],["bg-BG",/^[0-9А-Я]+$/i],["cs-CZ",/^[0-9A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i],["da-DK",/^[0-9A-ZÆØÅ]+$/i],["de-DE",/^[0-9A-ZÄÖÜß]+$/i],["el-GR",/^[0-9Α-ω]+$/i],["es-ES",/^[0-9A-ZÁÉÍÑÓÚÜ]+$/i],["fr-FR",/^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i],["it-IT",/^[0-9A-ZÀÉÈÌÎÓÒÙ]+$/i],["hu-HU",/^[0-9A-ZÁÉÍÓÖŐÚÜŰ]+$/i],["nb-NO",/^[0-9A-ZÆØÅ]+$/i],["nl-NL",/^[0-9A-ZÁÉËÏÓÖÜÚ]+$/i],["nn-NO",/^[0-9A-ZÆØÅ]+$/i],["pl-PL",/^[0-9A-ZĄĆĘŚŁŃÓŻŹ]+$/i],["pt-PT",/^[0-9A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i],["ru-RU",/^[0-9А-ЯЁ]+$/i],["sl-SI",/^[0-9A-ZČĆĐŠŽ]+$/i],["sk-SK",/^[0-9A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i],["sr-RS@latin",/^[0-9A-ZČĆŽŠĐ]+$/i],["sr-RS",/^[0-9А-ЯЂЈЉЊЋЏ]+$/i],["sv-SE",/^[0-9A-ZÅÄÖ]+$/i],["th-TH",/^[ก-๙\s]+$/i],["tr-TR",/^[0-9A-ZÇĞİıÖŞÜ]+$/i],["uk-UA",/^[0-9А-ЩЬЮЯЄIЇҐі]+$/i],["ku-IQ",/^[٠١٢٣٤٥٦٧٨٩0-9ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i],["vi-VN",/^[0-9A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i],["he",/^[0-9א-ת]+$/],["fa",/^['0-9آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی۱۲۳۴۵۶۷۸۹۰']+$/i]]),regNumberCommaSepDotDecimal=/-?\d{1,3}(,\d{3})*(\.\d+)?/g,regNumberDotSepCommaDecimal=/-?\d{1,3}(\.\d{3})*(,\d+)?/g,regNumberNoThousandSepCommaDecimal=/-?\d+,\d+/g,regNumberNoThousandSepDotDecimal=/-?\d+.\d+/g,regRepeatingWhiteSpace=/((\r?\r?\n)|\s|\t){2,}/g,regSocialSecurityNumbersDK=/(?<dd>[0-3][0-9])(?<mm>[0-1][0-9])(?<yy>[0-9]{2}).?(?<id4>[0-9]{4})/g,regTsDocExampleLines=buildRegexBetween(/ +\* +(@example )?```(ts|typescript|js|javascript)?/i,/ +\* +```\n/g),regWords=/\b[^\W]+/g;function setAddMany(e,t){for(const r of t)e.add(r);return e}function setDifference(e,t){var r=new Set(e);for(const i of t)r.delete(i);return r}function setIntersection(t){if(!t.length)return new Set;var r=new Set(t[0].values());for(let e=1;e<t.length;e++)for(const i of r.values())t[e].has(i)||r.delete(i);return r}function setIsSuperset(e,t){for(const r of t)if(!e.has(r))return!1;return!0}function setSymmetricDifference(e,t){var r=new Set(e);for(const i of t)r.has(i)?r.delete(i):r.add(i);return r}function setUnion(t){if(!t.length)return new Set;var r=new Set(t[0].values());for(let e=1;e<t.length;e++)for(const i of t[e].values())r.add(i);return r}function compareNumberDescending(e,t){return t-e}function compareNumericDescending(e,t){return t<e?-1:e<t?1:0}function compareStringDescending(e,t){return t.localeCompare(e)}function letterToCol(t,e=!1){if(t=t.toUpperCase(),!/^[A-Z]*$/i.test(t))throw new Error("Invalid column letter: "+t);let r=0;var i=t.length;for(let e=0;e<i;e++)r+=(t.charCodeAt(e)-64)*Math.pow(26,i-e-1);return r-(e?1:0)}function A1ToColRow(e,t=!1){var r=[...rexec(/^(?<a>[A-Z]+)(?<n>[1-9]+)$/g,e=e.toUpperCase())];if(r.length)return t=t?1:0,[letterToCol(r[0].groups.a)-t,parseInt(r[0].groups.n)-t];throw new Error("Invalid A1 string: "+e)}function colToLetter(e,t=!1){if(t&&e++,!Number.isInteger(e))throw new Error("Expected col to be an integer. Got: "+e);if(e<1)throw new Error("Expected col to be greater than zero. Got: "+e);let r="";for(var i;0<e;)i=(e-1)%26,r=String.fromCharCode(65+i)+r,e=(e-i-1)/26;return r}function colRowToA1(e,t=!1){if(2!==e.length)throw new Error("Expected CR to to be length 2. Got: "+e.length);if(!Number.isInteger(e[1]))throw new Error("Expected row to be an integer. Got: "+e[1]);if(e[1]<1)throw new Error("Expected row to be greater than zero. Got: "+e[1]);return colToLetter(e[0],t)+e[1].toString()}function strCountCharOccurances(e,t){if(1!==t.length)throw new Error("Expected char to be a single character string of length 1.");let r=0;for(const i of e)i===t&&r++;return r}function strCountChars(e){var t=new Map;for(const i of e){var r=t.get(i);t.set(i,r?r+1:1)}return t}function strToWords(e){return lodash.words(e)}function strCountWords(e){return strToWords(e).length}function strEnsureEndsWith(e,t){return e.endsWith(t)?e:e+t}function strFirstCharToUpperCase(e){return e.charAt(0).toUpperCase()+e.substring(1)}function strHashToStringDJB2(t){let r=5381;for(let e=0;e<t.length;e++)r=(r<<5)+r+t.charCodeAt(e);return r}function strHashToUint32Array(e,t="sha256"){return new Uint32Array(strHashToBuffer(e,t).buffer)}function strIsLowerCase(e){return e===e.toLowerCase()}function strIsMultiLine(e){return e.includes("\n")}function strIsUpperCase(e){return e===e.toUpperCase()}function strNoConsecutiveEmptyLines(e){return e.replace(/\n\n+/g,"\n\n")}function strNoConsecutiveWhitespace(e){return e.replace(/\s{2,}/g," ")}function strParseBoolean(e){return"true"===e.trim().toLowerCase()}function strPrependLines(e,t){return e.split(/\r?\n/).map(e=>t+e).join("\n")}function strRemoveEmptyLines(e){return e.split(/\r?\n/).filter(e=>!!e.trim()).join("\n")}function strRemoveFirstAndLastLine(e){e=e.split(/\r?\n/);return e.length<=2?"":e.slice(1,e.length-1).join("\n")}function strRemoveNewLines(e,t=""){return e.replace(/\r*\n/g,t)}function strSplitAndTrim(e,t,r=!1){e=e.split(t).map(e=>e.trim());return r?e.filter(e=>!!e.trim()):e}function strSplitCamelCase(t){if(!t)return[];if(t.length<=2)return[t];var r,i=[],n=t.length-1;let s=0,o=!1;for(let e=1;e<t.length;e++)isWordSplitIndex(t,e)&&(r=t.substring(s,e))&&(i.push(r),s=e,o=!0),o&&e===n&&(r=t.substring(s))&&i.push(r);return o||i.push(t),i}const regInteger=/\d+/g,regSpecial=/[^\w]+/g;function isWordSplitIndex(e,t){return strIsLowerCase(e[t-1])&&strIsUpperCase(e[t])&&!regInteger.test(e[t-1])&&!regInteger.test(e[t])&&!regSpecial.test(e[t-1])&&!regSpecial.test(e[t])}function strToCharCodes(t){var r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.codePointAt(e);return r}function strToCharSet(e){return new Set(e)}function strToSentences(e){return e?sentenceSplitter.split(e).filter(e=>"Sentence"===e.type).map(e=>e.raw):[]}function strToSortedCharSet(e){return Array.from(new Set(e)).sort().join("")}function strTrimLines(e){return e.split(/\r?\n/).map(e=>e.trim()).join("\n")}function strTrimLinesLeft(e){return e.split(/\r?\n/).map(e=>e.trimStart()).join("\n")}function strTrimLinesRight(e){return e.split(/\r?\n/).map(e=>e.trimEnd()).join("\n")}function strUnwrap(e,t,r,i=""){return e.replace(new RegExp("^"+regexEscapeString(t),i),"").replace(new RegExp(regexEscapeString(r)+"$",i),"")}function strWrapBetween(e,t,r){return t+e+r}function strWrapIn(e,t){return t+e+t}function strWrapInAngleBrackets(e){return"<"+e+">"}function strWrapInBraces(e){return"{"+e+"}"}function strWrapInBrackets(e){return"["+e+"]"}function strWrapInDoubleQuotes(e){return'"'+e+'"'}function strWrapInParenthesis(e){return"("+e+")"}function strWrapInSingleQuotes(e){return"'"+e+"'"}function assertValidTimeString(e){assertValidTimeStringFormatting(e),assertValidTimeArray(timeStringToArrayUnsafe(e))}function isValidTime(e,t,r,i){return isValidHours(e)&&isValidMinutes(t)&&isValidSeconds(r)&&isValidMilliseconds(i)}function isValidTimeArray(e){return 4===e.length&&isValidTime(e[0],e[1],e[2],e[3])}function isValidTimeString(e){return!!e&&isValidTimeStringFormatting(e)}function timeArrayToString(e,t="."){return assertValidTimeArray(e),timeArrayToStringUnsafe(e,t)}function timeIntToArray(e){return assertValidTimeInt(e),timeIntToArrayUnsafe(e)}function timeIntToString(e,t="."){return assertValidTimeInt(e),timeIntToStringUnsafe(e,t)}function timeStringToIntUnsafe(e){return timeArrayToIntUnsafe(timeStringToArrayUnsafe(e))}function tsCountExports(e){return(null==(e=e.match(/^export /gm))?void 0:e.length)||0}function*tsDocExtractAllComments(e){const t=/^\s*\/\*\*\s*$/,r=/^\s*\*\/\s*$/;let i=e.split(/\r?\n/),n=0;for(;;){var s=i.findIndex(e=>t.test(e)),o=i.findIndex(e=>r.test(e));if(-1===s||-1===o)break;{let e;""===(null===(e=o+1<i.length?i[o+1]:e)||void 0===e?void 0:e.trim())&&o+2<i.length&&(e=i[o+2]),yield{start:s+n,end:o+n,match:i.slice(s,o+1).join("\n"),nextLine:e},i=i.slice(o+1),n+=o+1}}}function tsStripBlockComments(e){var t,r,i=e.split("\n");const n=new Set;for({start:t,end:r}of tsDocExtractAllComments(e))for(const s of numRange(t,r))n.add(s);return strip.block(i.filter((e,t)=>!n.has(t)).join("\n"))}function tsExtractImports(e){var t=/^import /,r=/\{\s*$/,i=/^\} from '/,n=[];let s=!1,o=[];var a=e.split(/\r?\n/);for(let e=0;e<a.length;e++){var l=a[e];t.test(l)?r.test(l)?(o.push(l),s=!0):n.push({start:e,end:e,match:l}):s&&(o.push(l),i.test(l))&&(n.push({start:e-o.length+1,end:e,match:o.join("\n")}),o=[],s=!1)}return n}function tsStripImports(e){var t,r,i=e.split("\n"),e=tsExtractImports(e);const n=new Set;for({start:t,end:r}of e)for(const s of numRange(t,r))n.add(s);return i.filter((e,t)=>!n.has(t)).join("\n").trimStart()}function tsStripInlineComments(e){return strip.line(e.replace(/\n\s*\/\/.*\n/g,"\n").replace(/(^|\n)\s*\/\/.*(\n|$)/g,""))}function tsCountLinesOfCode(e){return(e=strRemoveEmptyLines(e=tsStripInlineComments(e=tsStripBlockComments(e=tsStripImports(e))))).trim()?e.split("\n").length:0}function tsExtractJestTests(e){var e=e.split(/\r?\n/),t=e.findIndex(e=>e.startsWith("describe(")),r=arrFindLastIndexOf(e,e=>e.startsWith("})"));if(-1===t||-1===r)throw new Error("Could not parse the tests from the input source code.");return e.slice(t,r+1).join("\n").trim()}function tsGetClassMemberAccessModifiers(e){var t,r={};for({groups:t}of rexec(/^\s*(?<privacy>protected|private) ((static|abstract|optional|readonly|get|set|async) )*(?<name>\w+)/gm,e))r[t.name]=t.privacy;return r}function tsHasDefaultExport(e){return/^export default /m.test(e)}function tsJestConvertExportNameString(e,t){var r="describe("+t+".name";return e.replace("describe('"+t+"'",r).replace('describe("'+t+'"',r)}function tsJestEnsureLineSpacing(e){return strRemoveEmptyLines(e).split("\n").map(e=>/^(describe|it|test)\(/.test(e.trimStart())?"\n"+e:e).join("\n")}function tsSimpleMinifyCode(e){return strRemoveEmptyLines(strTrimLines(e))}function tsStripComments(e){return tsStripBlockComments(tsStripInlineComments(e))}function tsStripDeclSourceMapComments(e){return e.replace(/\n\s*\/\/#.+\.d\.ts\.map(\n|$)/g,"\n")}function tsStripExportKeyword(e){return e.replace(/^export /gm,"")}function isMultiTsDocTag(e){return/^(param|throws|see|template|typeParam|inheritDoc|link|deprecated)$/i.test(e)}function isNamedMultiTsDocTag(e){return/^(param)$/i.test(e)}function isNamedTsDocTag(e){return/^(param|property|typedef|alias|event|function|method|namespace|enum|interface|class|type|var|module)$/i.test(e)}function isValidTsDocComment(e){if(!(e=e.trim()))return!1;var t=e.split(/\r?\n/);if(t.length<2)return!1;if("/**"!==t[0].trim())return!1;if("*/"!==t[t.length-1].trim())return!1;if(2!==t.length)for(let e=1;e<t.length-1;e++)if(!t[e].trimStart().startsWith("*"))return!1;return!0}function tsDocNormalizeTagName(e){var t=e.toLowerCase();return"virtual"===t?"abstract":"augments"===t?"extends":"constructor"===t?"class":"const"===t?"constant":"defaultvalue"===t?"default":"desc"===t?"description":"host"===t?"external":"fileoverview"===t?"file":"fires"===t?"emits":"func"===t?"function":"var"===t?"member":"arg"===t?"param":"prop"===t?"property":"return"===t?"returns":"exception"===t?"throws":"yield"===t?"yields":e}class TsDocTag{constructor(e,t="",r=[]){if(e=tsDocNormalizeTagName(e),!/^[a-z]+$/i.test(e))throw new Error("Invalid tag name: "+e);if(isNamedMultiTsDocTag(this.tag=e)&&!r.join("").trim())throw new Error("Tag @"+e+" requires a description.");if(isNamedTsDocTag(e)){if(!t)throw new Error("Tag @"+e+" requires a name parameter.");if(!/^[a-z]/i.test(t))throw new Error("Name must start with char a-z: "+t);if(!/^[\w.]+$/i.test(t))throw new Error('Name may contain word chars and ".": '+t)}else{if(t)throw new Error("Tag @"+e+" does not support a name parameter.");if(!r.join("").trim())throw new Error("Tag @"+e+" requires a description.")}if(this.name=t,"example"===this.tag){e=arrFindIndicesOf(r=r.join("\n").trim().replace(/^ ?- ?/," ").split("\n"),e=>e.includes("```"));if(2===e.length){var t=e[0],i=e[1];r=r.slice(t+1,i)}else if(0!==e.length)throw new Error("Invalid example tag: markdown code block not closed.");r=["```ts",...r,"```"]}this.description=r}toString(){let e="description"===this.tag?"":"@"+this.tag;return this.name&&(e+=" "+this.name),e=e.trim(),e=this.description.length?(e+=" "+this.description.join("\n")).trim():e}}function tsDocStripTypesAndDefaults(e){for(const r of rexec(/^\s*(\* +)?@\w+ (?<type>\{.+\} )/gm,e))e=e.replace(r.groups.type,"");for(const i of rexec(/^\s*(\* +)?@\w+ (?<defaultValue>\[.+\] )/gm,e)){var t=i.groups.defaultValue.split("=")[0].trim().substring(1)+" ";e=e.replace(i.groups.defaultValue,t)}return e}function tsDocUnwrapComment(e){if(isValidTsDocComment(e))return e=strTrimLinesRight(e=(e=strRemoveFirstAndLastLine(e=e.trim())).replace(/^ *\*( |$)/gm,""));throw new Error("Invalid TSDoc comment")}function tsDocWrapAsComment(e){return["/**",strPrependLines(e," * ")," */"].join("\n")}class TsDoc{constructor(e,t){this.single=new Map,this.multi=new Map,this.namedMulti=new Map,t&&(t.tagOrder&&(this.tagOrder=Array.from(t.tagOrder)),t.paramOrder)&&(this.paramOrder=new Set(t.paramOrder)),e&&this.addBlockComment(e)}addBlockComment(e){for(const o of(e=(e=tsDocUnwrapComment(e=tsDocStripTypesAndDefaults(e))).startsWith("@")?e:"description "+e).split(/^@/gm)){var t=o.trimEnd().split(/\r?\n/),r=t[0].split(" "),i=r.shift();if(i&&this.getTagOrder().includes(i)){var n=isNamedTsDocTag(i),s=n?r.shift():"";if(!n||s){t[0]=r.join(" ").trim();let e;try{e=new TsDocTag(i,s,t)}catch(e){continue}this.addTag(e)}}}return this}get size(){let e=this.single.size;for(const t of this.namedMulti.values())e+=t.size;for(const r of this.multi.values())e+=r.length;return e}get isEmpty(){return 0===this.size}clear(){return this.single.clear(),this.multi.clear(),this.namedMulti.clear(),this}addTag(e){e.tag=tsDocNormalizeTagName(e.tag);const{tag:t,name:r,description:i}=e;var n,s;return this.getTagOrder().includes(t)&&(isNamedMultiTsDocTag(t)?(n=mapGetOrElse(this.namedMulti,t,()=>new Map)).has(r)||n.set(r,e):isMultiTsDocTag(t)?-1===(s=(n=mapGetOrElse(this.multi,t,()=>[])).findIndex(e=>arrShallowEquals(e.description,i)))?n.push(e):n[s]=e:this.single.has(t)||this.single.set(t,e)),this}removeTags(e,t){var r;return e=tsDocNormalizeTagName(e),this.getTagOrder().includes(e)&&(isNamedMultiTsDocTag(e)?void 0!==t?null!=(r=this.namedMulti.get(e))&&r.delete(t):this.namedMulti.delete(e):(isMultiTsDocTag(e)?this.multi:this.single).delete(e)),this}*iterateTags(e){this.reorderParams();for(const i of this.getTagOrder())if(e&&""===i&&(yield i),isNamedMultiTsDocTag(i)){var t=this.namedMulti.get(i);if(t)for(const n of t.values())yield n}else if(isMultiTsDocTag(i)){t=this.multi.get(i);if(t)for(const s of t)yield s}else{var r=this.single.get(i);r&&(yield r)}}clone(){return new TsDoc(this.render())}assign(e){for(const t of e.iterateTags())t&&this.addTag(t);return this}reorderParams(){if(this.paramOrder){var e=this.namedMulti.get("param");if(e){var t=new Map;for(const i of this.paramOrder){var r=e.get(i);r&&t.set(i,r)}this.namedMulti.set("param",t)}}return this}render(){return tsDocWrapAsComment([...this.iterateTags(!0)].join("\n"))}toString(){return this.render()}getTagOrder(){return this.tagOrder||TsDoc.defaultTagOrder}}function tsDocExtractFirstComment(e){for(const t of tsDocExtractAllComments(e))return t}function tsDocFixSpacingBeforeAfter(e){return e.replace(/ \*\/\s*\n\n/g," */\n").split(/\r?\n/).map((e,t,r)=>/^(\s*\/\*\*\s*)$/.test(e)&&t&&r[t-1].trim()?"\n"+e:e).join("\n")}function tsDocRemoveEmptyLines(e){return e.replace(/(^|\n) *\* *(\n|$)/g,"\n")}function tsDocStripAllTagsButThrowsParamDescription(e){let t=e+"";for(var{match:r}of tsDocExtractAllComments(e)){var i=new TsDoc(r),n=i.single.get("description"),s=i.namedMulti.get("param"),o=i.multi.get("throws");i.clear(),n&&i.single.set("description",n),s&&i.namedMulti.set("param",s),o&&i.multi.set("throws",o),t=null===t||void 0===t?void 0:t.replace(r,i.render())}return t}function tsDocStripExample(e){let t=e+"";for(var{match:r}of tsDocExtractAllComments(e)){var i=new TsDoc(r);i.removeTags("example"),t=null===t||void 0===t?void 0:t.replace(r,i.render())}return t}function tsDocWrapExample(e){return" * @example ```ts\n"+e.split("\n").map(e=>" * "+e).join("\n")+"\n * ```"}function assertNegativeInteger(e){if(Number.isInteger(e)&&e<=0)return e;throw new TypeError("Expected int to be a negative integer. Got: "+e)}function assertNonZeroNegativeInteger(e){if(Number.isInteger(e)&&e<0)return e;throw new TypeError("Expected int to be a non-zero negative integer. Got: "+e)}function assertNonZeroPositiveInteger(e){if(Number.isInteger(e)&&0<e)return e;throw new TypeError("Expected a non-zero positive integer. Got: "+e)}function isHex(e){return regHex.test(e)}function isHexOrUnicode(e){return/^(\\\\?u|0x)?[\da-f]+$/i.test(e)}function isInteger(e){return Number.isInteger(e)}function isIterable(e){return"string"==typeof e||"undefined"!=typeof Symbol&&Symbol&&"iterator"in Symbol&&null!=e&&"object"==typeof e&&Symbol.iterator in e&&"function"==typeof e[Symbol.iterator]}function isNegativeInteger(e){return Number.isInteger(e)&&e<0}function isNumericString(e){var e=e.trim();return!!e&&(e=Number(e),!isNaN(e))&&isFinite(e)}function isPositiveInteger(e){return Number.isInteger(e)&&0<e}function parseSocialSecurityNumberDK(e){e=e.match(regexMatcherToValidater(regSocialSecurityNumbersDK));if(e&&e.groups){var{dd:e,mm:t,yy:r,id4:i}=e.groups,e=parseInt(e),t=parseInt(t),n=getCurrentYear(),s=parseInt(r)>parseInt(String(n).substring(2)),n=parseInt(""+(getCentury(n)-(s?2:1))+r);if(isValidDate(n,t,e))return{year:n,month:t,day:e,id:parseInt(i),sex:isEven(parseInt(i.substring(3)))?"F":"M"}}}function isSocialSecurityNumberDK(e){return!!parseSocialSecurityNumberDK(e)}TsDoc.defaultTagOrder=["description","remarks","typeParam","template","param","returns","yields","emits","throws","method","example"],exports.A1ToColRow=A1ToColRow,exports.AbstractApiClient=AbstractApiClient,exports.AbstractFsPath=AbstractFsPath,exports.ApiReponseCache=ApiReponseCache,exports.BlockDevicePath=BlockDevicePath,exports.CharacterDevicePath=CharacterDevicePath,exports.DirectoryPath=DirectoryPath,exports.ExtensibleFunction=ExtensibleFunction,exports.FIFOPath=FIFOPath,exports.FilePath=FilePath,exports.Logger=Logger,exports.MS_IN_DAY=MS_IN_DAY,exports.MS_IN_HOUR=MS_IN_HOUR,exports.MS_IN_MINUTE=MS_IN_MINUTE,exports.MS_IN_MONTH=MS_IN_MONTH,exports.MS_IN_SECOND=MS_IN_SECOND,exports.MS_IN_WEEK=MS_IN_WEEK,exports.MS_IN_YEAR=MS_IN_YEAR,exports.Matrix=Matrix,exports.MixinBase=MixinBase,exports.MixinEventEmitter=MixinEventEmitter,exports.MixinIndexed=MixinIndexed,exports.MixinTimestamped=MixinTimestamped,exports.NumberFormatter=NumberFormatter,exports.OpenaiApiClient=OpenaiApiClient,exports.OpenaiApiClientExtended=OpenaiApiClientExtended,exports.PriorityQueue=PriorityQueue,exports.PromiseQueue=PromiseQueue,exports.Queue=Queue,exports.SRTSubtitle=SRTSubtitle,exports.SRTSubtitles=SRTSubtitles,exports.SimpleTable=SimpleTable,exports.SocketPath=SocketPath,exports.SortedArray=SortedArray,exports.StringStream=StringStream,exports.SymbolicLinkPath=SymbolicLinkPath,exports.Time=Time,exports.TimeInterval=TimeInterval,exports.TsDoc=TsDoc,exports.TsDocTag=TsDocTag,exports.VTTSubtitle=VTTSubtitle,exports.VTTSubtitles=VTTSubtitles,exports._AbstractSubtitle=_AbstractSubtitle,exports._HTML_ATTRIBUTES=_HTML_ATTRIBUTES,exports._HTML_BOOLEAN_ATTRIBUTES=_HTML_BOOLEAN_ATTRIBUTES,exports._HTML_ELEMENTS=_HTML_ELEMENTS,exports._HTML_EVENT_ATTRIBUTES=_HTML_EVENT_ATTRIBUTES,exports._HTML_GLOBAL_ATTRIBUTES=_HTML_GLOBAL_ATTRIBUTES,exports._HTML_VOID_ELEMENTS=_HTML_VOID_ELEMENTS,exports._HtmlAttribute=_HtmlAttribute,exports._HtmlDocument=_HtmlDocument,exports._HtmlElement=_HtmlElement,exports.absoluteToRelativePath=absoluteToRelativePath,exports.appendLineToFile=appendLineToFile,exports.arrAverage=arrAverage,exports.arrEachToString=arrEachToString,exports.arrEvery=arrEvery,exports.arrFindIndicesOf=arrFindIndicesOf,exports.arrFindLast=arrFindLast,exports.arrFindLastIndexOf=arrFindLastIndexOf,exports.arrFlatten=arrFlatten,exports.arrIndicesOf=arrIndicesOf,exports.arrLast=arrLast,exports.arrMapMutable=arrMapMutable,exports.arrObjectsToTable=arrObjectsToTable,exports.arrObjectsUniqueKeys=arrObjectsUniqueKeys,exports.arrRemoveDuplicates=arrRemoveDuplicates,exports.arrShallowEquals=arrShallowEquals,exports.arrShuffle=arrShuffle,exports.arrSome=arrSome,exports.arrSortNumeric=arrSortNumeric,exports.arrSortedInsertionIndex=arrSortedInsertionIndex,exports.arrSum=arrSum,exports.arrSwap=arrSwap,exports.arrTableAssertRowsSameLength=arrTableAssertRowsSameLength,exports.arrTableEachToString=arrTableEachToString,exports.arrTableToCsv=arrTableToCsv,exports.arrTableToObjects=arrTableToObjects,exports.assertInteger=assertInteger,exports.assertNegativeInteger=assertNegativeInteger,exports.assertNonZeroNegativeInteger=assertNonZeroNegativeInteger,exports.assertNonZeroPositiveInteger=assertNonZeroPositiveInteger,exports.assertPositiveInteger=assertPositiveInteger,exports.assertPowerOfTen=assertPowerOfTen,exports.assertValidDate=assertValidDate,exports.assertValidDateDay=assertValidDateDay,exports.assertValidDateMonth=assertValidDateMonth,exports.assertValidDateYear=assertValidDateYear,exports.assertValidHours=assertValidHours,exports.assertValidMilliseconds=assertValidMilliseconds,exports.assertValidMinutes=assertValidMinutes,exports.assertValidNumber=assertValidNumber,exports.assertValidSeconds=assertValidSeconds,exports.assertValidTime=assertValidTime,exports.assertValidTimeArray=assertValidTimeArray,exports.assertValidTimeInt=assertValidTimeInt,exports.assertValidTimeString=assertValidTimeString,exports.assertValidTimeStringFormatting=assertValidTimeStringFormatting,exports.asyncTasksLimit=asyncTasksLimit,exports.asyncTasksParallel=asyncTasksParallel,exports.asyncTasksSerial=asyncTasksSerial,exports.asyncWithTimeout=asyncWithTimeout,exports.atob=atob,exports.attr=attr,exports.btoa=btoa,exports.buildRegexBetween=buildRegexBetween,exports.bytesToInt=bytesToInt,exports.cleanDirectorySync=cleanDirectorySync,exports.colRowToA1=colRowToA1,exports.colToLetter=colToLetter,exports.comment=comment,exports.compareArray=compareArray,exports.compareNumber=compareNumber,exports.compareNumberDescending=compareNumberDescending,exports.compareNumeric=compareNumeric,exports.compareNumericDescending=compareNumericDescending,exports.compareString=compareString,exports.compareStringDescending=compareStringDescending,exports.convertFilter=convertFilter,exports.createDirectory=createDirectory,exports.createDirectorySync=createDirectorySync,exports.createFileExtensionFilter=createFileExtensionFilter,exports.createObjectFactory=createObjectFactory,exports.csvParseStream=csvParseStream,exports.cwdpath=cwdpath,exports.dateDaysAgo=dateDaysAgo,exports.dateWeekDayName=dateWeekDayName,exports.daysSinceDate=daysSinceDate,exports.deleteDirectory=deleteDirectory,exports.deleteDirectorySafe=deleteDirectorySafe,exports.deleteDirectorySafeSync=deleteDirectorySafeSync,exports.deleteDirectorySync=deleteDirectorySync,exports.el=el,exports.ensureValidWindowsPath=ensureValidWindowsPath,exports.findFile=findFile,exports.funAsyncAutoRateLimit=funAsyncAutoRateLimit,exports.funAsyncRateLimit=funAsyncRateLimit,exports.funParseClass=funParseClass,exports.funParseFunction=funParseFunction,exports.funSetName=funSetName,exports.getCentury=getCentury,exports.getConstructor=getConstructor,exports.getCurrentYear=getCurrentYear,exports.getDownloadsDirectory=getDownloadsDirectory,exports.getHomeDirectory=getHomeDirectory,exports.getLastMofifiedFileIn=getLastMofifiedFileIn,exports.getOrElse=getOrElse,exports.getOrThrow=getOrThrow,exports.getPrototype=getPrototype,exports.hoursSinceDate=hoursSinceDate,exports.inheritStaticMembers=inheritStaticMembers,exports.instantiateCorrectFsPathSubclass=instantiateCorrectFsPathSubclass,exports.intToArrayBytes=intToArrayBytes,exports.intToBuffer=intToBuffer,exports.intToBytes=intToBytes,exports.isConstructor=isConstructor,exports.isEven=isEven,exports.isHex=isHex,exports.isHexOrUnicode=isHexOrUnicode,exports.isInRange=isInRange,exports.isInteger=isInteger,exports.isIterable=isIterable,exports.isLeapYear=isLeapYear,exports.isMultiTsDocTag=isMultiTsDocTag,exports.isNamedMultiTsDocTag=isNamedMultiTsDocTag,exports.isNamedTsDocTag=isNamedTsDocTag,exports.isNegativeInteger=isNegativeInteger,exports.isNumericString=isNumericString,exports.isObject=isObject,exports.isOdd=isOdd,exports.isPositiveInteger=isPositiveInteger,exports.isPowerOfTen=isPowerOfTen,exports.isPrototype=isPrototype,exports.isSocialSecurityNumberDK=isSocialSecurityNumberDK,exports.isValidDate=isValidDate,exports.isValidDateDay=isValidDateDay,exports.isValidDateMonth=isValidDateMonth,exports.isValidDateYear=isValidDateYear,exports.isValidHours=isValidHours,exports.isValidMilliseconds=isValidMilliseconds,exports.isValidMinutes=isValidMinutes,exports.isValidNumber=isValidNumber,exports.isValidSeconds=isValidSeconds,exports.isValidTime=isValidTime,exports.isValidTimeArray=isValidTimeArray,exports.isValidTimeInt=isValidTimeInt,exports.isValidTimeString=isValidTimeString,exports.isValidTimeStringFormatting=isValidTimeStringFormatting,exports.isValidTsDocComment=isValidTsDocComment,exports.isoDateTimestamp=isoDateTimestamp,exports.isoDateTimestampForFilename=isoDateTimestampForFilename,exports.iterableFirstElement=iterableFirstElement,exports.iteratePrototypeChain=iteratePrototypeChain,exports.letterToCol=letterToCol,exports.log=log,exports.mapGetOrElse=mapGetOrElse,exports.mapReverse=mapReverse,exports.mapUpdate=mapUpdate,exports.markdownWrapCodeBlock=markdownWrapCodeBlock,exports.memoryUsage=memoryUsage,exports.minutesSinceDate=minutesSinceDate,exports.monthsSinceDate=monthsSinceDate,exports.msSinceDate=msSinceDate,exports.normalizeFileExtension=normalizeFileExtension,exports.normalizeLineLengths=normalizeLineLengths,exports.numDaysInMonth=numDaysInMonth,exports.numRange=numRange,exports.objAssignDeep=objAssignDeep,exports.objDeepFreeze=objDeepFreeze,exports.objDelete=objDelete,exports.objEntries=objEntries,exports.objEntriesArray=objEntriesArray,exports.objFilter=objFilter,exports.objForEach=objForEach,exports.objGet=objGet,exports.objGetOrElse=objGetOrElse,exports.objHas=objHas,exports.objIsEmpty=objIsEmpty,exports.objKeys=objKeys,exports.objKeysArray=objKeysArray,exports.objMap=objMap,exports.objMapKeys=objMapKeys,exports.objMapMutable=objMapMutable,exports.objOmitKeys=objOmitKeys,exports.objOmitKeysMutable=objOmitKeysMutable,exports.objPropertyValueToGetter=objPropertyValueToGetter,exports.objReduce=objReduce,exports.objReverse=objReverse,exports.objSet=objSet,exports.objSize=objSize,exports.objSortKeys=objSortKeys,exports.objToMap=objToMap,exports.objUpdate=objUpdate,exports.objUpdatePropertyDescriptors=objUpdatePropertyDescriptors,exports.objValues=objValues,exports.objValuesArray=objValuesArray,exports.objWalk=objWalk,exports.openaiApiErrorCodes=openaiApiErrorCodes,exports.padArrayBytesLeft=padArrayBytesLeft,exports.padArrayBytesRight=padArrayBytesRight,exports.parseMarkdownCodeBlock=parseMarkdownCodeBlock,exports.parseMarkdownTable=parseMarkdownTable,exports.parseSocialSecurityNumberDK=parseSocialSecurityNumberDK,exports.pdfGetPages=pdfGetPages,exports.pdfIteratePages=pdfIteratePages,exports.pdfSplitPages=pdfSplitPages,exports.prettyIsoDateString=prettyIsoDateString,exports.randomIntBetween=randomIntBetween,exports.readExcelFile=readExcelFile,exports.readJsonFile=readJsonFile,exports.readJsonFileSync=readJsonFileSync,exports.regBlockCommentsWithIndent=regBlockCommentsWithIndent,exports.regFunctionsExports=regFunctionsExports,exports.regHex=regHex,exports.regHexPrefix=regHexPrefix,exports.regInteger=regInteger$1,exports.regJestTests=regJestTests,exports.regLocaleAlpha=regLocaleAlpha,exports.regLocaleAlphaNumeric=regLocaleAlphaNumeric,exports.regNumberCommaSepDotDecimal=regNumberCommaSepDotDecimal,exports.regNumberDotSepCommaDecimal=regNumberDotSepCommaDecimal,exports.regNumberNoThousandSepCommaDecimal=regNumberNoThousandSepCommaDecimal,exports.regNumberNoThousandSepDotDecimal=regNumberNoThousandSepDotDecimal,exports.regPowerOfTen=regPowerOfTen,exports.regRepeatingWhiteSpace=regRepeatingWhiteSpace,exports.regSocialSecurityNumbersDK=regSocialSecurityNumbersDK,exports.regTsDocExampleLines=regTsDocExampleLines,exports.regWords=regWords,exports.regexClone=regexClone,exports.regexEscapeString=regexEscapeString,exports.regexFixFlags=regexFixFlags,exports.regexGetGroupNames=regexGetGroupNames,exports.regexIsValidFlags=regexIsValidFlags,exports.regexMatcherToValidater=regexMatcherToValidater,exports.regexScopeTree=regexScopeTree,exports.regexValidFlags=regexValidFlags,exports.removeIllegalFilenameCharacters=removeIllegalFilenameCharacters,exports.rexec=rexec,exports.rexecFirstMatch=rexecFirstMatch,exports.round=round,exports.roundDown=roundDown,exports.roundToNearest=roundToNearest,exports.roundToNearestPow10=roundToNearestPow10,exports.roundUp=roundUp,exports.roundWith=roundWith,exports.secondsSinceDate=secondsSinceDate,exports.setAddMany=setAddMany,exports.setDifference=setDifference,exports.setEnumerable=setEnumerable,exports.setIntersection=setIntersection,exports.setIsSuperset=setIsSuperset,exports.setNonConfigurable=setNonConfigurable,exports.setNonEnumerable=setNonEnumerable,exports.setNonWritable=setNonWritable,exports.setSymmetricDifference=setSymmetricDifference,exports.setUnion=setUnion,exports.setWritable=setWritable,exports.shellSpawnProgram=shellSpawnProgram,exports.strCountCharOccurances=strCountCharOccurances,exports.strCountChars=strCountChars,exports.strCountWords=strCountWords,exports.strEnsureEndsWith=strEnsureEndsWith,exports.strFirstCharToUpperCase=strFirstCharToUpperCase,exports.strHashToBuffer=strHashToBuffer,exports.strHashToString=strHashToString,exports.strHashToStringDJB2=strHashToStringDJB2,exports.strHashToUint32Array=strHashToUint32Array,exports.strIsLowerCase=strIsLowerCase,exports.strIsMultiLine=strIsMultiLine,exports.strIsUpperCase=strIsUpperCase,exports.strNoConsecutiveEmptyLines=strNoConsecutiveEmptyLines,exports.strNoConsecutiveWhitespace=strNoConsecutiveWhitespace,exports.strParseBoolean=strParseBoolean,exports.strPrependLines=strPrependLines,exports.strRemoveDuplicateChars=strRemoveDuplicateChars,exports.strRemoveEmptyLines=strRemoveEmptyLines,exports.strRemoveFirstAndLastLine=strRemoveFirstAndLastLine,exports.strRemoveNewLines=strRemoveNewLines,exports.strRepeat=strRepeat,exports.strReplaceAll=strReplaceAll,exports.strSortChars=strSortChars,exports.strSplitAndTrim=strSplitAndTrim,exports.strSplitCamelCase=strSplitCamelCase,exports.strToCharCodes=strToCharCodes,exports.strToCharSet=strToCharSet,exports.strToSentences=strToSentences,exports.strToSortedCharSet=strToSortedCharSet,exports.strToWords=strToWords,exports.strTrimLines=strTrimLines,exports.strTrimLinesLeft=strTrimLinesLeft,exports.strTrimLinesRight=strTrimLinesRight,exports.strUnwrap=strUnwrap,exports.strWrapBetween=strWrapBetween,exports.strWrapIn=strWrapIn,exports.strWrapInAngleBrackets=strWrapInAngleBrackets,exports.strWrapInBraces=strWrapInBraces,exports.strWrapInBrackets=strWrapInBrackets,exports.strWrapInDoubleQuotes=strWrapInDoubleQuotes,exports.strWrapInParenthesis=strWrapInParenthesis,exports.strWrapInSingleQuotes=strWrapInSingleQuotes,exports.streamToString=streamToString,exports.tableFrom=tableFrom,exports.timeArrayToInt=timeArrayToInt,exports.timeArrayToIntUnsafe=timeArrayToIntUnsafe,exports.timeArrayToString=timeArrayToString,exports.timeArrayToStringUnsafe=timeArrayToStringUnsafe,exports.timeIntToArray=timeIntToArray,exports.timeIntToArrayUnsafe=timeIntToArrayUnsafe,exports.timeIntToString=timeIntToString,exports.timeIntToStringUnsafe=timeIntToStringUnsafe,exports.timeStringToArray=timeStringToArray,exports.timeStringToArrayUnsafe=timeStringToArrayUnsafe,exports.timeStringToInt=timeStringToInt,exports.timeStringToIntUnsafe=timeStringToIntUnsafe,exports.toJson=toJson,exports.trimArrayBytesLeft=trimArrayBytesLeft,exports.trimArrayBytesRight=trimArrayBytesRight,exports.tsCountExports=tsCountExports,exports.tsCountLinesOfCode=tsCountLinesOfCode,exports.tsDocExtractAllComments=tsDocExtractAllComments,exports.tsDocExtractFirstComment=tsDocExtractFirstComment,exports.tsDocFixSpacingBeforeAfter=tsDocFixSpacingBeforeAfter,exports.tsDocNormalizeTagName=tsDocNormalizeTagName,exports.tsDocRemoveEmptyLines=tsDocRemoveEmptyLines,exports.tsDocStripAllTagsButThrowsParamDescription=tsDocStripAllTagsButThrowsParamDescription,exports.tsDocStripExample=tsDocStripExample,exports.tsDocStripTypesAndDefaults=tsDocStripTypesAndDefaults,exports.tsDocUnwrapComment=tsDocUnwrapComment,exports.tsDocWrapAsComment=tsDocWrapAsComment,exports.tsDocWrapExample=tsDocWrapExample,exports.tsExtractImports=tsExtractImports,exports.tsExtractJestTests=tsExtractJestTests,exports.tsGetClassMemberAccessModifiers=tsGetClassMemberAccessModifiers,exports.tsHasDefaultExport=tsHasDefaultExport,exports.tsJestConvertExportNameString=tsJestConvertExportNameString,exports.tsJestEnsureLineSpacing=tsJestEnsureLineSpacing,exports.tsSimpleMinifyCode=tsSimpleMinifyCode,exports.tsStripBlockComments=tsStripBlockComments,exports.tsStripComments=tsStripComments,exports.tsStripDeclSourceMapComments=tsStripDeclSourceMapComments,exports.tsStripExportKeyword=tsStripExportKeyword,exports.tsStripImports=tsStripImports,exports.tsStripInlineComments=tsStripInlineComments,exports.unzipFile=unzipFile,exports.unzipMergeFiles=unzipMergeFiles,exports.wait=wait,exports.waitSeconds=waitSeconds,exports.walkDirectory=walkDirectory,exports.walkDirectoryEmitter=walkDirectoryEmitter,exports.walkDirectorySync=walkDirectorySync,exports.weeksSinceDate=weeksSinceDate,exports.wipeDirectorySafe=wipeDirectorySafe,exports.writeExcelFile=writeExcelFile,exports.writeJsonFile=writeJsonFile,exports.writeJsonFileSync=writeJsonFileSync,exports.yearsSinceDate=yearsSinceDate;