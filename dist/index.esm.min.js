import l from"async-retry";import s from"events";import{cloneDeep as u,words as m}from"lodash";import"dotenv/config";import{blackBright as f,green as p,yellow as g,red as y}from"cli-color";import c from"fs";import h from"path";import{mkdirp as v,mkdirpSync as w}from"mkdirp";import b from"appdata-path";import{Level as S}from"level";import T from"object-hash";import{encode as _}from"gpt-3-encoder";import{OpenAIApi as x,Configuration as E}from"openai";import{titleCase as D}from"title-case";import I from"exceljs";import C from"extract-zip";import a from"walkdir";import{parseScript as A}from"esprima";import O from"pretty-error";import{createHash as j}from"crypto";import P from"child_process";import{Readable as F}from"stream";import M from"deep-assign";import N from"csv-parser";import R from"pdf-parse";import{PDFDocument as d}from"pdf-lib";import{split as L}from"sentence-splitter";import k from"strip-comments";function __awaiter(e,n,i,s){return new(i=i||Promise)(function(t,r){function fulfilled(e){try{step(s.next(e))}catch(e){r(e)}}function rejected(e){try{step(s.throw(e))}catch(e){r(e)}}function step(e){e.done?t(e.value):function adopt(t){return t instanceof i?t:new i(function(e){e(t)})}(e.value).then(fulfilled,rejected)}step((s=s.apply(e,n||[])).next())})}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&n>=e.length?void 0:e)&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){var i,s,o;if(Symbol.asyncIterator)return i=r.apply(e,t||[]),s=[],o={},verb("next"),verb("throw"),verb("return"),o[Symbol.asyncIterator]=function(){return this},o;throw new TypeError("Symbol.asyncIterator is not defined.");function verb(n){i[n]&&(o[n]=function(r){return new Promise(function(e,t){1<s.push([n,r,e,t])||resume(n,r)})})}function resume(e,t){try{!function step(e){e.value instanceof __await?Promise.resolve(e.value.v).then(fulfill,reject):settle(s[0][2],e)}(i[e](t))}catch(e){settle(s[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),s.shift(),s.length&&resume(s[0][0],s[0][1])}}function __asyncValues(i){var e,t;if(Symbol.asyncIterator)return(e=i[Symbol.asyncIterator])?e.call(i):(i=__values(i),t={},verb("next"),verb("throw"),verb("return"),t[Symbol.asyncIterator]=function(){return this},t);throw new TypeError("Symbol.asyncIterator is not defined.");function verb(n){t[n]=i[n]&&function(r){return new Promise(function(e,t){(function settle(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(e,t,(r=i[n](r)).done,r.value)})}}}function arrSortedInsertionIndex(e,t,r){let n=0,i=e.length;for(;0<i;){var s=Math.trunc(i/2),o=n+s;r(e[o],t)<=0?(n=++o,i-=s+1):i=s}return n}class PriorityQueue{constructor(){this.queue=[]}get size(){return this.queue.length}enqueue(e,t){e={priority:(t=Object.assign({priority:0},t)).priority,run:e};this.size&&this.queue[this.size-1].priority>=t.priority?this.queue.push(e):(t=arrSortedInsertionIndex(this.queue,e,(e,t)=>t.priority-e.priority),this.queue.splice(t,0,e))}dequeue(){var e=this.queue.shift();return null==e?void 0:e.run}filter(t){return this.queue.filter(e=>e.priority===t.priority).map(e=>e.run)}}class PromiseQueue extends s{constructor(e){var t;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pending=0,!("number"==typeof(e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue},e)).intervalCap&&1<=e.intervalCap))throw new TypeError(`Expected 'intervalCap' to be a number from 1 and up, got '${null!=(t=null==(t=e.intervalCap)?void 0:t.toString())?t:""}' (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&0<=e.interval))throw new TypeError(`Expected 'interval' to be a finite number >= 0, got '${null!=(t=null==(t=e.interval)?void 0:t.toString())?t:""}' (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._isPaused=!1===e.autoStart}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pending<this._concurrency}_next(){this._pending--,this._tryToStartAnother(),this.emit("next")}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}get _isIntervalPaused(){var e=Date.now();if(void 0===this._intervalId){e=this._intervalEnd-e;if(!(e<0))return void 0===this._timeoutId&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},e)),!0;this._intervalCount=this._carryoverConcurrencyCount?this._pending:0}return!1}_tryToStartAnother(){if(0===this._queue.size)this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this.emit("empty"),0===this._pending&&this.emit("idle");else if(!this._isPaused){var e,t=!this._isIntervalPaused;if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother)return!!(e=this._queue.dequeue())&&(this.emit("active"),e(),t&&this._initializeIntervalIfNeeded(),!0)}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||void 0!==this._intervalId||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){0===this._intervalCount&&0===this._pending&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pending:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!("number"==typeof e&&1<=e))throw new TypeError(`Expected 'concurrency' to be a number from 1 and up, got '${e}' (${typeof e})`);this._concurrency=e,this._processQueue()}_throwOnAbort(r){return __awaiter(this,void 0,void 0,function*(){return new Promise((e,t)=>{r.addEventListener("abort",()=>{t(new Error("The task was aborted."))},{once:!0})})})}add(s,o={}){return __awaiter(this,void 0,void 0,function*(){return o=Object.assign({},o),new Promise((n,i)=>{this._queue.enqueue(()=>__awaiter(this,void 0,void 0,function*(){var t;this._pending++,this._intervalCount++;try{if(null!=(t=o.signal)&&t.aborted)throw new Error("The task was aborted.");let e=s({signal:o.signal});var r=yield e=o.signal?Promise.race([e,this._throwOnAbort(o.signal)]):e;n(r),this.emit("completed",r)}catch(e){i(e),this.emit("error",e)}finally{this._next()}}),o),this.emit("add"),this._tryToStartAnother()})})}addAll(e,t){return __awaiter(this,void 0,void 0,function*(){return Promise.all(e.map(e=>__awaiter(this,void 0,void 0,function*(){return this.add(e,t)})))})}start(){return this._isPaused&&(this._isPaused=!1,this._processQueue()),this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}onEmpty(){return __awaiter(this,void 0,void 0,function*(){0!==this._queue.size&&(yield this._onEvent("empty"))})}onSizeLessThan(e){return __awaiter(this,void 0,void 0,function*(){this._queue.size<e||(yield this._onEvent("next",()=>this._queue.size<e))})}onIdle(){return __awaiter(this,void 0,void 0,function*(){0===this._pending&&0===this._queue.size||(yield this._onEvent("idle"))})}_onEvent(r,n){return __awaiter(this,void 0,void 0,function*(){return new Promise(e=>{const t=()=>{n&&!n()||(this.off(r,t),e())};this.on(r,t)})})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pending}get isPaused(){return this._isPaused}}function funSetName(e,t){return Object.defineProperty(t,"name",{value:e,configurable:!0}),t}function funAsyncRateLimit(t,e={}){const r=new PromiseQueue(e);e=funSetName(t.name,function(...e){return __awaiter(this,void 0,void 0,function*(){return yield r.add(()=>__awaiter(this,void 0,void 0,function*(){return yield t.call(r,...e)}))})});return[r,e]}const V=864e5;function isoDateTimestampForFilename(e=new Date){return e.toISOString().replace(/[-:T.]/g,"-").replace("Z","")}function createDirectory(e){return __awaiter(this,void 0,void 0,function*(){return yield v(e),e})}function appendLineToFile(e,t,r=!1){return __awaiter(this,void 0,void 0,function*(){c.existsSync(e)||(yield createDirectory(h.dirname(e)),yield c.promises.writeFile(e,"")),yield c.promises.appendFile(e,r?"\n"+t:t+"\n")})}function cleanDirectorySync(e,t){for(const n of c.readdirSync(e)){var r=h.join(e,n);t(r,c.statSync(r))&&c.unlinkSync(r)}}function createDirectorySync(e){return w(e),e}function strRepeat(e,t){return new Array(t).fill(e).join("")}function isObject(e){return null!==e&&"object"==typeof e}var o;(t=o=o||{}).NONE="none",t.DEBUG="debug",t.INFO="info",t.WARN="warn",t.ERROR="error";class Logger{constructor(e={}){var t=Logger.optionDefaults,t=Object.assign(Object.assign({},t),e);this.debugColor=t.debugColor,this.infoColor=t.infoColor,this.warnColor=t.warnColor,this.errorColor=t.errorColor,this.consoleLogLevel=t.consoleLogLevel,this.debugToConsole=this.consoleLogLevel===o.DEBUG,this.infoToConsole=this.debugToConsole||this.consoleLogLevel===o.INFO,this.warnToConsole=this.infoToConsole||this.consoleLogLevel===o.WARN,this.errorToConsole=this.warnToConsole||this.consoleLogLevel===o.ERROR,this.fileLogLevel=t.fileLogLevel,this.debugToFile=this.fileLogLevel===o.DEBUG,this.infoToFile=this.debugToFile||this.fileLogLevel===o.INFO,this.warnToFile=this.infoToFile||this.fileLogLevel===o.WARN,this.errorToFile=this.warnToFile||this.fileLogLevel===o.ERROR,this.logDirpath=h.resolve(t.logDirpath),this.fileLogLevel!==o.NONE&&createDirectorySync(this.logDirpath),this.logFilepath=h.join(this.logDirpath,isoDateTimestampForFilename()+".txt"),this.deleteLogFiles(t.deleteFilesOlderThan),this.fileLogLevel!==o.NONE&&this.info("Log file created.")}initialize(e={}){Object.assign(this,new Logger(e))}debug(e,t){return this.debugToFile&&this._logToFile(o.DEBUG,e),this.debugToConsole&&this._logToConsole(o.DEBUG,e,this.debugColor,t),e}info(e,t){return this.infoToFile&&this._logToFile(o.INFO,e),this.infoToConsole&&this._logToConsole(o.INFO,e,this.infoColor,t),e}warn(e,t){return this.warnToFile&&this._logToFile(o.WARN,e),this.warnToConsole&&this._logToConsole(o.WARN,e,this.warnColor,t),e}error(e,t){return this.errorToFile&&this._logToFile(o.ERROR,e),this.errorToConsole&&this._logToConsole(o.ERROR,e,this.errorColor,t),e}task(r,n){return __awaiter(this,void 0,void 0,function*(){this.info(`Began: ${r}.`);var e=Date.now(),t=yield n();return this.debug(`Ended: ${r}. (${((Date.now()-e)/1e3).toString()} seconds)`),t})}taskSync(e,t){this.info(`Began: ${e}.`);var r=Date.now(),t=t();return this.debug(`Ended: ${e}. (${((Date.now()-r)/1e3).toString()} seconds)`),t}deleteLogFiles(r=0){0!==r&&c.existsSync(this.logDirpath)&&cleanDirectorySync(this.logDirpath,(e,t)=>{t=(Date.now()-t.ctimeMs)/V;return r<t})}newline(e=10){console.log(strRepeat("\n",e))}dashline(t=1,e=80){var r=f(strRepeat("-",e));for(let e=0;e<t;e++)console.log(r)}logEmitterEvents(e,t={}){const{eventNamePrefix:n,debug:r,info:i,warn:s,error:o}=t;for(const[a,l]of Object.entries({debug:r,info:i,warn:s,error:o}))if(l)for(const u of l)e.on(u,(e,t,r)=>{this[a](Object.assign({type:n,info:e},isObject(t)?t:void 0===t?{}:{data:t}))})}_logToFile(e,t){var r=(new Date).toISOString(),t=JSON.stringify({message:t}),e=e.padEnd(5," ")+`|${r}|`+t;appendLineToFile(this.logFilepath,e,!1).catch(e=>{console.error(e)})}_logToConsole(t,r,n,e){var i=t===o.WARN?console.warn:t===o.ERROR?console.error:console.log;if(isObject(r))i(`[${n(t)}]:`),void 0!==e?console.dir(r,{depth:e}):i(r);else{let e=r+"";e.includes("\n")&&(e="\n"+e),i(`[${n(t)}]: `+n(e)+"")}}getProperties(){return{consoleLogLevel:this.consoleLogLevel,debugToConsole:this.debugToConsole,infoToConsole:this.infoToConsole,warnToConsole:this.warnToConsole,errorToConsole:this.errorToConsole,fileLogLevel:this.fileLogLevel,debugToFile:this.debugToFile,infoToFile:this.infoToFile,warnToFile:this.warnToFile,errorToFile:this.errorToFile,logDirpath:this.logDirpath,logFilepath:this.logFilepath,debugColor:this.debugColor,infoColor:this.infoColor,warnColor:this.warnColor,errorColor:this.errorColor}}}Logger.optionDefaults={consoleLogLevel:o.DEBUG,fileLogLevel:o.NONE,logDirpath:h.join(process.cwd(),"logs"),deleteFilesOlderThan:0,debugColor:f,infoColor:p,warnColor:g,errorColor:y};const e=new Logger({});function objUpdatePropertyDescriptors(e,t,r){for(const i of t){if(!Object.hasOwn(e,i))throw new Error(`Property, '${i}' does not exist on object.`);var n=r(Object.getOwnPropertyDescriptor(e,i),i);Object.defineProperty(e,i,n)}}function setNonEnumerable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.enumerable=!1,e))}class ApiReponseCache{constructor(e){this.events=new s;var e=Object.assign({},ApiReponseCache.optionsDefaults,e),{name:t,dirpath:r,maxAgeMs:n,logAllEvents:i}=e,i=(!0===i?this.logAllEvents():void 0===i&&this.logWarnErrorEvents(),this.emit("options",e),this.maxAgeMs=n,createDirectorySync(h.join(r,t)));this.db=new S(i),setNonEnumerable(this,"db")}hashKey(e){return T(void 0===e?"undefined":e,{algorithm:"sha1",encoding:"base64"})}getOrElse(r,n){return __awaiter(this,void 0,void 0,function*(){try{var t=yield this.get(r);return this.emit("hit",r),t}catch(e){this.emit("miss",r);t=yield n();return yield this.put(r,t)}})}get(t){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){var e=yield this.db.get(t);return yield this.ensureNotExpired(t,e),this.emit("get",t),this.parseSerializedValue(e)}))})}getSafe(t){return __awaiter(this,void 0,void 0,function*(){try{var e=yield this.db.get(t);return yield this.ensureNotExpired(t,e),this.emit("get",t),this.parseSerializedValue(e)}catch(e){}})}has(e){return __awaiter(this,void 0,void 0,function*(){try{return yield this.db.get(e),!0}catch(e){return!1}})}put(t,r){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){var e=this.serializeValue(r);return yield this.db.put(t,e),this.emit("put",t),r}))})}delete(e){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){yield this.db.del(e),this.emit("delete",e)}))})}deleteExpired(){var n,i,s;return __awaiter(this,void 0,void 0,function*(){try{for(var e,t=!0,r=__asyncValues(this.entries());e=yield r.next(),!(n=e.done);t=!0){e.value;t=!1}}catch(e){i={error:e}}finally{try{t||n||!(s=r.return)||(yield s.call(r))}finally{if(i)throw i.error}}return this})}deleteEverything(){return __awaiter(this,void 0,void 0,function*(){return yield this.orThrow(()=>__awaiter(this,void 0,void 0,function*(){yield this.db.clear(),this.emit("delete","All cache data was deleted.")}))})}entries(){return __asyncGenerator(this,arguments,function*entries_1(){var e,t,r,n;try{try{for(var i,s=!0,o=__asyncValues(this.db.iterator());!(e=(i=yield __await(o.next())).done);s=!0){n=i.value,s=!1;const[a,l]=n;this.isExpired(l)&&this.db.del(a).then(()=>this.emit("expired",a)),yield yield __await([a,this.parseSerializedValue(l)])}}catch(e){t={error:e}}finally{try{s||e||!(r=o.return)||(yield __await(r.call(o)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}keys(){return __asyncGenerator(this,arguments,function*keys_1(){var e,t,r;try{try{for(var n,i=!0,s=__asyncValues(this.entries());!(e=(n=yield __await(s.next())).done);i=!0){var o=n.value,i=!1,[a]=o;yield yield __await(a)}}catch(e){t={error:e}}finally{try{i||e||!(r=s.return)||(yield __await(r.call(s)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}values(){return __asyncGenerator(this,arguments,function*values_1(){var e,t,r;try{try{for(var n,i=!0,s=__asyncValues(this.entries());!(e=(n=yield __await(s.next())).done);i=!0){var o=n.value,i=!1,[,a]=o;yield yield __await(a)}}catch(e){t={error:e}}finally{try{i||e||!(r=s.return)||(yield __await(r.call(s)))}finally{if(t)throw t.error}}}catch(e){throw this.emit("error",e)}})}size(){var i,s,o;return __awaiter(this,void 0,void 0,function*(){let e=0;try{for(var t,r=!0,n=__asyncValues(this.entries());t=yield n.next(),!(i=t.done);r=!0){t.value;r=!1;e++}}catch(e){s={error:e}}finally{try{r||i||!(o=n.return)||(yield o.call(n))}finally{if(s)throw s.error}}return e})}ensureNotExpired(e,t){return __awaiter(this,void 0,void 0,function*(){if(this.isExpired(t))throw yield this.db.del(e),this.emit("expired",e),new Error("Expired")})}isExpired(e){return!!this.maxAgeMs&&Date.now()-this.parseSerializedTimestamp(e)>this.maxAgeMs}serializeValue(e){return Date.now()+JSON.stringify(e)}parseSerializedTimestamp(e){return parseInt(e.substring(0,13))}parseSerializedValue(e){return JSON.parse(e.substring(13))}orThrow(e){try{return e()}catch(e){throw this.emit("error",e)}}emit(e,t){return this.events.emit(e,t,this),t}logAllEvents(){e.logEmitterEvents(this.events,{debug:["options","put","get"],info:["expired","hit","miss"],warn:["delete"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}logWarnErrorEvents(){e.logEmitterEvents(this.events,{warn:["delete"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}}ApiReponseCache.optionsDefaults={name:"default",dirpath:b("ApiReponseCache"),maxAgeMs:0,logAllEvents:void 0};class AbstractApiClient{constructor(e={}){this.events=new s,this.retryDefaults={minTimeout:1e3,retries:5,factor:2.5,randomize:!0},this.cacheDefaults={overwrite:!1},null!=(t=null==(e=this.handleOptions(e))?void 0:e.cache)&&t.enable&&(this.cache=new ApiReponseCache(e.cache));var[t,e]=funAsyncRateLimit((o=>__awaiter(this,void 0,void 0,function*(){const{apiRequest:n,args:i,retry:e,cache:t}=o;var r=this.handleRetryOptions(e);const s=this.handleCacheOptions(t);r=yield l((e,r)=>__awaiter(this,void 0,void 0,function*(){try{return this.cache?(t=this.cache.hashKey({args:i,task:n.toString()}),null!==s&&void 0!==s&&s.overwrite&&(yield this.cache.delete(t)),yield this.cache.getOrElse(t,n)):yield n()}catch(e){var t={attempt:r,error:e,args:i};throw 1<r?this.emit("retry",t):this.emit("error",t),e}}),r);return this.emit("response",{response:r,args:i}),r})).bind(this),e.concurrency);this.queue=t,this.sendRequest=e,this.emit("ready",this)}handleOptions(e){e=u(e);var t=Object.getPrototypeOf(this).constructor;return e.cache||(e.cache={}),e.cache.name||(e.cache.name=t.name),void 0===e.cache.logAllEvents&&(e.cache.logAllEvents=e.logAllEvents),e.concurrency=Object.assign({},t.concurrencyDefaults,e.concurrency),e.logAllEvents?this.logAllEvents():void 0===e.logAllEvents&&this.logWarnErrorEvents(),Object.assign(this.retryDefaults,e.retryDefaults),Object.assign(this.cacheDefaults,e.cacheDefaults),this.emit("options",e),e}handleRetryOptions(e){return e?Object.assign({},this.retryDefaults,e):this.retryDefaults}handleCacheOptions(e){return e?Object.assign({},this.cacheDefaults,e):this.cacheDefaults}emit(e,t){return this.events.emit(e,t,this),t}logAllEvents(){return e.logEmitterEvents(this.events,{debug:["options","ready"],info:["response","retry"],warn:["concurrency"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name}),this}logWarnErrorEvents(){e.logEmitterEvents(this.events,{warn:["concurrency"],error:["error"],eventNamePrefix:Object.getPrototypeOf(this).constructor.name})}}AbstractApiClient.concurrencyDefaults={concurrency:100,autoStart:!0};const $=new Map([[401,"Invalid Authentication. Ensure the correct API key and requesting organization are being used."],[429,"Rate limit reached or hard limit quota reached. You can apply for a quota increase."],[500,"The server had an error. Retry your request after a brief wait and contact us if the issue persists. Check the status page."],[503,"The engine is currently overloaded, please try again later. Please retry your requests after a brief wait."]]);function assertInteger(e){if(Number.isInteger(e))return e;throw new TypeError("Expected int to be an integer. Got: "+e)}function randomIntBetween(e,t){return Math.floor(Math.random()*(assertInteger(t)-assertInteger(e)+1)+e)}function objOmitKeysMutable(e,...t){for(const r of t)Reflect.deleteProperty(e,r);return e}class OpenaiApiClient extends AbstractApiClient{constructor(e={}){super(e),this.apiDefaults={completionModel:"text-davinci-003",chat3_8Model:"gpt-3.5-turbo",chat3_16Model:"gpt-3.5-turbo-16k",chat4_8Model:"gpt-4",choicesDelimiter:"\n---------------\n"},this.concurrencyJustReduced=!1;e=e.apiKey||process.env.OPENAI_API_KEY;this.client=new x(new E({apiKey:e}))}completion(e){return __awaiter(this,void 0,void 0,function*(){return yield this._completion(...this.handleCompletionOptions(e))})}gpt3_8k(e){return __awaiter(this,void 0,void 0,function*(){return yield this._chat(...this.handleChatOptions(e))})}gpt3_16k(e){return __awaiter(this,void 0,void 0,function*(){return e.model=this.apiDefaults.chat3_16Model,yield this._chat(...this.handleChatOptions(e))})}gpt4_8k(e){return __awaiter(this,void 0,void 0,function*(){return e.model=this.apiDefaults.chat4_8Model,yield this._chat(...this.handleChatOptions(e))})}transcribe(e){return __awaiter(this,void 0,void 0,function*(){return yield this._transcribe(...this.handleTranscribeOptions(e))})}handleCompletionOptions(e){(e=this.deleteDefaultOrUndefinedOptions(e,{presence_penalty:0,frequency_penalty:0,best_of:1})).model||(e.model=this.apiDefaults.completionModel),e.instruction&&(e.prompt=e.instruction+"\n\n"+e.prompt),e.max_tokens||(t=this.countTokens(e.prompt),e.response_max_tokens?e.max_tokens=t+e.response_max_tokens:e.max_tokens=4096-t);var t=e=objOmitKeysMutable(e,"retry","cache","instruction","response_max_tokens"),r=this.handleRetryOptions(e.retry),e=this.handleCacheOptions(e.cache);return this.emit("request",[t,r,e])}handleChatOptions(e){e=this.deleteDefaultOrUndefinedOptions(e,{presence_penalty:0,frequency_penalty:0});var t=this.handleRetryOptions(e.retry),r=this.handleCacheOptions(e.cache),n=this.apiDefaults.chat3_8Model,i=[],n=(e.instruction&&i.push({role:"system",content:e.instruction}),e.prompt&&i.push({role:"user",content:e.prompt}),e.messages&&i.push(...e.messages),i.length||i.push({role:"user",content:""}),e=objOmitKeysMutable(e,"prompt","instruction","retry","cache"),Object.assign(Object.assign({model:n},e),{messages:i}));return this.emit("request",[n,t,r])}handleTranscribeOptions(e){var t=e.request,r=this.handleRetryOptions(e.retry),e=this.handleCacheOptions(e.cache);return this.emit("request",[t,r,e])}_completion(t,e,r){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){var e=(yield this.client.createCompletion(t))["data"];return this.assertReponseDataComplete(e),this.parseChoices(e.choices).join(this.apiDefaults.choicesDelimiter)}),args:[t],retry:e,cache:r})})}_chat(r,e,t){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){let e;try{var t=yield this.client.createChatCompletion(r);e=t.data}catch(e){this.handleApiError(e)}return this.assertReponseDataComplete(e),this.parseChoices(e.choices)[0]}),args:[r],retry:e,cache:t})})}_transcribe(t,e,r){return __awaiter(this,void 0,void 0,function*(){return yield this.sendRequest({apiRequest:()=>__awaiter(this,void 0,void 0,function*(){try{var e=(yield this.client.createTranscription(c.createReadStream(t.filepath),"whisper-1",void 0,t.format,void 0,t.language))["data"];return e.toString().trim()}catch(e){console.error(e.toJSON())}return""}),args:[t],retry:e,cache:r})})}handleApiError(e){var t=e.toJSON(),r=t.status,n=(429===r&&this.lowerConcurrency(),$.get(r));throw n&&(e=new Error("Error code "+r+": "+n)),this.emit("error",t),e}lowerConcurrency(e=7,t=6,r=9e4){this.concurrencyJustReduced||this.queue.concurrency<=20||(this.concurrencyJustReduced=!0,setTimeout(()=>{this.concurrencyJustReduced=!1},1e3),this.queue.concurrency-=e,this.emit("concurrency","Reducing concurrency to "+this.queue.concurrency+" to prevent rate limiting."),r=randomIntBetween(5e3,r),setTimeout(()=>{this.queue.concurrency+=t,this.emit("concurrency","Trying to raise concurrency again to "+this.queue.concurrency+".")},r))}parseChoices(e){return e.map(e=>Reflect.has(e,"text")?Reflect.get(e,"text").trim():Reflect.has(e,"message")?Reflect.get(e,"message").content.trim():void 0)}deleteDefaultOrUndefinedOptions(e,t={}){e=Object.assign({},e),t.temperature=1,t.top_p=1,t.n=1;for(var[r,n]of Object.entries(t))Reflect.get(e,r)===n&&Reflect.deleteProperty(e,r);for(var[i,s]of Object.entries(e))s||0===s||Reflect.deleteProperty(e,i);return e}assertReponseDataComplete(e){for(const t of e.choices)"stop"!==t.finish_reason&&this.emit("error","Expected finish_reason to be: stop. Got: "+t.finish_reason)}stringTokens(e){return _(e)}countTokens(e){return _(e).length}}class OpenaiApiClientExtended extends OpenaiApiClient{constructor(e={}){super(e)}proofread(e,t,r={}){return __awaiter(this,void 0,void 0,function*(){return r.instruction=(r.instruction?r.instruction+"\n\n":"")+`You will be provided with statements, and your task is to convert them to standard ${D(e)}.

`+"Respond with the corrected text and nothing else.",yield this.gpt3_8k(Object.assign(Object.assign({temperature:0},r),{prompt:t}))})}proofreadEnglish(e,t={}){return __awaiter(this,void 0,void 0,function*(){return yield this.proofread("English",e,t)})}translateFromTo(e,t,r,n={}){return __awaiter(this,void 0,void 0,function*(){return n.instruction=(n.instruction?n.instruction+"\n\n":"")+`Translate from ${D(e)} to ${D(t)}.`,yield this.gpt3_8k(Object.assign(Object.assign({temperature:.3},n),{prompt:r}))})}translateEnglishTo(e,t,r={}){return __awaiter(this,void 0,void 0,function*(){return yield this.translateFromTo("English",e,t,r)})}}function arrSum(e){return e.reduce((e,t)=>e+t,0)}function arrAverage(e){if(e.length)return arrSum(e)/e.length;throw new Error("Cannot take an average of zero values.")}function arrEachToString(e){return e.map(e=>""+e)}function arrEvery(r,n){for(let e=0,t=r.length;e<t;e++)if(!1===n(r[e],e,r))return!1;return!0}function arrFindIndicesOf(t,r){var n=[];for(let e=0;e<t.length;e++)r(t[e])&&n.push(e);return n}function arrFindLast(t,r){for(let e=t.length-1;0<=e;e--)if(!0===r(t[e]))return t[e]}function arrFindLastIndexOf(t,r){for(let e=t.length-1;0<=e;e--)if(r(t[e]))return e;return-1}function arrFlatten(e,n=Number.MAX_SAFE_INTEGER){const i=[];return function recurse(t,r){for(let e=0;e<t.length;e++)Array.isArray(t[e])&&r<n?recurse(t[e],r+1):i.push(t[e])}(e,0),i}function arrIndicesOf(t,r){var n=[];for(let e=0;e<t.length;e++)r===t[e]&&n.push(e);return n}function arrLast(e){if(e.length)return e[e.length-1];throw new Error("Cannot get last element of empty array.")}function arrMapMutable(t,r){for(let e=0;e<t.length;e++)t[e]=r(t[e],e,t);return t}function arrObjectsUniqueKeys(e){var t=new Set;for(const r of e)for(const n of Object.keys(r))t.add(n);return Array.from(t)}function arrObjectsToTable(e,t={}){var r,n=(null==(r=null==t?void 0:t.headers)?void 0:r.slice())||arrObjectsUniqueKeys(e),i=[n];for(const o of e){var s=n.map(e=>{e=o[e];return void 0!==e?e:t.emptyCell});i.push(s)}return i}function arrRemoveDuplicates(e){return Array.from(new Set(e))}function arrShallowEquals(e,r){return e.length===r.length&&arrEvery(e,(e,t)=>e===r[t])}function arrSwap(e,t,r){return t!==r&&([e[t],e[r]]=[e[r],e[t]]),e}function arrShuffle(t){if(!(t.length<=1)){var r=t.slice();let e=!0;for(;e;){for(let e=0;e<t.length;e++){var n=randomIntBetween(0,t.length-1);arrSwap(t,e,n)}e=arrShallowEquals(t,r)}}return t}function arrSome(r,n){for(let e=0,t=r.length;e<t;e++)if(!0===n(r[e],e,r))return!0;return!1}function compareNumeric(e,t){return e<t?-1:t<e?1:0}function arrSortNumeric(e){return e.sort(compareNumeric)}function arrTableAssertRowsSameLength(e,t){var r=(t||e[0]).length;for(const n of e)if(n.length!==r)throw new Error(`Expected ${r} columns, got `+n.length)}function arrTableEachToString(e){return e.map(arrEachToString)}function regexEscapeString(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function strReplaceAll(e,t,r,n="g"){return e&&t?e.replace(new RegExp(regexEscapeString(t),n),r):e}function arrTableToCsv(e,t=";",r="|"){return e.map(e=>e.map(e=>strReplaceAll(e+"",t,"").replace(/\r*\n/g,r)).join(t)).join("\n")}function createObjectFactory(i,s){const e=i.length;if(s&&s.length>e)throw new Error("defaultValues length larger than keys length.");return function factory(r){if(r&&r.length>e)throw new Error("values length larger than keys length.");var n={};for(let t=0;t<e;t++){let e;r?void 0===(e=r[t])&&s&&(e=s[t]):s&&(e=s[t]),Object.defineProperty(n,i[t],{enumerable:!0,writable:!0,configurable:!0,value:e})}return n}}function arrTableToObjects(e,t){if(t){if(!e.length)return[]}else{if(e.length<=1)return[];t=e[0].map(e=>null==e?"":String(e)),e=e.slice(1)}const r=createObjectFactory(t);return e.map(e=>r(e))}function asyncTasksLimit(o,a,l){return __awaiter(this,void 0,void 0,function*(){const t=new Set,r=[];let e=0;for(const n of a){const i=e++,s=(t.size===o&&(yield Promise.race(t)),n());t.add(s),s.then(e=>{r[i]=e,l&&l(e,i),t.delete(s)})}return yield Promise.all(t),r})}function asyncTasksParallel(e){return __awaiter(this,void 0,void 0,function*(){return yield Promise.all(e.map(e=>e()))})}function asyncTasksSerial(r){return __awaiter(this,void 0,void 0,function*(){var e=[];for(const t of r)e.push(yield t());return e})}function asyncWithTimeout(e,n){return new Promise((t,r)=>{setTimeout(()=>{r(new Error(`Timed out after ${e} ms.`))},e),n().then(e=>{t(e)},e=>{r(e)})})}function assertPositiveInteger(e){if(Number.isInteger(e)&&0<=e)return e;throw new TypeError("Expected a positive integer. Got: "+e)}function wait(t=0){return new Promise(e=>{assertPositiveInteger(t),setTimeout(e,t)})}function waitSeconds(t=0){return new Promise(e=>{if(t<0)throw new Error("secs must be a positive number");setTimeout(e,Math.floor(1e3*t))})}function atob(e){return Buffer.from(e,"base64")}function btoa(e){return e.toString("base64")}function bytesToInt(i){return 1===i.length&&i[0]<251?i[0]:2===i.length&&251===i[0]?251+i[1]:3===i.length&&252===i[0]?251+256*i[1]+i[2]:4===i.length&&253===i[0]?251+65536*i[1]+256*i[2]+i[3]:5===i.length&&254===i[0]?251+16777216*i[1]+65536*i[2]+256*i[3]+i[4]:(5<i.length&&255===i[0]?()=>{let t=0,r=1;var n=Math.max(2,i.length-6);for(let e=i.length-1;e>=n;e--)t+=r*i[e],r*=256;var e=i[1]+32<251?bytesToInt([i[1]+32])-11:255===i[0]&&i[1]<251?i[1]+21:3===n?bytesToInt([i[1],i[2]+21]):4===n?bytesToInt([i[1],i[2],i[3]+21]):0,e=251+t/Math.pow(2,32-e);if(!Number.isInteger(e))throw new Error(`Invalid bytes. Got [${i.join(", ")}] = `+e);if(1099511627776<e)throw new Error(`Bytes must correspond to an integer less than or equal to 256^5. Got [${i.join(", ")}] = `+e);return e}:()=>{throw new Error(`Invalid first byte. Got length: ${i.length}, and bytes: [${i.join(", ")}]`)})()}function intToArrayBytes(e){var t;return e<256?[e]:(t=new Uint8Array(new Uint32Array([e]).buffer),e<65536?[t[0],t[1]]:e<16777216?[t[0],t[1],t[2]]:e<4294967296?[t[0],t[1],t[2],t[3]]:[256,256,256,256])}function intToBuffer(e){return Buffer.from(intToArrayBytes(e))}function intToBytes(e){if(!Number.isInteger(e)||e<0)throw new Error("input must be a positive integer. Got "+e);if(1099511627776<e)throw new Error("input must be less than or equal to 256^5. Got "+e);const t=e-251;{if(e<251)return[e];if(t<256)return[251,t];if(t<65536)return[252,Math.floor(t/256),t%256];if(t<16777216)return[253,Math.floor(t/65536),Math.floor(t/256)%256,t%256];if(t<4294967296)return[254,Math.floor(t/16777216),Math.floor(t/65536)%256,Math.floor(t/256)%256,t%256];var e,r=[255,...intToBytes(e=Math.floor(Math.log(t)/Math.log(2))-32)],n=Math.floor(t/Math.pow(2,e-11));for(let e=5,t=1099511627776;0<=e;e--,t/=256)r.push(Math.floor(n/t)%256);return r}}function padArrayBytesLeft(e){var t;return e.length?4===(t=e.length)?e:1===t?[0,0,0,e[0]]:2===t?[0,0,e[0],e[1]]:[0,e[0],e[1],e[2]]:[0,0,0,0]}function padArrayBytesRight(e){var t;return e.length?4===(t=e.length)?e:1===t?[e[0],0,0,0]:2===t?[e[0],e[1],0,0]:[e[0],e[1],e[2],0]:[0,0,0,0]}function trimArrayBytesLeft(e){return 0===e[0]?0===e[1]?0===e[2]?[e[3]]:[e[2],e[3]]:[e[1],e[2],e[3]]:e}function trimArrayBytesRight(e){return 0===e[3]?0===e[2]?0===e[1]?[e[0]]:[e[0],e[1]]:[e[0],e[1],e[2]]:e}class Matrix{static fromArray(r){var n=r[0].length,i=new this(r.length,n);for(let t=0;t<r.length;t++){if(r[t].length!==n)throw new Error("All rows must have the same length.");for(let e=0;e<n;e++)i.matrix[t][e]=r[t][e]}return i}static fromIterable(e){var t=[];for(const r of e)t.push([...r]);return this.fromArray(t)}static identity(t){var r=new Matrix(t,t);for(let e=0;e<t;e++)r.matrix[e][e]=1;return r}constructor(t,r){if(this.immutable=!1,t<1)throw new Error("Expected rows to be greater than zero.");if(r<1)throw new Error("Expected cols to be greater than zero.");this.matrix=new Array(t);for(let e=0;e<t;e++)this.matrix[e]=new Array(r).fill(0)}get rows(){return this.matrix.length}get cols(){return this.matrix[0].length}isSameInstanceAs(e){return this===e}getImmutable(){return this.immutable}setImmutable(e){return this.immutable=e,this}deepEquals(e){var r=e instanceof Matrix?e.matrix:e;for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(this.matrix[t][e]!==r[t][e])return!1;return!0}set(e,t,r){var n=this.immutable?this.clone():this;return n.matrix[e][t]=r,n}get(e,t){return this.matrix[e][t]}has(e,t){return e<this.rows&&t<this.cols&&0<=e&&0<=t}toArray(){var t=new Array(this.rows);for(let e=0;e<this.rows;e++)t[e]=this.matrix[e].slice();return t}clone(){var r=new Matrix(this.rows,this.cols);for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)r.matrix[t][e]=this.matrix[t][e];return r}forEach(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(!1===r(this.matrix[t][e],t,e))return this;return this}forEachInRow(t,r){for(let e=0;e<this.cols;e++)if(!1===r(this.matrix[t][e],e))return this;return this}forEachInCol(t,r){for(let e=0;e<this.rows;e++)if(!1===r(this.matrix[e][t],e))return this;return this}forEachInDiagonal(t){for(let e=0;e<Math.min(this.rows,this.cols);e++)if(!1===t(this.matrix[e][e],e,e))return this;return this}map(r){var n=this.immutable?this.clone():this;for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)n.matrix[t][e]=r(this.matrix[t][e],t,e);return n}*[Symbol.iterator](){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)yield this.matrix[t][e]}*values(){yield*this}mapRow(t,r){var n=this.immutable?this.clone():this;for(let e=0;e<this.cols;e++)n.matrix[t][e]=r(this.matrix[t][e],e);return n}mapCol(t,r){var n=this.immutable?this.clone():this;for(let e=0;e<this.rows;e++)n.matrix[e][t]=r(this.matrix[e][t],e);return n}appendRow(e){var t=this.immutable?this.clone():this;if(e){if(e.length!==this.cols)throw new Error("Row must have length "+this.cols)}else e=new Array(this.cols).fill(0);return t.matrix.push(e),t}appendCol(t){var r=this.immutable?this.clone():this;if(t){if(t.length!==this.rows)throw new Error("Col must have length "+this.rows)}else t=new Array(this.rows).fill(0);for(let e=0;e<this.rows;e++)r.matrix[e].push(t[e]);return r}addBy(t){return(this.immutable?this.clone():this).map(e=>e+t)}subtractBy(t){return(this.immutable?this.clone():this).map(e=>e-t)}multiplyBy(t){return(this.immutable?this.clone():this).map(e=>e*t)}divideBy(t){return(this.immutable?this.clone():this).map(e=>e/t)}addRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e+t)}subtractRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e-t)}multiplyRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e*t)}divideRowBy(e,t){return(this.immutable?this.clone():this).mapRow(e,e=>e/t)}addColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e+t)}subtractColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e-t)}multiplyColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e*t)}divideColBy(e,t){return(this.immutable?this.clone():this).mapCol(e,e=>e/t)}swapRows(e,t){var r=this.immutable?this.clone():this,n=r.matrix[e],i=r.matrix[t];return r.matrix[e]=i,r.matrix[t]=n,r}swapCols(t,r){var n=this.immutable?this.clone():this;for(let e=0;e<this.rows;e++){var i=n.matrix[e][t],s=n.matrix[e][r];n.matrix[e][t]=s,n.matrix[e][r]=i}return n}some(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(r(this.matrix[t][e],t,e))return!0;return!1}every(r){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)if(!r(this.matrix[t][e],t,e))return!1;return!0}hasDimensions(e,t){return this.rows===e&&this.cols===t}isSquareMatrix(){return this.rows===this.cols}isScalarMatrix(){if(!this.isSquareMatrix())return!1;var t=this.matrix[0][0];for(let e=1;e<this.rows;e++)if(this.matrix[e][e]!==t)return!1;return!0}isZeroMatrix(){return this.every(e=>0===e)}dotProduct(n){if(this.cols!==n.rows)throw new Error("A*B dot product not possible unless the number of columns in A and number of rows in B are the same.");var e=this.rows,i=n.cols,s=this.cols,o=new Matrix(e,i);for(let r=0;r<e;r++)for(let t=0;t<i;t++)for(let e=0;e<s;e++)o.matrix[r][t]+=this.matrix[r][e]*n.matrix[e][t];return o}}class MixinBase{getConstructor(){return Object.getPrototypeOf(this).constructor}getPrototype(){return Object.getPrototypeOf(this)}setNonEnumerableProperties(...e){setNonEnumerable(this,...e)}}class Queue extends MixinBase{constructor(){super(...arguments),this.queue=[]}static from(e){var t=new Queue;return t.queue=[...e],t}static fromJSON(e){return Queue.from(JSON.parse(e))}enqueue(e){return this.queue.push(e),this}dequeue(){var e=this.queue.shift();if(e)return e;throw new Error("Queue is empty")}get size(){return this.queue.length}toArray(){return this.queue.slice()}toJSON(){return this.queue}*[Symbol.iterator](){yield*this.queue}}class SimpleTable extends MixinBase{static fromJSON(e){var{headers:e,data:t}=JSON.parse(e);return new SimpleTable(t,e)}constructor(e,t){if(super(),this._colIndexMap={},this._data=[],t?(this._headers=t.slice(),this._data=e.map(e=>(this.assertRowValidLength(e),e.slice()))):(this._headers=e[0].map(e=>""+e),this._data=e.slice(1).map(e=>(this.assertRowValidLength(e),e.slice()))),!this._headers.length)throw new Error("Table must have at least one column.");if(!this._data.length)throw new Error("Table must have at least one row.");this._headers.forEach((e,t)=>{this._colIndexMap[e]=t})}assertRowValidLength(e){if(e.length!==this._headers.length)throw new Error("Row length does not match headers length.")}get numColumns(){return this._data[0].length}get numRows(){return this._data.length}get headers(){return this._headers.slice()}get data(){return this._data.slice().map(e=>e.slice())}get(e,t){return"string"==typeof e&&(e=this._colIndexMap[e]),this._data[t][e]}set(e,t,r){return"string"==typeof e&&(e=this._colIndexMap[e]),this._data[t][e]=r,this}toArray(){return[this.headers].concat(this.data)}toJSON(){return{headers:this._headers,data:this._data}}}function compareNumber(e,t){return e-t}function compareString(e,t){return e.localeCompare(t)}class SortedArray extends Array{constructor(e={}){if(super(),this.compare=compareString,this.allowDuplicates=!0,setNonEnumerable(this,"compare","allowDuplicates"),e.compare&&(this.compare=e.compare),!1===e.allowDuplicates&&(this.allowDuplicates=!1),e.data){for(const t of this.allowDuplicates?e.data:new Set(e.data))super.push(t);e.compare||"number"!=typeof this[0]||(this.compare=compareNumber),this.sort(this.compare)}}toArray(){return Array.from(this)}add(e){var t,r;return 0===this.length?super.push(e):([t,r]=this.insertionIndex(e),r&&!this.allowDuplicates||super.splice(t,0,e)),this}addMany(...e){if(0!==e.length)for(const t of e)this.add(t);return this}unique(){let n=this.length;if(!(n<=1))for(let e,t,r=1;r<n;r++)e=this[r-1],t=this[r],0===this.compare(e,t)&&(super.splice(r,1),n--,r--);return this}insertionIndex(e){if(0===this.length)return[0,!1];let t=0,r=this.length;for(;t<r;){var n=t+r>>>1,i=this.compare(this[n],e);if(0===i)return[n,!0];i<0?t=1+n:r=n}return[t,!1]}firstInsertionIndex(e){var[t,r]=this.insertionIndex(e);if(!r)return[t,r];let n=t-1;for(;0<=n;){if(0!==this.compare(this[n],e))return[n+1,r];n--}return[0,r]}lastInsertionIndex(e){var[t,r]=this.insertionIndex(e);if(!r)return[t,r];let n=t+1;for(;n<this.length;){if(0!==this.compare(this[n],e))return[n,r];n++}return[this.length,r]}indexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.insertionIndex(e),t?e:-1)}firstIndexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.firstInsertionIndex(e),t?e:-1)}lastIndexOfCompare(e){var t;return 0===this.length?-1:1===this.length?0===this.compare(this[0],e)?0:-1:([e,t]=this.lastInsertionIndex(e),t?e-1:-1)}indicesOfCompare(t){var r=this.indexOfCompare(t);if(-1===r)return[];var n=[];if(this.allowDuplicates){let e=r-1;for(;0<=e&&0===this.compare(this[e],t);)n.push(e),e--;for(n.push(r),e=r+1;e<this.length&&0===this.compare(this[e],t);)n.push(e),e++;n.sort(compareNumber)}return n}intersection(e){var t=[];let r=0,n=0;for(;r<this.length&&n<e.length;)this.compare(this[r],e[n])<0?r++:(0===this.compare(this[r],e[n])&&(t.push(this[r]),r++),n++);return t}push(...e){return this.addMany(...e),this.length}reverse(){throw new Error("Cannot reverse a SortedArray since it would then no longer be sorted.")}splice(e,t){return super.splice(e,t)}}function isValidDate(e,t,r,n,i,s,o){e=e?Number(e):0,t=t?Number(t):0,r=r?Number(r):0,n=n?Number(n):0,i=i?Number(i):0,s=s?Number(s):0,o=o?Number(o):0;var a=new Date(e,t-1,r,n,i,s,o);return a.getFullYear()===e&&a.getMonth()+1===t&&a.getDate()===r&&a.getHours()===n&&a.getMinutes()===i&&a.getSeconds()===s&&a.getMilliseconds()===o}function assertValidDate(e,t,r,n,i,s,o){if(!isValidDate(e,t,r,n,i,s,o))throw new Error(`Expected valid date. Got: ${JSON.stringify({year:e,month:t,day:r,hour:n,minute:i,second:s,millisecond:o})}.`)}function isValidDateMonth(e){return Number.isInteger(e)&&1<=e&&e<=12}function assertValidDateMonth(e){if(!isValidDateMonth(e))throw new Error(`Invalid month: ${e}.`)}function isValidDateYear(e){return Number.isInteger(e)&&0<=e}function assertValidDateYear(e){if(!isValidDateYear(e))throw new Error(`Invalid year: ${e}.`)}function isLeapYear(e){return assertValidDateYear(e),0==e%4&&0!=e%100||0==e%400}function numDaysInMonth(e,t){assertValidDateMonth(e);return 2===e&&void 0!==t&&isLeapYear(t)?29:[0,31,28,31,30,31,30,31,31,30,31,30,31][e]}function isValidDateDay(e,t,r){return!!Number.isInteger(e)&&!!Number.isInteger(t)&&!(r&&!Number.isInteger(r)||e<1||e>numDaysInMonth(t,r))}function assertValidDateDay(e,t,r){if(!isValidDateDay(e,t,r))throw new Error(`Invalid day of the month: ${e}.`)}const B=36e5,U=6e4,q=2628e6,z=1e3,W=6048e5,H=31536e6;function dateDaysAgo(e){var t=new Date;return t.setDate(t.getDate()-e),t}function dateWeekDayName(e){return G[e.getDay()]}const G=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function msSinceDate(e){return Date.now()-e.getTime()}function daysSinceDate(e){return msSinceDate(e)/V}function getCentury(e){return assertValidDateYear(e),Math.floor(e/100)+1}function getCurrentYear(){return(new Date).getUTCFullYear()}function hoursSinceDate(e){return msSinceDate(e)/36e5}function isoDateTimestamp(e=new Date){return e.toISOString().replace(/\D/g,"")}function minutesSinceDate(e){return msSinceDate(e)/6e4}function monthsSinceDate(e){return msSinceDate(e)/q}function prettyIsoDateString(e,t=" ",r="millisecond"){return e.substring(0,Z[r]).replace(/T/,t).replace(/-|:/g,".")}const Z={year:4,month:7,day:10,hour:13,minute:16,second:19,millisecond:23};function secondsSinceDate(e){return msSinceDate(e)/1e3}function weeksSinceDate(e){return msSinceDate(e)/W}function yearsSinceDate(e){return msSinceDate(e)/H}function absoluteToRelativePath(e,t=process.cwd()){return h.normalize(e).replace(new RegExp(regexEscapeString(h.normalize(t)+h.sep),"i"),"")}function normalizeFileExtension(e){if(""===e||"."===e)return"";if(/[<>"|?*:]/g.test(e))throw new Error(`Illegal characters in file extension: ${e}  |  Illegal characters are: <>"|?:*`);return e.includes(".")?e.substring(e.lastIndexOf(".")):"."+e}function createFileExtensionFilter(...r){return r.length?e=>{for(const t of r.map(normalizeFileExtension))if(h.extname(e)===t)return!0;return!1}:()=>!0}function cwdpath(...e){return h.join(process.cwd(),...e)}function deleteDirectory(e){return __awaiter(this,void 0,void 0,function*(){yield c.promises.rm(e,{recursive:!0,force:!0})})}function deleteDirectorySafe(e){return __awaiter(this,void 0,void 0,function*(){c.existsSync(e)&&(yield c.promises.rm(e,{recursive:!0,force:!0}))})}function deleteDirectorySafeSync(e){return c.existsSync(e)&&c.rmSync(e,{recursive:!0,force:!0}),e}function deleteDirectorySync(e){return c.rmSync(e,{recursive:!0,force:!0}),e}function ensureValidWindowsPath(t,r){var e=e=>{if(r&&!0===r.assert)throw new Error(`Invalid windows path. ${e}  |  input received: `+t);return!1};if(0===t.length)return e("Path string is length 0.");if(-1!==t.indexOf("/")&&-1!==t.indexOf("\\"))return e("Path contains both backslash and forward slash.");var n=(r&&r.extendedMaxLength?32767:260)-12;if(t.length>n)return e(`Maximum length of ${n} exceeded`);let i=t;return/^\w:(\\|\/)/g.test(t)&&(i=t.substring(2)),/[<>"|?*:]/g.test(i)?e(`Illegal characters in: ${t}  |  Illegal characters are: <>"|?:*`):!/(\\|\/)(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])((\\|\/)|$)/g.test(t)||e("Illegal name in path string")}class AbstractFsPath extends String{constructor(e,t=!1){if(t)super(e);else{if(!(e="string"!=typeof e?h.join(...e):e)||!h.isAbsolute(e))throw new Error("Expected absolute filepath. Got: "+e);super(h.normalize(e))}}get absolute(){return super.toString()}get relative(){return absoluteToRelativePath(this.absolute)}get root(){return h.parse(this.absolute).root}get base(){return h.basename(this.absolute)}get name(){return h.parse(this.absolute).name}get parentPath(){return h.dirname(this.absolute)}get exists(){return c.existsSync(this.absolute)}statSync(){return c.statSync(this.absolute)}stat(){return __awaiter(this,void 0,void 0,function*(){return c.promises.stat(this.absolute)})}isValidWindowsPath(e=!1){return ensureValidWindowsPath(this.absolute,{extendedMaxLength:e})}toArray(){return this.absolute.split(h.sep)}relativeToArray(){return this.relative.split(h.sep)}get isDirectoryPath(){return!1}get isFilePath(){return!1}get isBlockDevicePath(){return!1}get isSymbolicLinkPath(){return!1}get isCharacterDevicePath(){return!1}get isFIFOPath(){return!1}get isSocketPath(){return!1}isDirectory(e=this.statSync()){return e.isDirectory()}isFile(e=this.statSync()){return e.isFile()}isBlockDevice(e=this.statSync()){return e.isBlockDevice()}isSymbolicLink(e=this.statSync()){return e.isSymbolicLink()}isCharacterDevice(e=this.statSync()){return e.isCharacterDevice()}isFIFO(e=this.statSync()){return e.isFIFO()}isSocket(e=this.statSync()){return e.isSocket()}}class FilePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isFilePath(){return!0}get parent(){return new DirectoryPath(this.parentPath,!0)}get filepath(){return this.absolute}get filename(){return h.basename(this.filepath)}get extension(){return h.extname(this.filepath)}readFileSync(e){return c.readFileSync(this.filepath,e)}readFile(e){return __awaiter(this,void 0,void 0,function*(){return c.promises.readFile(this.filepath,e)})}readFileStringSync(e="utf8"){return c.readFileSync(this.filepath,e)}readFileString(e="utf8"){return __awaiter(this,void 0,void 0,function*(){return c.promises.readFile(this.filepath,e)})}writeFileSync(e,t="utf8"){createDirectorySync(this.parentPath),c.writeFileSync(this.filepath,e,t)}writeFile(e,t="utf8"){return __awaiter(this,void 0,void 0,function*(){createDirectory(this.parentPath),yield c.promises.writeFile(this.filepath,e,t)})}}class BlockDevicePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isBlockDevicePath(){return!0}}class CharacterDevicePath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isCharacterDevicePath(){return!0}}class FIFOPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isFIFOPath(){return!0}}class SocketPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isSocketPath(){return!0}}class SymbolicLinkPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get isSymbolicLinkPath(){return!0}}function instantiateCorrectFsPathSubclass(e,t){return new(t.isFile()?FilePath:t.isDirectory()?DirectoryPath:t.isSymbolicLink()?SymbolicLinkPath:t.isBlockDevice()?BlockDevicePath:t.isCharacterDevice()?CharacterDevicePath:t.isFIFO()?FIFOPath:SocketPath)(e,!0)}class DirectoryPath extends AbstractFsPath{constructor(e,t=!1){super(e,t)}get dirpath(){return this.absolute}get isDirectoryPath(){return!0}get parent(){return new DirectoryPath(this.parentPath)}subdir(...e){return new DirectoryPath(h.join(this.dirpath,...e),!0)}file(e){return new FilePath(h.join(this.dirpath,e),!0)}readdirSync(){return c.readdirSync(this.dirpath).map(e=>{e=h.join(this.dirpath,e);return instantiateCorrectFsPathSubclass(e,c.statSync(e))})}readdir(){return __awaiter(this,void 0,void 0,function*(){return yield Promise.all((yield c.promises.readdir(this.dirpath)).map(t=>__awaiter(this,void 0,void 0,function*(){var e=h.join(this.dirpath,t);return instantiateCorrectFsPathSubclass(e,yield c.promises.stat(e))})))})}}function getLastMofifiedFileIn(t,r){return __awaiter(this,void 0,void 0,function*(){var e=(yield new DirectoryPath(t).readdir()).filter(e=>e.isFilePath&&r(e));return(yield Promise.all(e.map(e=>__awaiter(this,void 0,void 0,function*(){return[e,(yield e.stat()).mtimeMs]})))).sort((e,t)=>t[1]-e[1])[0][0]})}function readExcelFile(r){return __awaiter(this,void 0,void 0,function*(){var e=new I.Workbook;yield e.xlsx.readFile(r);const t={};return e.eachSheet(e=>{const r=[];e.eachRow(e=>{const t=[];e.eachCell(e=>{t.push(String(e.value).trim())}),r.push(t)}),t[e.name]=r}),t})}function readJsonFile(e){return __awaiter(this,void 0,void 0,function*(){return JSON.parse(yield c.promises.readFile(e,"utf8"))})}function readJsonFileSync(e){return JSON.parse(c.readFileSync(e,"utf8"))}function removeIllegalFilenameCharacters(e){return e.replace(/[/\\?%*:|"<>]/g,"")}function unzipFile(e,t){return __awaiter(this,void 0,void 0,function*(){yield C(e,{dir:t})})}function unzipMergeFiles(t,r){return __awaiter(this,void 0,void 0,function*(){for(const e of t="string"==typeof t?c.readdirSync(t).map(e=>h.join(t,e)):t)(yield c.promises.stat(e)).isDirectory()||e.endsWith(".zip")&&(yield C(e,{dir:r}))})}function convertFilter(r){return(t,e)=>e.filter(e=>{e=h.join(t,e);return r(e,c.statSync(e))})}function findFile(s,t,o={}){return __awaiter(this,void 0,void 0,function*(){t=t.replace(/\\|\//g,h.sep);const i=new RegExp(regexEscapeString(t),"i"),e=o.filter?convertFilter(o.filter):void 0;return yield new Promise((t,r)=>{const n=a(s,Object.assign(Object.assign({},o),{no_return:!0,filter:e}));n.on("file",e=>{i.test(e)&&(n.end(),t(e))}),n.on("end",()=>t(void 0)),n.on("error",e=>r(e))})})}function walkDirectory(r,n={},i){return __awaiter(this,void 0,void 0,function*(){var e=!!i,t=n.filter?convertFilter(n.filter):void 0;return yield a.async(r,Object.assign(Object.assign({},n),{no_return:e,return_object:!1,filter:t}),i)})}function walkDirectoryEmitter(e,t={}){var r=t.filter?convertFilter(t.filter):void 0;return a(e,Object.assign(Object.assign({},t),{no_return:!0,filter:r}))}function walkDirectorySync(e,t={},r){var n=!!r,i=t.filter?convertFilter(t.filter):void 0;return a.sync(e,Object.assign(Object.assign({},t),{no_return:n,return_object:!1,filter:i}),r)}function wipeDirectorySafe(e){return __awaiter(this,void 0,void 0,function*(){yield deleteDirectorySafe(e),yield createDirectory(e)})}function writeExcelFile(n,i){return __awaiter(this,void 0,void 0,function*(){var e,t,r=new I.Workbook;for([e,t]of Object.entries(i))r.addWorksheet(e).addRows(t);yield r.xlsx.writeFile(n)})}function toJson(e,t=!1){return t?JSON.stringify(e,null,2):JSON.stringify(e)}function writeJsonFile(e,t,r=!1){return __awaiter(this,void 0,void 0,function*(){yield c.promises.writeFile(e,toJson(t,r))})}function writeJsonFileSync(e,t,r=!1){c.writeFileSync(e,toJson(t,r))}class ExtensibleFunction extends Function{constructor(e,t){return Object.defineProperty(t,"name",{value:e}),super("string"==typeof t?t:t.toString()),Object.setPrototypeOf(t,new.target.prototype)}}function funAsyncAutoRateLimit(n,e){let i=!1;const[s,o]=funAsyncRateLimit(function(...r){return __awaiter(this,void 0,void 0,function*(){try{return yield e.call(s,...r)}catch(e){if(!i){i=!0,s.concurrency=Math.max(1,Math.floor(s.concurrency/10)),yield wait(250),i=!1;var t=9*s.concurrency;if((s.concurrency=t)<n/10)throw new Error("funAsyncAutoRateLimit: concurrency is below 10% of the original value.")}return yield o(...r)}})},{concurrency:n});return funSetName(o.name,o)}function funParseClass(e){var e=null==(e=A(e.toString(),{tolerant:!0}).body)?void 0:e[0],t=null==(t=Reflect.get(e,"id"))?void 0:t.name;if("ClassDeclaration"!==e.type)throw new Error("Expected Class source code.");if(!e.body.body)throw new Error("Expected Class body.");const n=[];e=null==(e=e.body)?void 0:e.body.filter(e=>"MethodDefinition"===e.type).map(e=>{var t=e.kind,r=("constructor"===t&&null!=(r=null==(r=null==(r=e.value)?void 0:r.body)?void 0:r.body)&&r.forEach(e=>{"ExpressionStatement"===e.type&&"AssignmentExpression"===e.expression.type&&"MemberExpression"===e.expression.left.type&&"ThisExpression"===e.expression.left.object.type&&n.push(e.expression.left.property.name)}),null==(r=null==e?void 0:e.key)?void 0:r.name);return{kind:t,name:r,params:(null==(r=null==(t=null==e?void 0:e.value)?void 0:t.params)?void 0:r.map(e=>null==e?void 0:e.name))||[]}});return{name:t,properties:n,methods:e}}function funParseFunction(e){var t,e=null==(e=A(e.toString(),{tolerant:!0}).body)?void 0:e[0];let r="",n=[];return"FunctionDeclaration"===(null==e?void 0:e.type)?(r=(null==(t=null==e?void 0:e.id)?void 0:t.name)||"",n=(null==(t=null==e?void 0:e.params)?void 0:t.map(e=>null==e?void 0:e.name))||[]):"ExpressionStatement"===(null==e?void 0:e.type)&&"ArrowFunctionExpression"===(null==e?void 0:e.expression.type)&&(n=(null==(e=null==(t=null==e?void 0:e.expression)?void 0:t.params)?void 0:e.map(e=>null==e?void 0:e.name))||[]),{name:r,params:n}}const J=new Set(["async","autocomplete","autofocus","autoplay","border","challenge","checked","compact","contenteditable","controls","default","defer","disabled","formNoValidate","frameborder","hidden","indeterminate","ismap","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","readonly","required","reversed","scoped","scrolling","seamless","selected","sortable","spellcheck","translate"]);var t=new Set(["onabort","onautocomplete","onautocompleteerror","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onmousewheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onseeked","onseeking","onselect","onshow","onsort","onstalled","onsubmit","onsuspend","ontimeupdate","ontoggle","onvolumechange","onwaiting"]),K=new Set(["accesskey","autocapitalize","class","contenteditable","contextmenu","dir","draggable","dropzone","hidden","id","itemprop","lang","slot","spellcheck","style","tabindex","title"]);const Y=new Set([...K,...t,...J,"charset","coords","datafld","datasrc","download","href","hreflang","methods","name","ping","referrerpolicy","rel","shape","target","type","urn","alt","crossorigin","preload","alink","background","bgcolor","link","marginbottom","marginheight","marginleft","marginright","margintop","marginwidth","text","vlink","clear","dataformatas","formaction","formenctype","formmethod","formnovalidate","formtarget","align","char","charoff","span","valign","width","src","action","accept","method","profile","color","size","version","allowtransparency","hspace","vspace","decoding","lowsrc","srcset","capture","inputmode","usemap","as","blocking","integrity","display","overflow","content","http-equiv","scheme","archive","classid","code","codebase","codetype","data","declare","standby","valuetype","event","for","language","nomodule","bordercolor","cellpadding","cellspacing","datapagesize","frame","rules","summary","axis","colspan","height","rowspan","scope","cols","maxlength","minlength","rows","wrap","allow","buffered","cite","csp","datetime","dirname","enctype","enterkeyhint","form","headers","high","icon","importance","intrinsicsize","keytype","kind","label","loading","list","low","manifest","max","media","min","optimum","pattern","placeholder","poster","radiogroup","sandbox","sizes","srcdoc","srclang","start","step","value"]),Q=new Set(["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),X=new Set([...Q,"a","area","audio","button","col","colgroup","details","dialog","embed","fieldset","form","html","iframe","img","input","link","map","math","meta","object","ol","optgroup","option","script","select","td","textarea","th","video","abbr","acronym","address","applet","article","aside","b","basefont","bdi","bdo","bgsound","big","blink","blockquote","body","canvas","caption","center","cite","code","data","datalist","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","i","ins","isindex","kbd","label","legend","li","listing","main","mark","marquee","menu","meter","multicol","nav","nextid","nobr","noembed","noframes","noscript","output","p","picture","plaintext","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","section","slot","small","spacer","span","strike","strong","style","sub","summary","sup","svg","svg:desc","svg:title","table","tbody","template","tfoot","thead","time","title","tr","tt","u","ul","var","xmp"]);class _HtmlAttribute{constructor(e,t){this.name=e,this.value=t}get isBoolean(){return J.has(this.name)}toString(){return""+this.name+(this.isBoolean?"":`="${this.value||""}"`)}}class _HtmlElement{constructor(e,...t){this.tag=e,this.attributes=new Map,this.children=[];for(const r of t.flat())r instanceof _HtmlAttribute?this.attributes.set(r.name,r):"string"==typeof r&&"script"!==e&&"style"!==e?this.children.push(r.replace(/\r*\n/g,"<br />")):this.children.push(r);if(this.children.length&&this.isVoid)throw new Error("Void elements cannot have children.")}get isVoid(){return Q.has(this.tag)}toHtmlElement(){var e,t=document.createElement(this.tag);for(const r of this.attributes.values())t.setAttribute(r.name,(null==(e=r.value)?void 0:e.toString())||"");for(const n of this.children)"string"==typeof n?t.appendChild(document.createTextNode(n)):t.appendChild(n.toHtmlElement());return t}toString(){return"<"+this.tag+(this.attributes.size?" "+Array.from(this.attributes.values()).join(" "):"")+(this.isVoid?" />":`>${this.children.join("")}</${this.tag}>`)}}const n=(()=>{var e={};for(const t of Y)e[t]=e=>new _HtmlAttribute(t,e);return e})(),r=e=>"\x3c!-- "+e+" --\x3e",i=(()=>{var e={};for(const t of X)e[t]=(...e)=>new _HtmlElement(t,...e);return e.html=(...e)=>new _HtmlDocument("html",...e),e})();var ee=(e,t=!0)=>{var r=i.thead();return t&&(e=e.slice(),r.children.push(i.tr((e.shift()||[]).map(e=>i.th(e))))),i.table(n.class("table table-striped table-hover table-sm"),r,i.tbody(e.map(e=>i.tr(e.map(e=>i.td(e))))))};class _HtmlDocument extends _HtmlElement{static simple(e){return new _HtmlDocument(n.lang("en"),i.head(i.meta(n.charset("utf-8")),i.meta(n.name("viewport"),n.content("width=device-width, initial-scale=1")),i.title(e.title||"index"),r("Bootstrap CSS"),i.link(n.rel("stylesheet"),n.href("https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"),n.integrity("sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"),n.crossorigin("anonymous")),r("Custom CSS"),i.style("body { margin: 50px; font-family: Arial, Helvetica, sans-serif; font-size: 12px; }"),...e.head||[]),i.body(r("Content"),i.div(n.id("root"),n.class("container"),...e.body||[]),r("Bootstrap JS"),i.script(n.src("https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"),n.integrity("sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"),n.crossorigin("anonymous")),r("Custom JS"),...e.scripts||[]))}constructor(...e){super("html",...e)}toString(){return"<!DOCTYPE html>"+super.toString()}}function mapGetOrElse(e,t,r){var n=e.get(t);return void 0===n&&(n=r(t),e.set(t,n)),n}function mapReverse(e){return new Map([...e.entries()].reverse())}function mapUpdate(e,t,r){r=r(e.get(t),t);return e.set(t,r),r}function isValidNumber(e){return isFinite(e)&&!isNaN(e)}function assertValidNumber(e){if(isValidNumber(e))return e;throw new TypeError("Expected number to be finite and not NaN. Got: "+e)}function roundWith(e,t,r=Math.round){e=(assertValidNumber(e)+"e").split("e"),r=(r(+(e[0]+"e"+(+e[1]+t)))+"e").split("e");return+(r[0]+"e"+(+r[1]-t))}function round(e,t=0){return roundWith(e,t,Math.round)}function MixinEventEmitter(e){return class Emitter extends e{constructor(...e){super(...e),this.events=new s}taskSync(e,t){try{this.emit("start",e,{task:"started"});var r=Date.now(),n=t(),i=(void 0!==n&&""!==n&&this.emit("data",e,{data:n}),round((Date.now()-r)/1e3,4)+" sec");return this.emit("completed",e,{task:"completed",elapsed:i}),n}catch(e){this.emit("error",e)}}task(n,i){return __awaiter(this,void 0,void 0,function*(){try{this.emit("start",n,{task:"started"});var e=Date.now(),t=yield i(),r=(void 0!==t&&""!==t&&this.emit("data",n,{data:t}),round((Date.now()-e)/1e3,4)+" sec");return this.emit("completed",n,{task:"completed",elapsed:r}),t}catch(e){this.emit("error",e)}})}taskStatus(e,t){this.emit("status",e,{task:"status",message:t})}emit(e,t,r){t instanceof Error?this.events.emit(e,t.stack,t,this):this.events.emit(e,t,r,this)}}}function strHashToBuffer(e,t="sha256"){return j(t).update(e).digest()}function strHashToString(e,t="sha256",r="base64"){return strHashToBuffer(e,t).toString(r)}(new O).start();const te=new Map;function MixinIndexed(e){return class Indexed extends e{constructor(...e){super(...e);var e=this.getConstructor(),t=te.get(e);void 0===t?te.set(e,this.i=0):te.set(e,this.i=t+1)}get uid(){return[this.getConstructor().name,this.i]}get uidString(){return this.uid.join(":")}get uidHashMd5(){return strHashToString(this.uidString,"md5","base64url")}get uidHashSha1(){return strHashToString(this.uidString,"sha1","base64url")}get uidHashSha256(){return strHashToString(this.uidString,"sha256","base64url")}}}function MixinTimestamped(e){return class Timestamped extends e{constructor(...e){super(...e),this.timestamp=Date.now()}}}function normalizeLineLengths(e,t,r){function singlePass(r,n,i){if(void 0===n||void 0===i){let e=0,t=0;for(const a of r){var s=a.length;e+=s,s>t&&(t=s)}e=Math.floor(e/r.length),void 0===n&&(n=e-Math.floor(e/2)),void 0===i&&(i=t-Math.floor(e/2))}for(let e=1;e<r.length;e++){var t=r[e],o=r[e-1];t.length+o.length<i&&(t.length<n||o.length<n)&&(r[e]=o+" "+t,r[e-1]="")}return r.filter(e=>!!e)}let n=singlePass(e,t,r);for(;n.length!==e.length;)n=singlePass(e=n,t,r);return n}function getHomeDirectory(){var e=h.resolve(process.env.HOME||process.env.USERPROFILE||"");if(e)return e;throw new Error("Home directory not found")}function getDownloadsDirectory(){return h.join(getHomeDirectory(),"Downloads")}function memoryUsage(){var e=e=>Math.floor(1e-6*e),t=process.memoryUsage();return{processAllocationMB:e(t.rss),heapAllocationMB:e(t.heapTotal),heapUsedMB:e(t.heapUsed),extenalV8:e(t.external)}}function shellSpawnProgram(i,...s){return new Promise((t,r)=>{let e;var n=s.indexOf("--no-inherit");(e=-1!==n?(s.splice(n,1),P.spawn(i,s)):P.spawn(i,s,{stdio:"inherit"})).on("error",e=>{r(e)}),e.on("close",e=>{t(i+" "+s.join(" "))})})}function streamToString(t){var r,n,i,s,o,a,l;return __awaiter(this,void 0,void 0,function*(){var e=[];try{try{for(r=!0,n=__asyncValues(t);i=yield n.next(),!(s=i.done);r=!0)l=i.value,r=!1,e.push(Buffer.from(l).toString())}catch(e){o={error:e}}finally{try{r||s||!(a=n.return)||(yield a.call(n))}finally{if(o)throw o.error}}}catch(e){return""}return e.join("")})}class StringStream extends F{constructor(e){super(),this.string=e,this.ended=!1}_read(){this.ended||(process.nextTick(()=>{this.push(Buffer.from(this.string)),this.push(null)}),this.ended=!0)}}function isEven(e){if(Number.isInteger(e))return e%2==0;throw new Error("Expected integer. Got "+e)}function isInRange(e,t,r=[!1,!1]){return(r[0]?e>t[0]:e>=t[0])&&(r[1]?e<t[1]:e<=t[1])}function isOdd(e){if(Number.isInteger(e))return e%2!=0;throw new Error("Expected integer. Got "+e)}const re=new Map([["en-US",[",","."]],["da-DK",[".",","]]]);class NumberFormatter{constructor(e=2){this.thousandSeparator=",",this.decimalSeparator=".",this.precision=e}static defineLocale(e,t,r){re.set(e,[t,r])}static getLocales(){var e=new Map;for(const t of re.entries())e.set(t[0],[t[1][0],t[1][1]]);return e}locale(e){var t=re.get(e);if(t)return this.thousandSeparator=t[0],this.decimalSeparator=t[1],this;throw new Error(`Invalid locale: ${e}. Valid: ${Array.from(re.keys())}}.`)}format(e){assertValidNumber(e);var t=0<=e?"":"-",r=Math.abs(round(e,this.precision)).toString().split("."),e=this.precision?this.decimalSeparator+(r[1]||"").padEnd(this.precision,"0"):"";let n="";for(let e=0;e<r[0].length;e++)e%3==0&&0!==e&&(n=this.thousandSeparator+n),n=r[0][r[0].length-e-1]+n;return t+n+e}parse(e){e=strReplaceAll(e,this.thousandSeparator,"").replace(this.decimalSeparator,".").replace(/[^\d.-]/g,"").split(".").map(e=>parseInt(e)).join(".");e=Number(e);return assertValidNumber(e),e}}function numRange(t,r){if(r<t)throw new Error(`Expected start to be less than or equal to end. Got: ${t} > `+r);if(t===r)return[t];var n=[];for(let e=t;e<=r;e++)n.push(e);return n}function roundDown(e,t=0){return roundWith(e,t,Math.floor)}function roundToNearest(e,t=1){return Math.round(assertInteger(e)/assertInteger(t))*t}const ne=/^10*$/;function isPowerOfTen(e){return ne.test(e.toString())}function assertPowerOfTen(e){if(isPowerOfTen(e))return e;throw new TypeError("Expected number to be a power of ten. Got: "+e)}function roundToNearestPow10(e,t=1){return Math.round(assertInteger(e)/assertInteger(assertPowerOfTen(t)))*t}function roundUp(e,t=0){return roundWith(e,t,Math.ceil)}function getConstructor(e){return Object.getPrototypeOf(e).constructor}function getOrElse(e,t){return void 0===e?t():e}function getOrThrow(e,t){if(void 0===e)throw t;return e}function getPrototype(e){return Object.getPrototypeOf(e)}function inheritStaticMembers(e,t,r=[]){var n,i=new Set([...r,"prototype","name","constructor"]);for(const s of Reflect.ownKeys(t))i.has(s)||Reflect.has(e,s)||(n=Object.getOwnPropertyDescriptor(t,s),Object.defineProperty(e,s,n));return e}function iterableFirstElement(e){for(const t of e)return t}function isConstructor(e){return"function"==typeof e&&!!e.prototype&&e.prototype.constructor===e}function isPrototype(e){return null!==e&&"object"==typeof e&&"constructor"in e&&e.constructor.prototype===e}function*iteratePrototypeChain(e){isPrototype(e)||isConstructor(e)||e===Function.prototype||(yield e,e=e.constructor.prototype);let t=e;for(;t;)yield t,t=Reflect.getPrototypeOf(t)}function objAssignDeep(e,t){return M(e,t)}function objDeepFreeze(e){for(const r of Reflect.ownKeys(e)){var t=e[r];(t&&"object"==typeof t||"function"==typeof t)&&objDeepFreeze(t)}return Object.freeze(e)}function objDelete(e,t){return delete e[t],e}function*objEntries(e){yield*Object.entries(e)}function objEntriesArray(e){return Array.from(Object.entries(e))}function objFilter(e,t,r=Object.keys){var n={};for(const i of r(e))t(e[i],i)&&(n[i]=e[i]);return n}function objForEach(e,t,r=Object.keys){for(const n of r(e))t(e[n],n);return e}function objGet(e,t){return e[t]}function objGetOrElse(e,t,r){var n=e[t];return void 0!==n?n:e[t]=r(t)}function objHas(e,t){return Object.hasOwn(e,t)}function objIsEmpty(e){for(const t of Object.keys(e))if(void 0!==t)return!1;return!0}function*objKeys(e){yield*Object.keys(e)}function objKeysArray(e){return Array.from(Object.keys(e))}function objMap(e,t,r=Object.keys){var n={};for(const i of r(e))n[i]=t(e[i],i);return n}function objMapKeys(e,t,r=Object.keys){var n={};for(const i of r(e))n[t(i,e[i])]=e[i];return n}function objMapMutable(e,t,r=Object.keys){for(const n of r(e))e[n]=t(e[n],n);return e}function objOmitKeys(e,...r){return objFilter(e,(e,t)=>!r.includes(t))}function objPropertyValueToGetter(e,...t){for(const n of t){var r=Object.getOwnPropertyDescriptor(e,n);if(!r)throw new Error(`Property descriptor for '${String(n)}' not found.`);const{enumerable:i,configurable:s,value:o}=r;Object.defineProperty(e,n,{enumerable:i,configurable:s,get:()=>o})}return e}function objReduce(e,t,r,n=Object.keys){for(const i of n(e))r=t(r,e[i],i);return r}function objReverse(e){return Object.fromEntries(objEntriesArray(e).reverse())}function objSet(e,t,r){return e[t]=r}function objSize(e){return Object.keys(e).length}function objSortKeys(e){return Object.fromEntries(Object.entries(e).sort((e,t)=>e[0].localeCompare(t[0])))}function objToMap(e){return new Map(Object.entries(e))}function objUpdate(e,t,r){return e[t]=r(e[t],t)}function*objValues(e){yield*Object.values(e)}function objValuesArray(e){return Array.from(Object.values(e))}function objWalk(e,i){!function recurse(e,r=[]){for(const[n,t]of Object.entries(e))"object"==typeof t&&null!==t?Array.isArray(t)?t.forEach((e,t)=>{recurse(e,r.concat([n+`[${t}]`]))}):recurse(t,r.concat(n)):i(t,r.concat(n))}(e)}function setEnumerable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.enumerable=!0,e))}function setNonConfigurable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.configurable=!1,e))}function setNonWritable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.writable=!1,e))}function setWritable(e,...t){objUpdatePropertyDescriptors(e,t,e=>(e.writable=!0,e))}function csvParseStream(n,i){return new Promise((e,t)=>{const r=[];n.pipe(N(i)).on("data",e=>{r.push(e)}).on("end",()=>{e(r)}).on("error",t)})}function markdownWrapCodeBlock(e,t=""){return"```"+t+"\n"+e.trim()+"\n```"}function regexClone(e){return new RegExp(e.source,e.flags)}function*rexec(e,t){var r;for(e=regexClone(e);null!==(r=e.exec(t));)yield{index:r.index,lastIndex:e.lastIndex,groups:Object.assign({},r.groups),match:r[0]}}function rexecFirstMatch(e,t){return iterableFirstElement(rexec(new RegExp(e.source,e.flags),t))}function parseMarkdownCodeBlock(e){var t,e=null==(e=rexecFirstMatch(/```(?<language>\w+)?(?<code>.+)```/gs,e.trim()))?void 0:e.groups;if(e)return{language:e,code:t}=e,{language:e,code:t.trim()};throw new Error("Could not parse the markdown code block.")}function parseMarkdownTable(e){return e.trim().split("\n").map(e=>e.trim()).filter((e,t)=>!!e).filter((e,t)=>1!==t).map(e=>e.trim().replace(/^\|/,"").replace(/\|$/,"").split("|").map(e=>e.trim()))}function pdfIteratePages(a,l,u){return __asyncGenerator(this,arguments,function*pdfIteratePages_1(){var e=yield __await(c.promises.readFile(a)),t=yield __await(d.load(e.buffer));u=u||t.getPages().length;for(let e=l=l||0;e<u;e++)try{var r=yield __await(d.create()),[n]=yield __await(r.copyPages(t,[e])),i=(r.addPage(n),yield __await(r.save())),s=Buffer.from(i),o=yield __await(R(s));yield yield __await(o.text)}catch(e){yield yield __await("")}})}function pdfGetPages(i,s,o){var a,l,u,c;return __awaiter(this,void 0,void 0,function*(){var e=[];try{for(var t,r=!0,n=__asyncValues(pdfIteratePages(i,s,o));t=yield n.next(),!(a=t.done);r=!0){c=t.value;r=!1;e.push(c)}}catch(e){l={error:e}}finally{try{r||a||!(u=n.return)||(yield u.call(n))}finally{if(l)throw l.error}}return e})}function pdfSplitPages(l,u){return __awaiter(this,void 0,void 0,function*(){var e=yield c.promises.readFile(l),t=yield d.load(e),r=t.getPages().length,n=r.toString().length,i=[];yield v(u);for(let e=0;e<r;e++){var s=yield d.create(),[o]=yield s.copyPages(t,[e]),o=(s.addPage(o),e),s=yield s.save(),a=o.toString().padStart(n,"0")+".pdf",a=h.join(u,a);yield c.promises.writeFile(a,s),i[o]=a}return i})}class _AbstractSubtitle{constructor(e,t){this.interval=e,this.text=t}}class SRTSubtitle extends _AbstractSubtitle{constructor(e,t){super(e,t)}toString(){return this.interval.toString(" --\x3e ",",")+`
`+this.text}}function isValidHours(e){return 0<=e&&e<=23&&Number.isInteger(e)}function assertValidHours(e){if(!isValidHours(e))throw new Error("Expected hours to be between 0 and 23. Got: "+e)}function isValidMilliseconds(e){return 0<=e&&e<=999&&Number.isInteger(e)}function assertValidMilliseconds(e){if(!isValidMilliseconds(e))throw new Error("Expected milliseconds to be between 0 and 999. Got: "+e)}function isValidMinutes(e){return 0<=e&&e<=59&&Number.isInteger(e)}function assertValidMinutes(e){if(!isValidMinutes(e))throw new Error("Expected minutes to be between 0 and 59. Got: "+e)}function isValidSeconds(e){return 0<=e&&e<=59&&Number.isInteger(e)}function assertValidSeconds(e){if(!isValidSeconds(e))throw new Error("Expected seconds to be between 0 and 59. Got: "+e)}function isValidTimeInt(e){return 0<=e&&e<864e5&&Number.isInteger(e)}function assertValidTimeInt(e){if(!isValidTimeInt(e))throw new Error("Expected time int to be between 0 and 86399999. Got: "+e)}function assertValidTime(e,t,r,n){assertValidHours(e),assertValidMinutes(t),assertValidSeconds(r),assertValidMilliseconds(n)}function assertValidTimeArray(e){if(4!==e.length)throw new Error("Expected array of length 4.");assertValidTime(e[0],e[1],e[2],e[3])}function timeArrayToIntUnsafe(e){var[e,t,r,n]=e;return 36e5*e+6e4*t+1e3*r+n}function timeArrayToInt(e){return assertValidTimeArray(e),timeArrayToIntUnsafe(e)}function timeIntToArrayUnsafe(e){var t=Math.floor(e/36e5),r=(e%=36e5,Math.floor(e/6e4)),n=(e%=6e4,Math.floor(e/1e3));return[t,r,n,e%=1e3]}function timeArrayToStringUnsafe(e,t="."){return e[0].toString().padStart(2,"0")+`:${e[1].toString().padStart(2,"0")}:`+e[2].toString().padStart(2,"0")+t+e[3].toString().padStart(3,"0")}function timeIntToStringUnsafe(e,t="."){return timeArrayToStringUnsafe(timeIntToArrayUnsafe(e),t)}function isValidTimeStringFormatting(e){return/^\s*([0-1][0-9]|2[0-3])[^0-9-]+[0-5][0-9][^0-9-]+[0-5][0-9][^0-9-]+[0-9][0-9][0-9]\s*$/.test(e)}function assertValidTimeStringFormatting(e){if(!isValidTimeStringFormatting(e))throw new Error("Expected timestring to be of format hh:mm:ss:mmm with any desired delimiters. Got: "+e)}function timeStringToArrayUnsafe(e){return e.trim().split(/[^0-9]+/).map(e=>parseInt(e))}function timeStringToArray(e){assertValidTimeStringFormatting(e);e=timeStringToArrayUnsafe(e);return assertValidTimeArray(e),e}function timeStringToInt(e){return assertValidTimeStringFormatting(e),timeArrayToIntUnsafe(timeStringToArray(e))}class Time{constructor(e){"number"==typeof e?(assertValidTimeInt(e),this.ms=e):this.ms=("string"==typeof e?timeStringToInt:timeArrayToInt)(e)}addHours(e){return this.ms+=36e5*e,assertValidTimeInt(this.ms),this}addMinutes(e){return this.ms+=6e4*e,assertValidTimeInt(this.ms),this}addSeconds(e){return this.ms+=1e3*e,assertValidTimeInt(this.ms),this}addMilliseconds(e){return this.ms+=e,assertValidTimeInt(this.ms),this}subtractHours(e){return this.ms-=36e5*e,assertValidTimeInt(this.ms),this}subtractMinutes(e){return this.ms-=6e4*e,assertValidTimeInt(this.ms),this}subtractSeconds(e){return this.ms-=1e3*e,assertValidTimeInt(this.ms),this}subtractMilliseconds(e){return this.ms-=e,assertValidTimeInt(this.ms),this}get hours(){return Math.floor(this.ms/36e5)}set hours(e){assertValidHours(e),this.addHours(e-this.hours)}get minutes(){return Math.floor(this.ms/6e4)%60}set minutes(e){assertValidMinutes(e),this.addMinutes(e-this.minutes)}get seconds(){return Math.floor(this.ms/1e3)%60}set seconds(e){assertValidSeconds(e),this.addSeconds(e-this.seconds)}get milliseconds(){return this.ms%1e3}set milliseconds(e){assertValidMilliseconds(e),this.addMilliseconds(e-this.ms)}toArray(){return timeIntToArrayUnsafe(this.ms)}toString(e="."){return timeIntToStringUnsafe(this.ms,e)}toNumber(){return this.ms}valueOf(){return this.ms}compareTo(e){return this.ms-e.ms}difference(e){return new Time(Math.abs(this.compareTo(e)))}clone(){return new Time(this.ms)}}class TimeInterval{constructor(e,t){if(t<e)throw new Error("Start time must be before end time");this.start=e,this.end=t}getDuration(){return this.end.difference(this.start)}toString(e=" --\x3e ",t="."){return""+this.start.toString(t)+e+this.end.toString(t)}}class SRTSubtitles{constructor(e){this.subtitles=e.trim().split(/\r?\n\r?\n/).map(e=>{var[,e,t]=e.trim().split(/\r?\n/),[e,r]=e.split(" --\x3e ").map(e=>new Time(e));return new SRTSubtitle(new TimeInterval(e,r),t)})}toString(){let t="";for(let e=0;e<this.subtitles.length;e++){var r=this.subtitles[e];t+=Number(e+1)+"\n"+r.toString()+"\n\n"}return t.trimEnd()}}class VTTSubtitle extends _AbstractSubtitle{constructor(e,t){super(e,t)}toString(){return this.interval.toString(" --\x3e ",".")+`
`+this.text}}class VTTSubtitles{constructor(e){this.subtitles=e.replace("WEBVTT","").trim().split(/\r?\n\r?\n/).map(e=>{var[e,t]=e.trim().split(/\r?\n/),[e,r]=e.split(" --\x3e ").map(e=>new Time(e));return new VTTSubtitle(new TimeInterval(e,r),t)})}toString(){return`WEBVTT

`+this.subtitles.join("\n\n")}}function strRemoveDuplicateChars(e){return Array.from(new Set(e)).join("")}function buildRegexBetween(e,t,r){return e="string"==typeof e?regexEscapeString(e):e.source,t="string"==typeof t?regexEscapeString(t):t.source,r=r?strRemoveDuplicateChars("gs"+r):"gs",new RegExp(`(?<left>${e})(?<mid>.*?)(?=${t})(?<right>${t})`,r)}function strSortChars(e){return Array.from(e).sort().join("")}function regexFixFlags(e){return e&&strSortChars(strRemoveDuplicateChars(e).replace(/[^gimsuy]/gi,""))}function regexGetGroupNames(e){var t=[];for(const r of rexec(/\(\?<(?<name>\w+)>/g,e.toString()))t.push(r.groups.name);return t}function regexIsValidFlags(e){return/^[gimsuy]*$/.test(e)&&strRemoveDuplicateChars(e).length===e.length}function regexMatcherToValidater(e){return new RegExp(`^${e.source}$`,e.flags.replace("g",""))}function compareArray(r,e=!1){const a=e?-1:1;return(e,t)=>function recursiveCompare(i,s,e){var t;if(!Array.isArray(i))return Array.isArray(s)?-1*a:0===(t=r(i,s))&&e||t;{if(!Array.isArray(s))return a;let r,n;n=i.length>s.length?(r=i.length,a):i.length<s.length?(r=s.length,-1*a):(r=i.length,0);for(let e=0,t=r;e<t;e++){var o=recursiveCompare(i[e],s[e],n);if(0!==o)return o}}return 0}(e,t)}function regexScopeTree(e,t){function parseParam(e){e="string"==typeof e?new RegExp(regexEscapeString(e),"g"):new RegExp(e.source,strRemoveDuplicateChars(e.flags+"g"));return[e,new RegExp("^"+e.source+"$","")]}const[c,h]=parseParam(e),[d,m]=parseParam(t);return function*(e,t=!1){var r=[...rexec(c,e)].concat([...rexec(d,e)]),n=(r.sort(compareArray((e,t)=>e.index-t.index)),[]),i=[];for(const u of r)if(h.test(u.match))i.push(u);else if(m.test(u.match)){var s=i.pop(),o=u,a=i.length,l={parent:null,depth:a,left:s,right:o,between:{index:s.lastIndex,lastIndex:o.index,groups:{},match:e.substring(s.lastIndex,o.index)},children:[]};setNonEnumerable(l,"parent");for(let e=n.length-1;0<=e&&!(s.index>=n[e].left.index||o.lastIndex<=n[e].right.lastIndex);e--)l.children.push(n[e]),null===n[e].parent&&(n[e].parent=l);n.push(l),t&&0<a||(yield l)}}}function regexValidFlags(){return["g","i","m","s","u","y"]}var ie=buildRegexBetween(/(^|\n| *)\/\*\*/g,/\n +\*\//g),se=buildRegexBetween(/(^|\n)export (default )?(async )?function/,/\n\}(\n|$)/);const oe=/^(0x|0h|(\\?u)|#)?[0-9A-F]+$/i;var ae=/^(0x|0h|(\\?u)|#)/i,le=/-?\d+/g,ue=buildRegexBetween(/(^|\n)describe\(/,"\n})"),ce=new Map([["en-US",/^[A-Z]+$/i],["az-AZ",/^[A-VXYZÇƏĞİıÖŞÜ]+$/i],["bg-BG",/^[А-Я]+$/i],["cs-CZ",/^[A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i],["da-DK",/^[A-ZÆØÅ]+$/i],["de-DE",/^[A-ZÄÖÜß]+$/i],["el-GR",/^[Α-ώ]+$/i],["es-ES",/^[A-ZÁÉÍÑÓÚÜ]+$/i],["fa-IR",/^[ابپتثجچحخدذرزژسشصضطظعغفقکگلمنوهی]+$/i],["fr-FR",/^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i],["it-IT",/^[A-ZÀÉÈÌÎÓÒÙ]+$/i],["nb-NO",/^[A-ZÆØÅ]+$/i],["nl-NL",/^[A-ZÁÉËÏÓÖÜÚ]+$/i],["nn-NO",/^[A-ZÆØÅ]+$/i],["hu-HU",/^[A-ZÁÉÍÓÖŐÚÜŰ]+$/i],["pl-PL",/^[A-ZĄĆĘŚŁŃÓŻŹ]+$/i],["pt-PT",/^[A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i],["ru-RU",/^[А-ЯЁ]+$/i],["sl-SI",/^[A-ZČĆĐŠŽ]+$/i],["sk-SK",/^[A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i],["sr-RS@latin",/^[A-ZČĆŽŠĐ]+$/i],["sr-RS",/^[А-ЯЂЈЉЊЋЏ]+$/i],["sv-SE",/^[A-ZÅÄÖ]+$/i],["th-TH",/^[ก-๐\s]+$/i],["tr-TR",/^[A-ZÇĞİıÖŞÜ]+$/i],["uk-UA",/^[А-ЩЬЮЯЄIЇҐі]+$/i],["vi-VN",/^[A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i],["ku-IQ",/^[ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i],["he",/^[א-ת]+$/],["fa",/^['آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی']+$/i]]),he=new Map([["en-US",/^[0-9A-Z]+$/i],["az-AZ",/^[0-9A-VXYZÇƏĞİıÖŞÜ]+$/i],["bg-BG",/^[0-9А-Я]+$/i],["cs-CZ",/^[0-9A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i],["da-DK",/^[0-9A-ZÆØÅ]+$/i],["de-DE",/^[0-9A-ZÄÖÜß]+$/i],["el-GR",/^[0-9Α-ω]+$/i],["es-ES",/^[0-9A-ZÁÉÍÑÓÚÜ]+$/i],["fr-FR",/^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i],["it-IT",/^[0-9A-ZÀÉÈÌÎÓÒÙ]+$/i],["hu-HU",/^[0-9A-ZÁÉÍÓÖŐÚÜŰ]+$/i],["nb-NO",/^[0-9A-ZÆØÅ]+$/i],["nl-NL",/^[0-9A-ZÁÉËÏÓÖÜÚ]+$/i],["nn-NO",/^[0-9A-ZÆØÅ]+$/i],["pl-PL",/^[0-9A-ZĄĆĘŚŁŃÓŻŹ]+$/i],["pt-PT",/^[0-9A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i],["ru-RU",/^[0-9А-ЯЁ]+$/i],["sl-SI",/^[0-9A-ZČĆĐŠŽ]+$/i],["sk-SK",/^[0-9A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i],["sr-RS@latin",/^[0-9A-ZČĆŽŠĐ]+$/i],["sr-RS",/^[0-9А-ЯЂЈЉЊЋЏ]+$/i],["sv-SE",/^[0-9A-ZÅÄÖ]+$/i],["th-TH",/^[ก-๙\s]+$/i],["tr-TR",/^[0-9A-ZÇĞİıÖŞÜ]+$/i],["uk-UA",/^[0-9А-ЩЬЮЯЄIЇҐі]+$/i],["ku-IQ",/^[٠١٢٣٤٥٦٧٨٩0-9ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i],["vi-VN",/^[0-9A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i],["he",/^[0-9א-ת]+$/],["fa",/^['0-9آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی۱۲۳۴۵۶۷۸۹۰']+$/i]]),de=/-?\d{1,3}(,\d{3})*(\.\d+)?/g,me=/-?\d{1,3}(\.\d{3})*(,\d+)?/g,fe=/-?\d+,\d+/g,pe=/-?\d+.\d+/g,ge=/((\r?\r?\n)|\s|\t){2,}/g;const ye=/(?<dd>[0-3][0-9])(?<mm>[0-1][0-9])(?<yy>[0-9]{2}).?(?<id4>[0-9]{4})/g;var ve=buildRegexBetween(/ +\* +(@example )?```(ts|typescript|js|javascript)?/i,/ +\* +```\n/g),we=/\b[^\W]+/g;function setAddMany(e,t){for(const r of t)e.add(r);return e}function setDifference(e,t){var r=new Set(e);for(const n of t)r.delete(n);return r}function setIntersection(t){if(!t.length)return new Set;var r=new Set(t[0].values());for(let e=1;e<t.length;e++)for(const n of r.values())t[e].has(n)||r.delete(n);return r}function setIsSuperset(e,t){for(const r of t)if(!e.has(r))return!1;return!0}function setSymmetricDifference(e,t){var r=new Set(e);for(const n of t)r.has(n)?r.delete(n):r.add(n);return r}function setUnion(t){if(!t.length)return new Set;var r=new Set(t[0].values());for(let e=1;e<t.length;e++)for(const n of t[e].values())r.add(n);return r}function compareNumberDescending(e,t){return t-e}function compareNumericDescending(e,t){return t<e?-1:e<t?1:0}function compareStringDescending(e,t){return t.localeCompare(e)}function letterToCol(t,e=!1){if(t=t.toUpperCase(),!/^[A-Z]*$/i.test(t))throw new Error("Invalid column letter: "+t);let r=0;var n=t.length;for(let e=0;e<n;e++)r+=(t.charCodeAt(e)-64)*Math.pow(26,n-e-1);return r-(e?1:0)}function A1ToColRow(e,t=!1){var r=[...rexec(/^(?<a>[A-Z]+)(?<n>[1-9]+)$/g,e=e.toUpperCase())];if(r.length)return t=t?1:0,[letterToCol(r[0].groups.a)-t,parseInt(r[0].groups.n)-t];throw new Error("Invalid A1 string: "+e)}function colToLetter(e,t=!1){if(t&&e++,!Number.isInteger(e))throw new Error("Expected col to be an integer. Got: "+e);if(e<1)throw new Error("Expected col to be greater than zero. Got: "+e);let r="";for(var n;0<e;)n=(e-1)%26,r=String.fromCharCode(65+n)+r,e=(e-n-1)/26;return r}function colRowToA1(e,t=!1){if(2!==e.length)throw new Error("Expected CR to to be length 2. Got: "+e.length);if(!Number.isInteger(e[1]))throw new Error("Expected row to be an integer. Got: "+e[1]);if(e[1]<1)throw new Error("Expected row to be greater than zero. Got: "+e[1]);return colToLetter(e[0],t)+e[1].toString()}function strCountCharOccurances(e,t){if(1!==t.length)throw new Error("Expected char to be a single character string of length 1.");let r=0;for(const n of e)n===t&&r++;return r}function strCountChars(e){var t=new Map;for(const n of e){var r=t.get(n);t.set(n,r?r+1:1)}return t}function strToWords(e){return m(e)}function strCountWords(e){return strToWords(e).length}function strEnsureEndsWith(e,t){return e.endsWith(t)?e:e+t}function strFirstCharToUpperCase(e){return e.charAt(0).toUpperCase()+e.substring(1)}function strHashToStringDJB2(t){let r=5381;for(let e=0;e<t.length;e++)r=(r<<5)+r+t.charCodeAt(e);return r}function strHashToUint32Array(e,t="sha256"){return new Uint32Array(strHashToBuffer(e,t).buffer)}function strIsLowerCase(e){return e===e.toLowerCase()}function strIsMultiLine(e){return e.includes("\n")}function strIsUpperCase(e){return e===e.toUpperCase()}function strNoConsecutiveEmptyLines(e){return e.replace(/\n\n+/g,"\n\n")}function strNoConsecutiveWhitespace(e){return e.replace(/\s{2,}/g," ")}function strParseBoolean(e){return"true"===e.trim().toLowerCase()}function strPrependLines(e,t){return e.split(/\r?\n/).map(e=>t+e).join("\n")}function strRemoveEmptyLines(e){return e.split(/\r?\n/).filter(e=>!!e.trim()).join("\n")}function strRemoveFirstAndLastLine(e){e=e.split(/\r?\n/);return e.length<=2?"":e.slice(1,e.length-1).join("\n")}function strRemoveNewLines(e,t=""){return e.replace(/\r*\n/g,t)}function strSplitAndTrim(e,t,r=!1){e=e.split(t).map(e=>e.trim());return r?e.filter(e=>!!e.trim()):e}function strSplitCamelCase(t){if(!t)return[];if(t.length<=2)return[t];var r,n=[],i=t.length-1;let s=0,o=!1;for(let e=1;e<t.length;e++)(function isWordSplitIndex(e,t){return strIsLowerCase(e[t-1])&&strIsUpperCase(e[t])&&!be.test(e[t-1])&&!be.test(e[t])&&!Se.test(e[t-1])&&!Se.test(e[t])})(t,e)&&(r=t.substring(s,e))&&(n.push(r),s=e,o=!0),o&&e===i&&(r=t.substring(s))&&n.push(r);return o||n.push(t),n}const be=/\d+/g,Se=/[^\w]+/g;function strToCharCodes(t){var r=new Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.codePointAt(e);return r}function strToCharSet(e){return new Set(e)}function strToSentences(e){return e?L(e).filter(e=>"Sentence"===e.type).map(e=>e.raw):[]}function strToSortedCharSet(e){return Array.from(new Set(e)).sort().join("")}function strTrimLines(e){return e.split(/\r?\n/).map(e=>e.trim()).join("\n")}function strTrimLinesLeft(e){return e.split(/\r?\n/).map(e=>e.trimStart()).join("\n")}function strTrimLinesRight(e){return e.split(/\r?\n/).map(e=>e.trimEnd()).join("\n")}function strUnwrap(e,t,r,n=""){return e.replace(new RegExp("^"+regexEscapeString(t),n),"").replace(new RegExp(regexEscapeString(r)+"$",n),"")}function strWrapBetween(e,t,r){return t+e+r}function strWrapIn(e,t){return t+e+t}function strWrapInAngleBrackets(e){return"<"+e+">"}function strWrapInBraces(e){return"{"+e+"}"}function strWrapInBrackets(e){return"["+e+"]"}function strWrapInDoubleQuotes(e){return'"'+e+'"'}function strWrapInParenthesis(e){return"("+e+")"}function strWrapInSingleQuotes(e){return"'"+e+"'"}function assertValidTimeString(e){assertValidTimeStringFormatting(e),assertValidTimeArray(timeStringToArrayUnsafe(e))}function isValidTime(e,t,r,n){return isValidHours(e)&&isValidMinutes(t)&&isValidSeconds(r)&&isValidMilliseconds(n)}function isValidTimeArray(e){return 4===e.length&&isValidTime(e[0],e[1],e[2],e[3])}function isValidTimeString(e){return!!e&&isValidTimeStringFormatting(e)}function timeArrayToString(e,t="."){return assertValidTimeArray(e),timeArrayToStringUnsafe(e,t)}function timeIntToArray(e){return assertValidTimeInt(e),timeIntToArrayUnsafe(e)}function timeIntToString(e,t="."){return assertValidTimeInt(e),timeIntToStringUnsafe(e,t)}function timeStringToIntUnsafe(e){return timeArrayToIntUnsafe(timeStringToArrayUnsafe(e))}function tsCountExports(e){return(null==(e=e.match(/^export /gm))?void 0:e.length)||0}function*tsDocExtractAllComments(e){const t=/^\s*\/\*\*\s*$/,r=/^\s*\*\/\s*$/;let n=e.split(/\r?\n/),i=0;for(;;){var s=n.findIndex(e=>t.test(e)),o=n.findIndex(e=>r.test(e));if(-1===s||-1===o)break;{let e;""===(null===(e=o+1<n.length?n[o+1]:e)||void 0===e?void 0:e.trim())&&o+2<n.length&&(e=n[o+2]),yield{start:s+i,end:o+i,match:n.slice(s,o+1).join("\n"),nextLine:e},n=n.slice(o+1),i+=o+1}}}function tsStripBlockComments(e){var t,r,n=e.split("\n");const i=new Set;for({start:t,end:r}of tsDocExtractAllComments(e))for(const s of numRange(t,r))i.add(s);return k.block(n.filter((e,t)=>!i.has(t)).join("\n"))}function tsExtractImports(e){var t=/^import /,r=/\{\s*$/,n=/^\} from '/,i=[];let s=!1,o=[];var a=e.split(/\r?\n/);for(let e=0;e<a.length;e++){var l=a[e];t.test(l)?r.test(l)?(o.push(l),s=!0):i.push({start:e,end:e,match:l}):s&&(o.push(l),n.test(l))&&(i.push({start:e-o.length+1,end:e,match:o.join("\n")}),o=[],s=!1)}return i}function tsStripImports(e){var t,r,n=e.split("\n"),e=tsExtractImports(e);const i=new Set;for({start:t,end:r}of e)for(const s of numRange(t,r))i.add(s);return n.filter((e,t)=>!i.has(t)).join("\n").trimStart()}function tsStripInlineComments(e){return k.line(e.replace(/\n\s*\/\/.*\n/g,"\n").replace(/(^|\n)\s*\/\/.*(\n|$)/g,""))}function tsCountLinesOfCode(e){return(e=strRemoveEmptyLines(e=tsStripInlineComments(e=tsStripBlockComments(e=tsStripImports(e))))).trim()?e.split("\n").length:0}function tsExtractJestTests(e){var e=e.split(/\r?\n/),t=e.findIndex(e=>e.startsWith("describe(")),r=arrFindLastIndexOf(e,e=>e.startsWith("})"));if(-1===t||-1===r)throw new Error("Could not parse the tests from the input source code.");return e.slice(t,r+1).join("\n").trim()}function tsGetClassMemberAccessModifiers(e){var t,r={};for({groups:t}of rexec(/^\s*(?<privacy>protected|private) ((static|abstract|optional|readonly|get|set|async) )*(?<name>\w+)/gm,e))r[t.name]=t.privacy;return r}function tsHasDefaultExport(e){return/^export default /m.test(e)}function tsJestConvertExportNameString(e,t){var r="describe("+t+".name";return e.replace("describe('"+t+"'",r).replace('describe("'+t+'"',r)}function tsJestEnsureLineSpacing(e){return strRemoveEmptyLines(e).split("\n").map(e=>/^(describe|it|test)\(/.test(e.trimStart())?"\n"+e:e).join("\n")}function tsSimpleMinifyCode(e){return strRemoveEmptyLines(strTrimLines(e))}function tsStripComments(e){return tsStripBlockComments(tsStripInlineComments(e))}function tsStripDeclSourceMapComments(e){return e.replace(/\n\s*\/\/#.+\.d\.ts\.map(\n|$)/g,"\n")}function tsStripExportKeyword(e){return e.replace(/^export /gm,"")}function isMultiTsDocTag(e){return/^(param|throws|see|template|typeParam|inheritDoc|link|deprecated)$/i.test(e)}function isNamedMultiTsDocTag(e){return/^(param)$/i.test(e)}function isNamedTsDocTag(e){return/^(param|property|typedef|alias|event|function|method|namespace|enum|interface|class|type|var|module)$/i.test(e)}function isValidTsDocComment(e){if(!(e=e.trim()))return!1;var t=e.split(/\r?\n/);if(t.length<2)return!1;if("/**"!==t[0].trim())return!1;if("*/"!==t[t.length-1].trim())return!1;if(2!==t.length)for(let e=1;e<t.length-1;e++)if(!t[e].trimStart().startsWith("*"))return!1;return!0}function tsDocNormalizeTagName(e){var t=e.toLowerCase();return"virtual"===t?"abstract":"augments"===t?"extends":"constructor"===t?"class":"const"===t?"constant":"defaultvalue"===t?"default":"desc"===t?"description":"host"===t?"external":"fileoverview"===t?"file":"fires"===t?"emits":"func"===t?"function":"var"===t?"member":"arg"===t?"param":"prop"===t?"property":"return"===t?"returns":"exception"===t?"throws":"yield"===t?"yields":e}class TsDocTag{constructor(e,t="",r=[]){if(e=tsDocNormalizeTagName(e),!/^[a-z]+$/i.test(e))throw new Error("Invalid tag name: "+e);if(this.tag=e,/^(param)$/i.test(e)&&!r.join("").trim())throw new Error("Tag @"+e+" requires a description.");if(isNamedTsDocTag(e)){if(!t)throw new Error("Tag @"+e+" requires a name parameter.");if(!/^[a-z]/i.test(t))throw new Error("Name must start with char a-z: "+t);if(!/^[\w.]+$/i.test(t))throw new Error('Name may contain word chars and ".": '+t)}else{if(t)throw new Error("Tag @"+e+" does not support a name parameter.");if(!r.join("").trim())throw new Error("Tag @"+e+" requires a description.")}if(this.name=t,"example"===this.tag){e=arrFindIndicesOf(r=r.join("\n").trim().replace(/^ ?- ?/," ").split("\n"),e=>e.includes("```"));if(2===e.length){var t=e[0],n=e[1];r=r.slice(t+1,n)}else if(0!==e.length)throw new Error("Invalid example tag: markdown code block not closed.");r=["```ts",...r,"```"]}this.description=r}toString(){let e="description"===this.tag?"":"@"+this.tag;return this.name&&(e+=" "+this.name),e=e.trim(),e=this.description.length?(e+=" "+this.description.join("\n")).trim():e}}function tsDocStripTypesAndDefaults(e){for(const r of rexec(/^\s*(\* +)?@\w+ (?<type>\{.+\} )/gm,e))e=e.replace(r.groups.type,"");for(const n of rexec(/^\s*(\* +)?@\w+ (?<defaultValue>\[.+\] )/gm,e)){var t=n.groups.defaultValue.split("=")[0].trim().substring(1)+" ";e=e.replace(n.groups.defaultValue,t)}return e}function tsDocUnwrapComment(e){if(isValidTsDocComment(e))return e=strTrimLinesRight(e=(e=strRemoveFirstAndLastLine(e=e.trim())).replace(/^ *\*( |$)/gm,""));throw new Error("Invalid TSDoc comment")}function tsDocWrapAsComment(e){return["/**",strPrependLines(e," * ")," */"].join("\n")}class TsDoc{constructor(e,t){this.single=new Map,this.multi=new Map,this.namedMulti=new Map,t&&(t.tagOrder&&(this.tagOrder=Array.from(t.tagOrder)),t.paramOrder)&&(this.paramOrder=new Set(t.paramOrder)),e&&this.addBlockComment(e)}addBlockComment(e){for(const o of(e=(e=tsDocUnwrapComment(e=tsDocStripTypesAndDefaults(e))).startsWith("@")?e:"description "+e).split(/^@/gm)){var t=o.trimEnd().split(/\r?\n/),r=t[0].split(" "),n=r.shift();if(n&&this.getTagOrder().includes(n)){var i=isNamedTsDocTag(n),s=i?r.shift():"";if(!i||s){t[0]=r.join(" ").trim();let e;try{e=new TsDocTag(n,s,t)}catch(e){continue}this.addTag(e)}}}return this}get size(){let e=this.single.size;for(const t of this.namedMulti.values())e+=t.size;for(const r of this.multi.values())e+=r.length;return e}get isEmpty(){return 0===this.size}clear(){return this.single.clear(),this.multi.clear(),this.namedMulti.clear(),this}addTag(e){e.tag=tsDocNormalizeTagName(e.tag);const{tag:t,name:r,description:n}=e;var i,s;return this.getTagOrder().includes(t)&&(/^(param)$/i.test(t)?(i=mapGetOrElse(this.namedMulti,t,()=>new Map)).has(r)||i.set(r,e):isMultiTsDocTag(t)?-1===(s=(i=mapGetOrElse(this.multi,t,()=>[])).findIndex(e=>arrShallowEquals(e.description,n)))?i.push(e):i[s]=e:this.single.has(t)||this.single.set(t,e)),this}removeTags(e,t){var r;return e=tsDocNormalizeTagName(e),this.getTagOrder().includes(e)&&(/^(param)$/i.test(e)?void 0!==t?null!=(r=this.namedMulti.get(e))&&r.delete(t):this.namedMulti.delete(e):(isMultiTsDocTag(e)?this.multi:this.single).delete(e)),this}*iterateTags(e){this.reorderParams();for(const n of this.getTagOrder())if(e&&""===n&&(yield n),/^(param)$/i.test(n)){var t=this.namedMulti.get(n);if(t)for(const i of t.values())yield i}else if(isMultiTsDocTag(n)){t=this.multi.get(n);if(t)for(const s of t)yield s}else{var r=this.single.get(n);r&&(yield r)}}clone(){return new TsDoc(this.render())}assign(e){for(const t of e.iterateTags())t&&this.addTag(t);return this}reorderParams(){if(this.paramOrder){var e=this.namedMulti.get("param");if(e){var t=new Map;for(const n of this.paramOrder){var r=e.get(n);r&&t.set(n,r)}this.namedMulti.set("param",t)}}return this}render(){return tsDocWrapAsComment([...this.iterateTags(!0)].join("\n"))}toString(){return this.render()}getTagOrder(){return this.tagOrder||TsDoc.defaultTagOrder}}function tsDocExtractFirstComment(e){for(const t of tsDocExtractAllComments(e))return t}function tsDocFixSpacingBeforeAfter(e){return e.replace(/ \*\/\s*\n\n/g," */\n").split(/\r?\n/).map((e,t,r)=>/^(\s*\/\*\*\s*)$/.test(e)&&t&&r[t-1].trim()?"\n"+e:e).join("\n")}function tsDocRemoveEmptyLines(e){return e.replace(/(^|\n) *\* *(\n|$)/g,"\n")}function tsDocStripAllTagsButThrowsParamDescription(e){let t=e+"";for(var{match:r}of tsDocExtractAllComments(e)){var n=new TsDoc(r),i=n.single.get("description"),s=n.namedMulti.get("param"),o=n.multi.get("throws");n.clear(),i&&n.single.set("description",i),s&&n.namedMulti.set("param",s),o&&n.multi.set("throws",o),t=null===t||void 0===t?void 0:t.replace(r,n.render())}return t}function tsDocStripExample(e){let t=e+"";for(var{match:r}of tsDocExtractAllComments(e)){var n=new TsDoc(r);n.removeTags("example"),t=null===t||void 0===t?void 0:t.replace(r,n.render())}return t}function tsDocWrapExample(e){return" * @example ```ts\n"+e.split("\n").map(e=>" * "+e).join("\n")+"\n * ```"}function assertNegativeInteger(e){if(Number.isInteger(e)&&e<=0)return e;throw new TypeError("Expected int to be a negative integer. Got: "+e)}function assertNonZeroNegativeInteger(e){if(Number.isInteger(e)&&e<0)return e;throw new TypeError("Expected int to be a non-zero negative integer. Got: "+e)}function assertNonZeroPositiveInteger(e){if(Number.isInteger(e)&&0<e)return e;throw new TypeError("Expected a non-zero positive integer. Got: "+e)}function isHex(e){return oe.test(e)}function isHexOrUnicode(e){return/^(\\\\?u|0x)?[\da-f]+$/i.test(e)}function isInteger(e){return Number.isInteger(e)}function isIterable(e){return"string"==typeof e||"undefined"!=typeof Symbol&&Symbol&&"iterator"in Symbol&&null!=e&&"object"==typeof e&&Symbol.iterator in e&&"function"==typeof e[Symbol.iterator]}function isNegativeInteger(e){return Number.isInteger(e)&&e<0}function isNumericString(e){var e=e.trim();return!!e&&(e=Number(e),!isNaN(e))&&isFinite(e)}function isPositiveInteger(e){return Number.isInteger(e)&&0<e}function parseSocialSecurityNumberDK(e){e=e.match(regexMatcherToValidater(ye));if(e&&e.groups){var{dd:e,mm:t,yy:r,id4:n}=e.groups,e=parseInt(e),t=parseInt(t),i=getCurrentYear(),s=parseInt(r)>parseInt(String(i).substring(2)),i=parseInt(""+(getCentury(i)-(s?2:1))+r);if(isValidDate(i,t,e))return{year:i,month:t,day:e,id:parseInt(n),sex:isEven(parseInt(n.substring(3)))?"F":"M"}}}function isSocialSecurityNumberDK(e){return!!parseSocialSecurityNumberDK(e)}TsDoc.defaultTagOrder=["description","remarks","typeParam","template","param","returns","yields","emits","throws","method","example"];export{A1ToColRow,AbstractApiClient,AbstractFsPath,ApiReponseCache,BlockDevicePath,CharacterDevicePath,DirectoryPath,ExtensibleFunction,FIFOPath,FilePath,o as LogLevel,Logger,V as MS_IN_DAY,B as MS_IN_HOUR,U as MS_IN_MINUTE,q as MS_IN_MONTH,z as MS_IN_SECOND,W as MS_IN_WEEK,H as MS_IN_YEAR,Matrix,MixinBase,MixinEventEmitter,MixinIndexed,MixinTimestamped,NumberFormatter,OpenaiApiClient,OpenaiApiClientExtended,PriorityQueue,PromiseQueue,Queue,SRTSubtitle,SRTSubtitles,SimpleTable,SocketPath,SortedArray,StringStream,SymbolicLinkPath,Time,TimeInterval,TsDoc,TsDocTag,VTTSubtitle,VTTSubtitles,_AbstractSubtitle,Y as _HTML_ATTRIBUTES,J as _HTML_BOOLEAN_ATTRIBUTES,X as _HTML_ELEMENTS,t as _HTML_EVENT_ATTRIBUTES,K as _HTML_GLOBAL_ATTRIBUTES,Q as _HTML_VOID_ELEMENTS,_HtmlAttribute,_HtmlDocument,_HtmlElement,absoluteToRelativePath,appendLineToFile,arrAverage,arrEachToString,arrEvery,arrFindIndicesOf,arrFindLast,arrFindLastIndexOf,arrFlatten,arrIndicesOf,arrLast,arrMapMutable,arrObjectsToTable,arrObjectsUniqueKeys,arrRemoveDuplicates,arrShallowEquals,arrShuffle,arrSome,arrSortNumeric,arrSortedInsertionIndex,arrSum,arrSwap,arrTableAssertRowsSameLength,arrTableEachToString,arrTableToCsv,arrTableToObjects,assertInteger,assertNegativeInteger,assertNonZeroNegativeInteger,assertNonZeroPositiveInteger,assertPositiveInteger,assertPowerOfTen,assertValidDate,assertValidDateDay,assertValidDateMonth,assertValidDateYear,assertValidHours,assertValidMilliseconds,assertValidMinutes,assertValidNumber,assertValidSeconds,assertValidTime,assertValidTimeArray,assertValidTimeInt,assertValidTimeString,assertValidTimeStringFormatting,asyncTasksLimit,asyncTasksParallel,asyncTasksSerial,asyncWithTimeout,atob,n as attr,btoa,buildRegexBetween,bytesToInt,cleanDirectorySync,colRowToA1,colToLetter,r as comment,compareArray,compareNumber,compareNumberDescending,compareNumeric,compareNumericDescending,compareString,compareStringDescending,convertFilter,createDirectory,createDirectorySync,createFileExtensionFilter,createObjectFactory,csvParseStream,cwdpath,dateDaysAgo,dateWeekDayName,daysSinceDate,deleteDirectory,deleteDirectorySafe,deleteDirectorySafeSync,deleteDirectorySync,i as el,ensureValidWindowsPath,findFile,funAsyncAutoRateLimit,funAsyncRateLimit,funParseClass,funParseFunction,funSetName,getCentury,getConstructor,getCurrentYear,getDownloadsDirectory,getHomeDirectory,getLastMofifiedFileIn,getOrElse,getOrThrow,getPrototype,hoursSinceDate,inheritStaticMembers,instantiateCorrectFsPathSubclass,intToArrayBytes,intToBuffer,intToBytes,isConstructor,isEven,isHex,isHexOrUnicode,isInRange,isInteger,isIterable,isLeapYear,isMultiTsDocTag,isNamedMultiTsDocTag,isNamedTsDocTag,isNegativeInteger,isNumericString,isObject,isOdd,isPositiveInteger,isPowerOfTen,isPrototype,isSocialSecurityNumberDK,isValidDate,isValidDateDay,isValidDateMonth,isValidDateYear,isValidHours,isValidMilliseconds,isValidMinutes,isValidNumber,isValidSeconds,isValidTime,isValidTimeArray,isValidTimeInt,isValidTimeString,isValidTimeStringFormatting,isValidTsDocComment,isoDateTimestamp,isoDateTimestampForFilename,iterableFirstElement,iteratePrototypeChain,letterToCol,e as log,mapGetOrElse,mapReverse,mapUpdate,markdownWrapCodeBlock,memoryUsage,minutesSinceDate,monthsSinceDate,msSinceDate,normalizeFileExtension,normalizeLineLengths,numDaysInMonth,numRange,objAssignDeep,objDeepFreeze,objDelete,objEntries,objEntriesArray,objFilter,objForEach,objGet,objGetOrElse,objHas,objIsEmpty,objKeys,objKeysArray,objMap,objMapKeys,objMapMutable,objOmitKeys,objOmitKeysMutable,objPropertyValueToGetter,objReduce,objReverse,objSet,objSize,objSortKeys,objToMap,objUpdate,objUpdatePropertyDescriptors,objValues,objValuesArray,objWalk,$ as openaiApiErrorCodes,padArrayBytesLeft,padArrayBytesRight,parseMarkdownCodeBlock,parseMarkdownTable,parseSocialSecurityNumberDK,pdfGetPages,pdfIteratePages,pdfSplitPages,prettyIsoDateString,randomIntBetween,readExcelFile,readJsonFile,readJsonFileSync,ie as regBlockCommentsWithIndent,se as regFunctionsExports,oe as regHex,ae as regHexPrefix,le as regInteger,ue as regJestTests,ce as regLocaleAlpha,he as regLocaleAlphaNumeric,de as regNumberCommaSepDotDecimal,me as regNumberDotSepCommaDecimal,fe as regNumberNoThousandSepCommaDecimal,pe as regNumberNoThousandSepDotDecimal,ne as regPowerOfTen,ge as regRepeatingWhiteSpace,ye as regSocialSecurityNumbersDK,ve as regTsDocExampleLines,we as regWords,regexClone,regexEscapeString,regexFixFlags,regexGetGroupNames,regexIsValidFlags,regexMatcherToValidater,regexScopeTree,regexValidFlags,removeIllegalFilenameCharacters,rexec,rexecFirstMatch,round,roundDown,roundToNearest,roundToNearestPow10,roundUp,roundWith,secondsSinceDate,setAddMany,setDifference,setEnumerable,setIntersection,setIsSuperset,setNonConfigurable,setNonEnumerable,setNonWritable,setSymmetricDifference,setUnion,setWritable,shellSpawnProgram,strCountCharOccurances,strCountChars,strCountWords,strEnsureEndsWith,strFirstCharToUpperCase,strHashToBuffer,strHashToString,strHashToStringDJB2,strHashToUint32Array,strIsLowerCase,strIsMultiLine,strIsUpperCase,strNoConsecutiveEmptyLines,strNoConsecutiveWhitespace,strParseBoolean,strPrependLines,strRemoveDuplicateChars,strRemoveEmptyLines,strRemoveFirstAndLastLine,strRemoveNewLines,strRepeat,strReplaceAll,strSortChars,strSplitAndTrim,strSplitCamelCase,strToCharCodes,strToCharSet,strToSentences,strToSortedCharSet,strToWords,strTrimLines,strTrimLinesLeft,strTrimLinesRight,strUnwrap,strWrapBetween,strWrapIn,strWrapInAngleBrackets,strWrapInBraces,strWrapInBrackets,strWrapInDoubleQuotes,strWrapInParenthesis,strWrapInSingleQuotes,streamToString,ee as tableFrom,timeArrayToInt,timeArrayToIntUnsafe,timeArrayToString,timeArrayToStringUnsafe,timeIntToArray,timeIntToArrayUnsafe,timeIntToString,timeIntToStringUnsafe,timeStringToArray,timeStringToArrayUnsafe,timeStringToInt,timeStringToIntUnsafe,toJson,trimArrayBytesLeft,trimArrayBytesRight,tsCountExports,tsCountLinesOfCode,tsDocExtractAllComments,tsDocExtractFirstComment,tsDocFixSpacingBeforeAfter,tsDocNormalizeTagName,tsDocRemoveEmptyLines,tsDocStripAllTagsButThrowsParamDescription,tsDocStripExample,tsDocStripTypesAndDefaults,tsDocUnwrapComment,tsDocWrapAsComment,tsDocWrapExample,tsExtractImports,tsExtractJestTests,tsGetClassMemberAccessModifiers,tsHasDefaultExport,tsJestConvertExportNameString,tsJestEnsureLineSpacing,tsSimpleMinifyCode,tsStripBlockComments,tsStripComments,tsStripDeclSourceMapComments,tsStripExportKeyword,tsStripImports,tsStripInlineComments,unzipFile,unzipMergeFiles,wait,waitSeconds,walkDirectory,walkDirectoryEmitter,walkDirectorySync,weeksSinceDate,wipeDirectorySafe,writeExcelFile,writeJsonFile,writeJsonFileSync,yearsSinceDate};