/*!
 * @bemoje/node-util v0.0.1
 * (c) Benjamin MÃ¸ller Jensen
 * Homepage: https://github.com/bemoje/bemoje-node-util
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("timsort"),require("path"),require("fs"),require("format-number"),require("stream")):"function"==typeof define&&define.amd?define(["exports","timsort","path","fs","format-number","stream"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).util={},t.timsort,t.Path,t.fs,t.numberFormat,t.stream)}(this,(function(t,e,r,n,o,s){"use strict";function _interopDefaultLegacy(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=_interopDefaultLegacy(r),a=_interopDefaultLegacy(n),l=_interopDefaultLegacy(o);function arr2dToCSV(t,e=";"){return t.map((t=>t.join(e))).join("\n")}function arrAssignFrom(t,e){t.splice(e.length);for(let r=0;r<e.length;r++)t[r]=e[r];return t}function arrEvery(t,e){for(let r=0,n=t.length;r<n;r++)if(!1===e(t[r],r,t))return!1;return!0}function arrFlatten(t,e=Number.MAX_SAFE_INTEGER){const r=[];return function recurse(n=t,o=0){for(let t=0;t<n.length;t++)Array.isArray(n[t])&&o<e?recurse(n[t],o+1):r.push(n[t])}(),r}function arrMapMutable(t,e){for(let r=0;r<t.length;r++)t[r]=e(t[r],r,t);return t}function arrShallowEquals(t,e){return t.length===e.length&&arrEvery(t,((t,r)=>t===e[r]))}function arrSwap(t,e,r){return[t[e],t[r]]=[t[r],t[e]],t}function compareNumber(t,e){return t-e}function compareNumeric(t,e){return t<e?-1:t>e?1:0}function compareString(t,e){return t.localeCompare(e)}class Matrix{static fromArray(t){const e=t[0].length,r=new this(t.length,e);for(let n=0;n<t.length;n++){if(t[n].length!==e)throw new Error("All rows must have the same length.");for(let o=0;o<e;o++)r.matrix[n][o]=t[n][o]}return r}static fromIterable(t){const e=[];for(const r of t)e.push([...r]);return this.fromArray(e)}static identity(t){const e=new Matrix(t,t);for(let r=0;r<t;r++)e.matrix[r][r]=1;return e}constructor(t,e){if(this.immutable=!1,t<1)throw new Error("Expected rows to be greater than zero.");if(e<1)throw new Error("Expected cols to be greater than zero.");this.matrix=new Array(t);for(let r=0;r<t;r++)this.matrix[r]=new Array(e).fill(0)}get rows(){return this.matrix.length}get cols(){return this.matrix[0].length}isSameInstanceAs(t){return this===t}getImmutable(){return this.immutable}setImmutable(t){return this.immutable=t,this}deepEquals(t){const e=t instanceof Matrix?t.matrix:t;for(let t=0;t<this.rows;t++)for(let r=0;r<this.cols;r++)if(this.matrix[t][r]!==e[t][r])return!1;return!0}set(t,e,r){const n=this.immutable?this.clone():this;return n.matrix[t][e]=r,n}get(t,e){return this.matrix[t][e]}has(t,e){return t<this.rows&&e<this.cols&&t>=0&&e>=0}toArray(){const t=new Array(this.rows);for(let e=0;e<this.rows;e++)t[e]=this.matrix[e].slice();return t}clone(){const t=new Matrix(this.rows,this.cols);for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)t.matrix[e][r]=this.matrix[e][r];return t}forEach(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(!1===t(this.matrix[e][r],e,r))return this;return this}forEachInRow(t,e){for(let r=0;r<this.cols;r++)if(!1===e(this.matrix[t][r],r))return this;return this}forEachInCol(t,e){for(let r=0;r<this.rows;r++)if(!1===e(this.matrix[r][t],r))return this;return this}forEachInDiagonal(t){for(let e=0;e<Math.min(this.rows,this.cols);e++)if(!1===t(this.matrix[e][e],e,e))return this;return this}map(t){const e=this.immutable?this.clone():this;for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e.matrix[r][n]=t(this.matrix[r][n],r,n);return e}*[Symbol.iterator](){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)yield this.matrix[t][e]}*values(){yield*this}mapRow(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.cols;n++)r.matrix[t][n]=e(this.matrix[t][n],n);return r}mapCol(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.rows;n++)r.matrix[n][t]=e(this.matrix[n][t],n);return r}appendRow(t){const e=this.immutable?this.clone():this;if(t){if(t.length!==this.cols)throw new Error("Row must have length "+this.cols)}else t=new Array(this.cols).fill(0);return e.matrix.push(t),e}appendCol(t){const e=this.immutable?this.clone():this;if(t){if(t.length!==this.rows)throw new Error("Col must have length "+this.rows)}else t=new Array(this.rows).fill(0);for(let r=0;r<this.rows;r++)e.matrix[r].push(t[r]);return e}addBy(t){return(this.immutable?this.clone():this).map((e=>e+t))}subtractBy(t){return(this.immutable?this.clone():this).map((e=>e-t))}multiplyBy(t){return(this.immutable?this.clone():this).map((e=>e*t))}divideBy(t){return(this.immutable?this.clone():this).map((e=>e/t))}addRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t+e))}subtractRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t-e))}multiplyRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t*e))}divideRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t/e))}addColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t+e))}subtractColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t-e))}multiplyColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t*e))}divideColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t/e))}swapRows(t,e){const r=this.immutable?this.clone():this,n=r.matrix[t],o=r.matrix[e];return r.matrix[t]=o,r.matrix[e]=n,r}swapCols(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.rows;n++){const o=r.matrix[n][t],s=r.matrix[n][e];r.matrix[n][t]=s,r.matrix[n][e]=o}return r}some(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(t(this.matrix[e][r],e,r))return!0;return!1}every(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(!t(this.matrix[e][r],e,r))return!1;return!0}hasDimensions(t,e){return this.rows===t&&this.cols===e}isSquareMatrix(){return this.rows===this.cols}isScalarMatrix(){if(!this.isSquareMatrix())return!1;const t=this.matrix[0][0];for(let e=1;e<this.rows;e++)if(this.matrix[e][e]!==t)return!1;return!0}isZeroMatrix(){return this.every((t=>0===t))}dotProduct(t){if(this.cols!==t.rows)throw new Error("A*B dot product not possible unless the number of columns in A and number of rows in B are the same.");const e=this.rows,r=t.cols,n=this.cols,o=new Matrix(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)o.matrix[s][e]+=this.matrix[s][r]*t.matrix[r][e];return o}}function isPrototype(t){return!!isObject(t)&&("constructor"in t&&t.constructor.prototype===t)}function isObject(t){return null!==t&&"object"==typeof t}function isConstructor(t){return"function"==typeof t&&"prototype"in t&&isPrototype(t.prototype)&&t===t.prototype.constructor}function setNonEnumerablePrivateProperties(t){!function setNonEnumerable(t,...e){for(const r of e)Object.defineProperty(t,r,{enumerable:!1})}(t,...Object.keys(t).filter((t=>"_"===t.charAt(0))))}const u=new WeakSet;class Base{constructor(){this.onFirstInstance()}onFirstInstance(){u.has(this.constructor)||(u.add(this.constructor),this.assertInterfaceStaticMembers("IRevivableJSON",["toJSON"],["fromJSON"]))}assertInterfaceStaticMembers(t,e,r){const n=new Set;for(const t of function*iteratePrototypeChain(t){if(null==t)return;isPrototype(t)||isConstructor(t)||t===Function.prototype||(yield t,t=t.constructor.prototype);let e=t;for(;e;)yield e,e=Reflect.getPrototypeOf(e)}(this))if(t!==Object.prototype)for(const r of e)Object.hasOwn(t,r)&&n.add(r);if(n.size===e.length)for(const e of r)if(!Object.hasOwn(this.constructor,e))throw new Error(`Interface ${t} requires class ${this.constructor.name} to implement static member: ${e}`)}setNonEnumerablePrivateProperties(){setNonEnumerablePrivateProperties(this)}assertNoAmbiguousOptions(t,e){for(const[r,n]of e)if(void 0!==t[r]&&void 0!==t[n])throw new Error(`Cannot use the '${r}' option and the '${n}' option simultanously.`)}assertNoOptionsRequireMissingOptions(t,e){for(const[r,n]of e)if(void 0!==t[r]&&void 0===t[n])throw new Error(`Cannot use the '${r}' option without the '${n}' option.`)}}function*rexec(t,e){let r;for(;null!==(r=t.exec(e));)yield{index:r.index,match:r[0],groups:Object.assign({},r.groups),lastIndex:t.lastIndex}}function regexEscapeString(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const c=new Map;function letterToCol(t,e=!1){t=t.toUpperCase();const r=c.get(t);if(r)return r;let n=0;const o=t.length;for(let e=0;e<o;e++)n+=(t.charCodeAt(e)-64)*Math.pow(26,o-e-1);return n-(e?1:0)}const h=/^(?<a>[A-Z]+)(?<n>[1-9]+)$/g;function A1ToColRow(t,e=!1){t=t.toUpperCase();const r=[...rexec(h,t)];if(!r.length)throw new Error(`Invalid A1 string: ${t}`);const n=e?1:0;return[letterToCol(r[0].groups.a)-n,parseInt(r[0].groups.n)-n]}const m=new Map;class Table extends Base{static fromCSV(t,e=";",r={}){return r.data=t.split("\n").filter((t=>t.length)).map((t=>t.trim().split(e))),new Table(r)}static fromJSON(t){return new Table(JSON.parse(t))}constructor(t={}){super(),this._data=[],this.validateOptions(t),this.handleOptions(t),this.validateData(),this.setNonEnumerablePrivateProperties()}get columns(){return this._data[0].length}get rows(){return this._data.length}get columnHeaders(){if(!this._columnHeaders)throw new Error("No column headers are defined for this table.");return this._columnHeaders?this._columnHeaders.slice():[]}get rowHeaders(){if(!this._rowHeaders)throw new Error("No row headers are defined for this table.");return this._rowHeaders?this._rowHeaders.slice():[]}get(t,e,r=!1){return[t,e]=this.normalizeColRow(t,e,r),this._data[e][t]}set(t,e,r,n=!1){return[t,e]=this.normalizeColRow(t,e,n),this._data[e][t]=r,this}removeColumn(t,e=!1){return t=this.normalizeCol(t,e),arrMapMutable(this._data,(e=>(e.splice(t,1),e))),this._columnHeaders&&this._columnHeaders.splice(t+(this._rowHeaders?1:0),1),this}removeRow(t,e=!1){return t=this.normalizeRow(t,e),this._data.splice(t,1),this._rowHeaders&&this._rowHeaders.splice(t,1),this}indexOfColumnHeader(t){if(!this._columnHeaders)throw new Error("No column headers are defined for this table.");return this._columnHeaders.indexOf(t)-(this._rowHeaders?1:0)}indexOfRowHeader(t){if(!this._rowHeaders)throw new Error("No row headers are defined for this table.");return this._rowHeaders.indexOf(t)}toArray(){const t=[];this._columnHeaders&&t.push(this.columnHeaders);for(let e=0;e<this.rows;e++){const r=this._data[e].slice();this._rowHeaders&&r.unshift(this._rowHeaders[e]),t.push(r)}return t}toArrayDataOnly(){const t=[];for(let e=0;e<this.rows;e++)t.push(this._data[e].slice());return t}toCSV(t=";"){return arr2dToCSV(this.toArray(),t)}toJSON(){return{columnHeaders:this._columnHeaders||[],rowHeaders:this._rowHeaders||[],data:this._data}}validateOptions(t){this.assertNoAmbiguousOptions(t,[["extractColumnHeaders","columnHeaders"],["extractRowHeaders","rowHeaders"],["columns","data"],["rows","data"],["columns","columnHeaders"],["rows","rowHeaders"]]),this.assertNoOptionsRequireMissingOptions(t,[["extractColumnHeaders","data"],["extractRowHeaders","data"]])}handleOptions(t){if((t=Object.assign({},t)).extractColumnHeaders&&t.data&&(t.data=t.data.slice(),t.columnHeaders=t.data.splice(0,1)[0].map((t=>t+""))),t.extractRowHeaders&&t.data){t.data=t.data.map((t=>t.slice())),t.rowHeaders=[];for(let e=0;e<t.data.length;e++)t.rowHeaders.push(t.data[e].splice(0,1)[0]+"")}if(t.rowHeaders?(this._rowHeaders=t.rowHeaders.slice(),t.rows=t.rowHeaders.length):void 0===t.rows?t.rows=1:this.validateRowMin(t.rows),t.columnHeaders?(this._columnHeaders=t.columnHeaders.slice(),t.columns=t.columnHeaders.length-(t.rowHeaders?1:0)):void 0===t.columns?t.columns=1:this.validateColMin(t.columns),t.data)for(let e=0;e<t.data.length;e++)this._data.push(t.data[e].slice());else this.buildEmptyTableWithDimensions(t.rows,t.columns)}validateData(){if(this._columnHeaders){const t=this._columnHeaders.length-(this._rowHeaders?1:0);if(!arrEvery(this._data.map((t=>t.length)),(e=>e===t)))throw new Error("Expected all rows to be of same length.")}if(this._rowHeaders&&this._rowHeaders.length!==this._data.length)throw new Error("Expected a row header for each row.")}buildEmptyTableWithDimensions(t,e){for(let r=0;r<t;r++)this._data.push(new Array(e))}validateRowMin(t){if(t<1)throw new Error("Expected rows to be integer larger than 0 but got: "+t);if(!Number.isInteger(t))throw new Error("Expected rows to be integer an integer.")}validateColMin(t){if(t<1)throw new Error("Expected columns to be integer larger than 0 but got: "+t);if(!Number.isInteger(t))throw new Error("Expected columns to be integer an integer.")}ensureValidRowIndex(t){if("string"==typeof t){if(!this._rowHeaders)throw new Error("Cannot pass row as string when no rowHeaders are defined.");if(-1===(t=this._rowHeaders.indexOf(t)))throw new Error("Row not found in rowHeaders.")}else this.validateRowMin(t+1);return t}ensureValidColIndex(t){if("string"==typeof t){if(!this._columnHeaders)throw new Error("Cannot pass col as string when no columnHeaders are defined.");if((t=this._columnHeaders.indexOf(t)-(this._rowHeaders?1:0))<0)throw new Error("Col not found in columnHeaders.")}else this.validateColMin(t+1);return t}normalizeCol(t,e){return e&&(t=letterToCol(String(t),!0)),this.ensureValidColIndex(t)}normalizeRow(t,e){return e&&(t=Number(t)),this.ensureValidRowIndex(t)}normalizeColRow(t,e,r){return r&&([t,e]=A1ToColRow(String(t)+String(e),!0)),[this.ensureValidColIndex(t),this.ensureValidRowIndex(e)]}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
function __awaiter(t,e,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))}function __values(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=__values(t),e={},verb("next"),verb("throw"),verb("return"),e[Symbol.asyncIterator]=function(){return this},e);function verb(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function settle(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}}const f=new Map,d=new Map;function numFormatEU(t,e=0){let r=f.get(e);return r||(r=l.default({truncate:e,padRight:e,integerSeparator:".",decimal:","}),f.set(e,r)),r(t)}function numFormatUS(t,e=0){let r=d.get(e);return r||(r=l.default({truncate:e,padRight:e,integerSeparator:",",decimal:"."}),d.set(e,r)),r(t)}const p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function strIsLowerCase(t){return t===t.toLowerCase()}function strIsUpperCase(t){return t===t.toUpperCase()}const w=/\d((\.|\d)*)?/g,g=/\b[^\W]+/g;function strCountCharOccurances(t,e){if(1!==e.length)throw new Error("Expected char to be a single character string of length 1.");let r=0;for(const n of t)n===e&&r++;return r}function strRepeat(t,e){return new Array(e).fill(t).join("")}function strLinesTrimRight(t){return t.replace(/\s+\n/gm,"\n")}function strLinesRemoveEmpty(t){return t.replace(/\n\r?\s*\n\r?/gm,"\n").trimStart().trimEnd()}const toIntMB=t=>Math.floor(1e-6*t),getMemoryUsageFormatted=t=>{const e=process.memoryUsage();return{processAllocationMB:t(e.rss),heapAllocationMB:t(e.heapTotal),heapUsedMB:t(e.heapUsed),extenalV8:t(e.external)}};function normalizeFileExtension(t){if(""===t||"."===t)return"";if(/[<>"|?*:]/g.test(t))throw new Error(`Illegal characters in file extension: ${t}  |  Illegal characters are: <>"|?:*`);return 0===strCountCharOccurances(t,".")?"."+t:t.substring(t.lastIndexOf("."))}class StringStream extends s.Readable{constructor(t){super(),this.str=t,this.ended=!1}_read(){this.ended||(process.nextTick((()=>{this.push(Buffer.from(this.str)),this.push(null)})),this.ended=!0)}}t.A1ToColRow=A1ToColRow,t.Base=Base,t.ExtensibleFunction=class ExtensibleFunction extends Function{constructor(t,e){return Object.defineProperty(e,"name",{value:t}),super(e),Object.setPrototypeOf(e,new.target.prototype)}},t.Matrix=Matrix,t.SortedArray=class SortedArray extends Array{constructor(t={}){if(super(),this.compare=compareString,this.compareFound=!1,this.allowDuplicates=!0,Object.defineProperty(this,"compare",{enumerable:!1}),Object.defineProperty(this,"compareFound",{enumerable:!1}),Object.defineProperty(this,"allowDuplicates",{enumerable:!1}),t.compare&&(this.compare=t.compare,this.compareFound=!0),t.data){for(const e of t.data)this.push(e);!this.compareFound&&this.length&&"string"!=typeof this[0]&&(this.compare=compareNumeric,this.compareFound=!0),e.sort(this,this.compare)}!1===t.allowDuplicates&&(this.allowDuplicates=!1,this.unique())}toArray(){return Array.from(this)}add(t){if(this.compareFound||"string"!=typeof t&&(this.compare=compareNumeric,this.compareFound=!0),0===this.length)return this.push(t),this;const[e,r]=this.insertionIndex(t);return r&&!this.allowDuplicates||this.splice(e,0,t),this}addMany(...t){if(0===t.length)return this;for(const e of t)this.add(e);return this}unique(){let t=this.length;if(t<=1)return this;for(let e,r,n=1;n<t;n++)e=this[n-1],r=this[n],0===this.compare(e,r)&&(this.splice(n,1),t--,n--);return this}insertionIndex(t){if(0===this.length)return[0,!1];let e=0,r=this.length;for(;e<r;){const n=e+r>>>1,o=this.compare(this[n],t);if(0===o)return[n,!0];o<0?e=n+1:r=n}return[e,!1]}firstInsertionIndex(t){const[e,r]=this.insertionIndex(t);if(!r)return[e,r];let n=e-1;for(;n>=0;){if(0!==this.compare(this[n],t))return[n+1,r];n--}return[0,r]}lastInsertionIndex(t){const[e,r]=this.insertionIndex(t);if(!r)return[e,r];let n=e+1;for(;n<this.length;){if(0!==this.compare(this[n],t))return[n,r];n++}return[this.length,r]}indexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.insertionIndex(t);return r?e:-1}firstIndexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.firstInsertionIndex(t);return r?e:-1}lastIndexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.lastInsertionIndex(t);return r?e-1:-1}indicesOfCompare(t){const e=this.indexOfCompare(t);if(-1===e)return[];const r=[];if(!this.allowDuplicates)return r;let n=e-1;for(;n>=0&&0===this.compare(this[n],t);)r.push(n),n--;for(r.push(e),n=e+1;n<this.length&&0===this.compare(this[n],t);)r.push(n),n++;return r.sort(compareNumber),r}intersection(t){const e=[];let r=0,n=0;for(;r<this.length&&n<t.length;)this.compare(this[r],t[n])<0?r++:0===this.compare(this[r],t[n])?(e.push(this[r]),r++,n++):n++;return e}},t.StringStream=StringStream,t.Table=Table,t.Timer=class Timer{constructor(){this.t0=Date.now()}stop(){return Date.now()-this.t0}},t.alphaToCol=letterToCol,t.arr2dToCSV=arr2dToCSV,t.arrAssignFrom=arrAssignFrom,t.arrEvery=arrEvery,t.arrFilterMutable=function arrFilterMutable(t,e){return arrAssignFrom(t,t.filter(e))},t.arrFlatten=arrFlatten,t.arrFlattenMutable=function arrFlattenMutable(t,e=Number.MAX_SAFE_INTEGER){return arrAssignFrom(t,arrFlatten(t,e))},t.arrIndicesOf=function arrIndicesOf(t,e){const r=[];for(let n=0;n<t.length;n++)e===t[n]&&r.push(n);return r},t.arrMapMutable=arrMapMutable,t.arrShallowEquals=arrShallowEquals,t.arrShuffle=function arrShuffle(t){const e=t.slice();let r=!0;for(;r;){for(let e=0,r=t.length;e<r;e++){arrSwap(t,e,Math.floor(Math.random()*r))}r=arrShallowEquals(t,e)}return t},t.arrSome=function arrSome(t,e){for(let r=0,n=t.length;r<n;r++)if(!0===e(t[r],r,t))return!0;return!1},t.arrSortNumeric=function arrSortNumeric(t){return t.sort(compareNumeric)},t.arrSwap=arrSwap,t.colRowToA1=function colRowToA1(t,e=!1){if(2!==t.length)throw new Error(`Expected CR to to be length 2. Got: ${t.length}`);if(!Number.isInteger(t[1]))throw new Error(`Expected row to be an integer. Got: ${t[1]}`);if(t[1]<1)throw new Error(`Expected row to be greater than zero. Got: ${t[1]}`);return function colToLetter(t,e=!1){e&&t++;const r=m.get(t);if(r)return r;if(!Number.isInteger(t))throw new Error(`Expected col to be an integer. Got: ${t}`);if(t<1)throw new Error(`Expected col to be greater than zero. Got: ${t}`);let n,o="";for(;t>0;)n=(t-1)%26,o=String.fromCharCode(n+65)+o,t=(t-n-1)/26;return o}(t[0],e)+t[1].toString()},t.compareArray=function compareArray(t,e=!1){const r=e?-1:1;function recursiveCompare(e,n,o){const s=Array.isArray(e),i=Array.isArray(n);if(!s){if(i)return-1*r;{const r=t(e,n);return 0===r&&o||r}}if(!i)return 1*r;{const t=e.length,o=n.length;let s,i;t>o?(s=t,i=1*r):t<o?(s=o,i=-1*r):(s=t,i=0);for(let t=0,r=s;t<r;t++){const r=recursiveCompare(e[t],n[t],i);if(0!==r)return r}}return 0}return(t,e)=>recursiveCompare(t,e)},t.compareNumber=compareNumber,t.compareNumberDescending=function compareNumberDescending(t,e){return e-t},t.compareNumeric=compareNumeric,t.compareNumericDescending=function compareNumericDescending(t,e){return t>e?-1:t<e?1:0},t.compareString=compareString,t.compareStringDescending=function compareStringDescending(t,e){return e.localeCompare(t)},t.createFileExtensionFilter=function createFileExtensionFilter(...t){return t.length?e=>{for(const r of t.map(normalizeFileExtension))if(i.default.extname(e)===r)return!0;return!1}:()=>!0},t.ensureValidWindowsPath=function ensureValidWindowsPath(t,e){const throwOrFalse=r=>{if(e&&!0===e.assert)throw new Error(`Invalid windows path. ${r}  |  input received: ${t}`);return!1};if(0===t.length)return throwOrFalse("Path string is length 0.");if(strCountCharOccurances(t,"/")>0&&strCountCharOccurances(t,"\\")>0)return throwOrFalse("Path contains both backslash and forward slash.");const r=(e&&e.extendedMaxLength?32767:260)-12;if(t.length>r)return throwOrFalse(`Maximum length of ${r} exceeded`);let n=t;return/^\w:(\\|\/)/g.test(t)&&(n=t.substring(2)),/[<>"|?*:]/g.test(n)?throwOrFalse(`Illegal characters in: ${t}  |  Illegal characters are: <>"|?:*`):!/(\\|\/)(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])((\\|\/)|$)/g.test(t)||throwOrFalse("Illegal name in path string")},t.getMemoryUsage=function getMemoryUsage(){const t=process.memoryUsage();return{processAllocationMB:toIntMB(t.rss),heapAllocationMB:toIntMB(t.heapTotal),heapUsedMB:toIntMB(t.heapUsed),extenalV8:toIntMB(t.external)}},t.getMemoryUsageFormattedEU=function getMemoryUsageFormattedEU(){return getMemoryUsageFormatted((t=>`${numFormatEU(1e-6*t,2)} MB`))},t.getMemoryUsageFormattedUS=function getMemoryUsageFormattedUS(){return getMemoryUsageFormatted((t=>`${numFormatUS(1e-6*t,2)} MB`))},t.getWorkingDirPath=function getWorkingDirPath(...t){return i.default.join(process.cwd(),...t)},t.htmlTableTo2dArray=function htmlTableTo2dArray(t,e=!0){const r=[],n=t.querySelectorAll("tr");for(let t=0;t<n.length;t++){const o=n[t],s=[],i=o.querySelectorAll(e?"th,td":"td");for(let t=0;t<i.length;t++){const e=i[t];s.push(e.innerText.trim())}!e&&o.querySelectorAll("th").length||s.length&&r.push(s)}return r},t.isConstructor=isConstructor,t.isObject=isObject,t.isPrototype=isPrototype,t.normalizeFileExtension=normalizeFileExtension,t.numApproximateLog10=function numApproximateLog10(t){return t<p[5]?t<p[2]?t<p[1]?0:1:t<p[4]?t<p[3]?2:3:4:t<p[7]?t<p[6]?5:6:t<p[9]?t<p[8]?7:8:9},t.numFormatEU=numFormatEU,t.numFormatUS=numFormatUS,t.readFileStringSync=function readFileStringSync(t){return a.default.readFileSync(t,"utf8").toString()},t.regexEscapeString=regexEscapeString,t.regexGetGroupNames=function regexGetGroupNames(t){const e=[];for(const r of rexec(/\(\?<(?<name>\w+)>/g,t.toString()))e.push(r.groups.name);return e},t.rexec=rexec,t.setIntersection=function setIntersection(t){const e=new Set(t[0].values());for(let r=1;r<t.length;r++)for(const n of e.values())t[r].has(n)||e.delete(n);return e},t.setUnion=function setUnion(t){const e=new Set(t[0].values());for(let r=1;r<t.length;r++)for(const n of t[r].values())e.add(n);return e},t.strCountCharOccurances=strCountCharOccurances,t.strIsLowerCase=strIsLowerCase,t.strIsUpperCase=strIsUpperCase,t.strLinesRemoveEmpty=strLinesRemoveEmpty,t.strLinesTrimLeft=function strLinesTrimLeft(t){return t.replace(/\n\r?\s+/gm,"\n")},t.strLinesTrimRight=strLinesTrimRight,t.strPrettifyMinifiedCode=function strPrettifyMinifiedCode(t,e="  "){const getIndents=t=>strRepeat("\t",t);let r=0;return strLinesTrimRight(strLinesRemoveEmpty(Array.from(t).map((t=>"{"===t?(r++,"{\n"+getIndents(r)):"}"===t?(r--,"\n"+getIndents(r)+"}\n"+getIndents(r)):";"===t?";\n"+getIndents(r):t)).join(""))).replace(/\t +/g,"\t").replace(/\t/g,e)},t.strRepeat=strRepeat,t.strReplaceAll=function strReplaceAll(t,e,r,n="g"){return t.replace(new RegExp(regexEscapeString(e),n),r)},t.strSplitWordByCamelCase=function strSplitWordByCamelCase(t){function isCamelCaseWordBreakIndex(t,e){return strIsLowerCase(t[e-1])&&strIsUpperCase(t[e])&&!w.test(t[e-1])&&!w.test(t[e])}const e=[],r=t.length-1;let n=0,o=!1;for(let s=1;s<t.length;s++)if(o&&s===r){const r=t.substring(n);r&&e.push(r)}else if(isCamelCaseWordBreakIndex(t,s)){const r=t.substring(n,s);if(!r)continue;e.push(r),n=s,o=!0}return o||e.push(t),e},t.strToWords=function strToWords(t){return t.match(g)||[]},t.strWrapBetween=function strWrapBetween(t,e,r){return e+t+r},t.strWrapIn=function strWrapIn(t,e){return e+t+e},t.strWrapInAngleBrackets=function strWrapInAngleBrackets(t){return"<"+t+">"},t.strWrapInBraces=function strWrapInBraces(t){return"{"+t+"}"},t.strWrapInBrackets=function strWrapInBrackets(t){return"["+t+"]"},t.strWrapInDoubleQuotes=function strWrapInDoubleQuotes(t){return'"'+t+'"'},t.strWrapInParenthesis=function strWrapInParenthesis(t){return"("+t+")"},t.strWrapInSingleQuotes=function strWrapInSingleQuotes(t){return"'"+t+"'"},t.streamToString=function streamToString(t){var e,r,n,o,s,i,a;return __awaiter(this,void 0,void 0,(function*(){const l=[];try{for(e=!0,r=__asyncValues(t);n=yield r.next(),!(o=n.done);){a=n.value,e=!1;try{const t=a;l.push(Buffer.from(t).toString())}finally{e=!0}}}catch(t){s={error:t}}finally{try{e||o||!(i=r.return)||(yield i.call(r))}finally{if(s)throw s.error}}return l.join("")}))},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
