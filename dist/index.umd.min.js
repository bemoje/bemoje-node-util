/*!
 * @bemoje/node-util v0.0.1
 * (c) Benjamin MÃ¸ller Jensen
 * Homepage: https://github.com/bemoje/bemoje-node-util
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("timsort"),require("format-number"),require("path"),require("fs"),require("stream")):"function"==typeof define&&define.amd?define(["exports","timsort","format-number","path","fs","stream"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).util={},t.timsort,t.numberFormat,t.Path,t.fs,t.stream)}(this,(function(t,e,r,n,o,s){"use strict";function _interopDefaultLegacy(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=_interopDefaultLegacy(r),a=_interopDefaultLegacy(n),l=_interopDefaultLegacy(o);function arr2dToCSV(t,e=";"){return t.map((t=>t.join(e))).join("\n")}function arrAssignFrom(t,e){t.splice(e.length);for(let r=0;r<e.length;r++)t[r]=e[r];return t}function arrEvery(t,e){for(let r=0,n=t.length;r<n;r++)if(!1===e(t[r],r,t))return!1;return!0}function arrFlatten(t,e=Number.MAX_SAFE_INTEGER){const r=[];return function recurse(n=t,o=0){for(let t=0;t<n.length;t++)Array.isArray(n[t])&&o<e?recurse(n[t],o+1):r.push(n[t])}(),r}function arrMapMutable(t,e){for(let r=0;r<t.length;r++)t[r]=e(t[r],r,t);return t}function arrShallowEquals(t,e){return t.length===e.length&&arrEvery(t,((t,r)=>t===e[r]))}function arrSwap(t,e,r){return[t[e],t[r]]=[t[r],t[e]],t}function compareNumber(t,e){return t-e}function compareNumeric(t,e){return t<e?-1:t>e?1:0}function compareString(t,e){return t.localeCompare(e)}class Matrix{static fromArray(t){const e=t[0].length,r=new this(t.length,e);for(let n=0;n<t.length;n++){if(t[n].length!==e)throw new Error("All rows must have the same length.");for(let o=0;o<e;o++)r.matrix[n][o]=t[n][o]}return r}static fromIterable(t){const e=[];for(const r of t)e.push([...r]);return this.fromArray(e)}static identity(t){const e=new Matrix(t,t);for(let r=0;r<t;r++)e.matrix[r][r]=1;return e}constructor(t,e){if(this.immutable=!1,t<1)throw new Error("Expected rows to be greater than zero.");if(e<1)throw new Error("Expected cols to be greater than zero.");this.matrix=new Array(t);for(let r=0;r<t;r++)this.matrix[r]=new Array(e).fill(0)}get rows(){return this.matrix.length}get cols(){return this.matrix[0].length}isSameInstanceAs(t){return this===t}getImmutable(){return this.immutable}setImmutable(t){return this.immutable=t,this}deepEquals(t){const e=t instanceof Matrix?t.matrix:t;for(let t=0;t<this.rows;t++)for(let r=0;r<this.cols;r++)if(this.matrix[t][r]!==e[t][r])return!1;return!0}set(t,e,r){const n=this.immutable?this.clone():this;return n.matrix[t][e]=r,n}get(t,e){return this.matrix[t][e]}has(t,e){return t<this.rows&&e<this.cols&&t>=0&&e>=0}toArray(){const t=new Array(this.rows);for(let e=0;e<this.rows;e++)t[e]=this.matrix[e].slice();return t}clone(){const t=new Matrix(this.rows,this.cols);for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)t.matrix[e][r]=this.matrix[e][r];return t}forEach(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(!1===t(this.matrix[e][r],e,r))return this;return this}forEachInRow(t,e){for(let r=0;r<this.cols;r++)if(!1===e(this.matrix[t][r],r))return this;return this}forEachInCol(t,e){for(let r=0;r<this.rows;r++)if(!1===e(this.matrix[r][t],r))return this;return this}forEachInDiagonal(t){for(let e=0;e<Math.min(this.rows,this.cols);e++)if(!1===t(this.matrix[e][e],e,e))return this;return this}map(t){const e=this.immutable?this.clone():this;for(let r=0;r<this.rows;r++)for(let n=0;n<this.cols;n++)e.matrix[r][n]=t(this.matrix[r][n],r,n);return e}*[Symbol.iterator](){for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)yield this.matrix[t][e]}*values(){yield*this}mapRow(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.cols;n++)r.matrix[t][n]=e(this.matrix[t][n],n);return r}mapCol(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.rows;n++)r.matrix[n][t]=e(this.matrix[n][t],n);return r}appendRow(t){const e=this.immutable?this.clone():this;if(t){if(t.length!==this.cols)throw new Error("Row must have length "+this.cols)}else t=new Array(this.cols).fill(0);return e.matrix.push(t),e}appendCol(t){const e=this.immutable?this.clone():this;if(t){if(t.length!==this.rows)throw new Error("Col must have length "+this.rows)}else t=new Array(this.rows).fill(0);for(let r=0;r<this.rows;r++)e.matrix[r].push(t[r]);return e}addBy(t){return(this.immutable?this.clone():this).map((e=>e+t))}subtractBy(t){return(this.immutable?this.clone():this).map((e=>e-t))}multiplyBy(t){return(this.immutable?this.clone():this).map((e=>e*t))}divideBy(t){return(this.immutable?this.clone():this).map((e=>e/t))}addRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t+e))}subtractRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t-e))}multiplyRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t*e))}divideRowBy(t,e){return(this.immutable?this.clone():this).mapRow(t,(t=>t/e))}addColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t+e))}subtractColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t-e))}multiplyColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t*e))}divideColBy(t,e){return(this.immutable?this.clone():this).mapCol(t,(t=>t/e))}swapRows(t,e){const r=this.immutable?this.clone():this,n=r.matrix[t],o=r.matrix[e];return r.matrix[t]=o,r.matrix[e]=n,r}swapCols(t,e){const r=this.immutable?this.clone():this;for(let n=0;n<this.rows;n++){const o=r.matrix[n][t],s=r.matrix[n][e];r.matrix[n][t]=s,r.matrix[n][e]=o}return r}some(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(t(this.matrix[e][r],e,r))return!0;return!1}every(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.cols;r++)if(!t(this.matrix[e][r],e,r))return!1;return!0}hasDimensions(t,e){return this.rows===t&&this.cols===e}isSquareMatrix(){return this.rows===this.cols}isScalarMatrix(){if(!this.isSquareMatrix())return!1;const t=this.matrix[0][0];for(let e=1;e<this.rows;e++)if(this.matrix[e][e]!==t)return!1;return!0}isZeroMatrix(){return this.every((t=>0===t))}dotProduct(t){if(this.cols!==t.rows)throw new Error("A*B dot product not possible unless the number of columns in A and number of rows in B are the same.");const e=this.rows,r=t.cols,n=this.cols,o=new Matrix(e,r);for(let s=0;s<e;s++)for(let e=0;e<r;e++)for(let r=0;r<n;r++)o.matrix[s][e]+=this.matrix[s][r]*t.matrix[r][e];return o}}function isObject(t){return null!==t&&"object"==typeof t}function isPrototype(t){return!!isObject(t)&&("constructor"in t&&t.constructor.prototype===t)}function isConstructor(t){return"function"==typeof t&&"prototype"in t&&isPrototype(t.prototype)&&t===t.prototype.constructor}function setNonEnumerable(t,...e){for(const r of e)Object.defineProperty(t,r,{enumerable:!1})}function setNonEnumerablePrivateProperties(t){setNonEnumerable(t,...Object.keys(t).filter((t=>"_"===t.charAt(0))))}function*iteratePrototypeChain(t){if(null==t)return;isPrototype(t)||isConstructor(t)||t===Function.prototype||(yield t,t=t.constructor.prototype);let e=t;for(;e;)yield e,e=Reflect.getPrototypeOf(e)}const u=new Set;class Base{constructor(){this.onFirstInstance()}onFirstInstance(){u.has(this.constructor)||(u.add(this.constructor),this.assertInterfaceStaticMembers("IRevivableJSON",["toJSON"],["fromJSON"]))}assertInterfaceStaticMembers(t,e,r){const n=new Set;for(const t of iteratePrototypeChain(this))if(t!==Object.prototype)for(const r of e)Object.hasOwn(t,r)&&n.add(r);if(n.size===e.length)for(const e of r)if(!Object.hasOwn(this.constructor,e))throw new Error(`Interface ${t} requires class ${this.constructor.name} to implement static member: ${e}`)}setNonEnumerablePrivateProperties(){setNonEnumerablePrivateProperties(this)}assertNoAmbiguousOptions(t,e){for(const[r,n]of e)if(void 0!==t[r]&&void 0!==t[n])throw new Error(`Cannot use the '${r}' option and the '${n}' option simultanously.`)}assertNoOptionsRequireMissingOptions(t,e){for(const[r,n]of e)if(void 0!==t[r]&&void 0===t[n])throw new Error(`Cannot use the '${r}' option without the '${n}' option.`)}}function*rexec(t,e){let r;for(;null!==(r=t.exec(e));)yield{index:r.index,match:r[0],groups:Object.assign({},r.groups),lastIndex:t.lastIndex}}function regexEscapeString(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function regexMatcherToValidater(t){return new RegExp(`^${t.source}$`,t.flags.replace("g",""))}const c=new Map;function letterToCol(t,e=!1){t=t.toUpperCase();const r=c.get(t);if(r)return r;let n=0;const o=t.length;for(let e=0;e<o;e++)n+=(t.charCodeAt(e)-64)*Math.pow(26,o-e-1);return n-(e?1:0)}const h=/^(?<a>[A-Z]+)(?<n>[1-9]+)$/g;function A1ToColRow(t,e=!1){t=t.toUpperCase();const r=[...rexec(h,t)];if(!r.length)throw new Error(`Invalid A1 string: ${t}`);const n=e?1:0;return[letterToCol(r[0].groups.a)-n,parseInt(r[0].groups.n)-n]}const d=new Map;class Table extends Base{static fromCSV(t,e=";",r={}){return r.data=t.split("\n").filter((t=>t.length)).map((t=>t.trim().split(e))),new Table(r)}static fromJSON(t){return new Table(JSON.parse(t))}constructor(t={}){super(),this._data=[],this.validateOptions(t),this.handleOptions(t),this.validateData(),this.setNonEnumerablePrivateProperties()}get columns(){return this._data[0].length}get rows(){return this._data.length}get columnHeaders(){if(!this._columnHeaders)throw new Error("No column headers are defined for this table.");return this._columnHeaders?this._columnHeaders.slice():[]}get rowHeaders(){if(!this._rowHeaders)throw new Error("No row headers are defined for this table.");return this._rowHeaders?this._rowHeaders.slice():[]}get(t,e,r=!1){return[t,e]=this.normalizeColRow(t,e,r),this._data[e][t]}set(t,e,r,n=!1){return[t,e]=this.normalizeColRow(t,e,n),this._data[e][t]=r,this}removeColumn(t,e=!1){return t=this.normalizeCol(t,e),arrMapMutable(this._data,(e=>(e.splice(t,1),e))),this._columnHeaders&&this._columnHeaders.splice(t+(this._rowHeaders?1:0),1),this}removeRow(t,e=!1){return t=this.normalizeRow(t,e),this._data.splice(t,1),this._rowHeaders&&this._rowHeaders.splice(t,1),this}indexOfColumnHeader(t){if(!this._columnHeaders)throw new Error("No column headers are defined for this table.");return this._columnHeaders.indexOf(t)-(this._rowHeaders?1:0)}indexOfRowHeader(t){if(!this._rowHeaders)throw new Error("No row headers are defined for this table.");return this._rowHeaders.indexOf(t)}toArray(){const t=[];this._columnHeaders&&t.push(this.columnHeaders);for(let e=0;e<this.rows;e++){const r=this._data[e].slice();this._rowHeaders&&r.unshift(this._rowHeaders[e]),t.push(r)}return t}toArrayDataOnly(){const t=[];for(let e=0;e<this.rows;e++)t.push(this._data[e].slice());return t}toCSV(t=";"){return arr2dToCSV(this.toArray(),t)}toJSON(){return{columnHeaders:this._columnHeaders||[],rowHeaders:this._rowHeaders||[],data:this._data}}validateOptions(t){this.assertNoAmbiguousOptions(t,[["extractColumnHeaders","columnHeaders"],["extractRowHeaders","rowHeaders"],["columns","data"],["rows","data"],["columns","columnHeaders"],["rows","rowHeaders"]]),this.assertNoOptionsRequireMissingOptions(t,[["extractColumnHeaders","data"],["extractRowHeaders","data"]])}handleOptions(t){if((t=Object.assign({},t)).extractColumnHeaders&&t.data&&(t.data=t.data.slice(),t.columnHeaders=t.data.splice(0,1)[0].map((t=>t+""))),t.extractRowHeaders&&t.data){t.data=t.data.map((t=>t.slice())),t.rowHeaders=[];for(let e=0;e<t.data.length;e++)t.rowHeaders.push(t.data[e].splice(0,1)[0]+"")}if(t.rowHeaders?(this._rowHeaders=t.rowHeaders.slice(),t.rows=t.rowHeaders.length):void 0===t.rows?t.rows=1:this.validateRowMin(t.rows),t.columnHeaders?(this._columnHeaders=t.columnHeaders.slice(),t.columns=t.columnHeaders.length-(t.rowHeaders?1:0)):void 0===t.columns?t.columns=1:this.validateColMin(t.columns),t.data)for(let e=0;e<t.data.length;e++)this._data.push(t.data[e].slice());else this.buildEmptyTableWithDimensions(t.rows,t.columns)}validateData(){if(this._columnHeaders){const t=this._columnHeaders.length-(this._rowHeaders?1:0);if(!arrEvery(this._data.map((t=>t.length)),(e=>e===t)))throw new Error("Expected all rows to be of same length.")}if(this._rowHeaders&&this._rowHeaders.length!==this._data.length)throw new Error("Expected a row header for each row.")}buildEmptyTableWithDimensions(t,e){for(let r=0;r<t;r++)this._data.push(new Array(e))}validateRowMin(t){if(t<1)throw new Error("Expected rows to be integer larger than 0 but got: "+t);if(!Number.isInteger(t))throw new Error("Expected rows to be integer an integer.")}validateColMin(t){if(t<1)throw new Error("Expected columns to be integer larger than 0 but got: "+t);if(!Number.isInteger(t))throw new Error("Expected columns to be integer an integer.")}ensureValidRowIndex(t){if("string"==typeof t){if(!this._rowHeaders)throw new Error("Cannot pass row as string when no rowHeaders are defined.");if(-1===(t=this._rowHeaders.indexOf(t)))throw new Error("Row not found in rowHeaders.")}else this.validateRowMin(t+1);return t}ensureValidColIndex(t){if("string"==typeof t){if(!this._columnHeaders)throw new Error("Cannot pass col as string when no columnHeaders are defined.");if((t=this._columnHeaders.indexOf(t)-(this._rowHeaders?1:0))<0)throw new Error("Col not found in columnHeaders.")}else this.validateColMin(t+1);return t}normalizeCol(t,e){return e&&(t=letterToCol(String(t),!0)),this.ensureValidColIndex(t)}normalizeRow(t,e){return e&&(t=Number(t)),this.ensureValidRowIndex(t)}normalizeColRow(t,e,r){return r&&([t,e]=A1ToColRow(String(t)+String(e),!0)),[this.ensureValidColIndex(t),this.ensureValidRowIndex(e)]}}function isValidDateMonth(t){return Number.isInteger(t)&&t>=1&&t<=12}function assertValidDateMonth(t){if(!isValidDateMonth(t))throw new Error(`Invalid month: ${t}.`)}function isValidDateYear(t){return Number.isInteger(t)&&t>=0}function assertValidDateYear(t){if(!isValidDateYear(t))throw new Error(`Invalid year: ${t}.`)}function isLeapYear(t){return assertValidDateYear(t),0==t%4&&0!=t%100||0==t%400}const f=[0,31,28,31,30,31,30,31,31,30,31,30,31];function numDaysInMonth(t,e){return assertValidDateMonth(t),2===t&&void 0!==e&&isLeapYear(e)?29:f[t]}function isValidDateDay(t,e,r){return!!Number.isInteger(t)&&(!(t<1)&&!(t>numDaysInMonth(e,r)))}function assertValidDateDay(t,e,r){if(!isValidDateDay(t,e,r))throw new Error(`Invalid day of the month: ${t}.`)}function getCentury(t){return assertValidDateYear(t),Math.floor(t/100)+1}function getCurrentYear(){return(new Date).getUTCFullYear()}class Sudoku{constructor(t,e,r=!1){if(!r){if(9!==t.length)throw Error("Expected sudoku to be a 9x9 array of integers between 1 and 9.");for(const e of t){if(9!==e.length)throw Error("Expected sudoku to be a 9x9 array of integers between 1 and 9.");for(const t of e)if(void 0!==t&&(!Number.isInteger(t)||t<1||t>9))throw Error("Expected sudoku to be a 9x9 array of integers between 1 and 9.")}}this.sudoku=[];for(let e=0;e<=8;e++)this.sudoku[e]=t[e].slice();if(e)this.candidates=e.map((t=>t.map((t=>new Set(t)))));else{this.candidates=[];for(let t=0;t<=8;t++){this.candidates[t]=[];for(let e=0;e<=8;e++)void 0===this.sudoku[t][e]?this.candidates[t][e]=new Set([1,2,3,4,5,6,7,8,9]):this.candidates[t][e]=new Set([])}}this.isGuess=r}*itRow(t){for(let e=0;e<=8;e++)yield this.sudoku[t][e]}*itRows(){for(let t=0;t<=8;t++)yield this.itRow(t)}*itCol(t){for(let e=0;e<=8;e++)yield this.sudoku[e][t]}*itCols(){for(let t=0;t<=8;t++)yield this.itCol(t)}*itNonant(t,e){const r=t<3?0:t<6?3:6,n=e<3?0:e<6?3:6;for(let t=r;t<r+3;t++)for(let e=n;e<n+3;e++)yield this.sudoku[t][e]}*itNonants(){yield this.itNonant(0,0),yield this.itNonant(0,3),yield this.itNonant(0,6),yield this.itNonant(3,0),yield this.itNonant(3,3),yield this.itNonant(3,6),yield this.itNonant(6,0),yield this.itNonant(6,3),yield this.itNonant(6,6)}*itAllSeries(){yield*this.itRows(),yield*this.itCols(),yield*this.itNonants()}isCompleteSeries(t){const e=new Set;for(const r of t){if(void 0===r)return!1;if(e.has(r))return!1;e.add(r)}return!0}isCompleteSudoku(){for(const t of this.itAllSeries())if(!this.isCompleteSeries(t))return!1;return!0}solveAt(t,e){if(void 0!==this.sudoku[t][e])return!1;const r=this.candidates[t][e];for(let n=0;n<=8;n++){const o=this.sudoku[t][n];void 0!==o&&r.delete(o);const s=this.sudoku[n][e];void 0!==s&&r.delete(s)}for(const n of this.itNonant(t,e))void 0!==n&&r.delete(n);if(1===r.size){this.sudoku[t][e]=r.values().next().value;const n=this.sudoku[t][e];return void 0!==n&&r.delete(n),!0}return!1}solve(){let t=!1;const tryAll=()=>{for(let e=0;e<=8;e++)for(let r=0;r<=8;r++)this.solveAt(e,r)&&(t=!0)};if(tryAll(),tryAll(),t)return this.solve();if(this.isCompleteSudoku())return!0;for(let t=2;t<=9;t++)for(let e=0;e<=8;e++)for(let r=0;r<=8;r++)if(this.candidates[e][r].size===t){const t=this.candidates[e][r].values().next().value;this.candidates[e][r].delete(t);const n=new Sudoku(this.sudoku,this.candidates,!0);n.sudoku[e][r]=t,n.candidates[e][r]=new Set;return n.solve()&&(this.sudoku=n.sudoku,this.candidates=n.candidates),this.solve()}if(!this.isGuess)throw this.print(),Error("Sudoku is invalid and cannot be solved.");return!1}print(){console.log("-------------------");for(let t=0;t<=8;t++)console.log("|"+this.sudoku[t].map((t=>void 0===t?" ":t)).join("|")+"|");console.log("-------------------")}}function isEven(t){if(!Number.isInteger(t))throw new Error(`Expected integer. Got ${t}`);return t%2==0}const m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];const p=new Map;function numFormatEU(t,e=0){let r=p.get(e);return r||(r=i.default({truncate:e,padRight:e,integerSeparator:".",decimal:","}),p.set(e,r)),r(t)}const w=new Map;function numFormatUS(t,e=0){let r=w.get(e);return r||(r=i.default({truncate:e,padRight:e,integerSeparator:",",decimal:"."}),w.set(e,r)),r(t)}const g=/(?<dd>[0-3][0-9])(?<mm>[0-1][0-9])(?<yy>[0-9]{2}).?(?<id>[0-9]{4})/g;function parseSocialSecurityNumberDK(t){const e=t.match(regexMatcherToValidater(g));if(!e||!e.groups)throw new Error(`Invalid Danish social security number format. Expected ddmmyy[-]xxxx. Got: ${t}`);const{dd:r,mm:n,yy:o,id:s}=e.groups,i=parseInt(r),a=parseInt(n),l=getCurrentYear(),u=parseInt(o)>parseInt(String(l).substring(2))?parseInt(`${getCentury(l)-2}${o}`):parseInt(`${getCentury(l)-1}${o}`);assertValidDateDay(i,a,u),assertValidDateMonth(a);return{year:u,month:a,day:i,id:parseInt(s),sex:isEven(parseInt(s.substring(3)))?"F":"M"}}
/*! *****************************************************************************
  Copyright (c) Microsoft Corporation.

  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.

  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** */
function __awaiter(t,e,r,n){return new(r||(r=Promise))((function(o,s){function fulfilled(t){try{step(n.next(t))}catch(t){s(t)}}function rejected(t){try{step(n.throw(t))}catch(t){s(t)}}function step(t){t.done?o(t.value):function adopt(t){return t instanceof r?t:new r((function(e){e(t)}))}(t.value).then(fulfilled,rejected)}step((n=n.apply(t,e||[])).next())}))}function __values(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function __asyncValues(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=__values(t),e={},verb("next"),verb("throw"),verb("return"),e[Symbol.asyncIterator]=function(){return this},e);function verb(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function settle(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}}function strIsLowerCase(t){return t===t.toLowerCase()}function strIsUpperCase(t){return t===t.toUpperCase()}const y=/\d((\.|\d)*)?/g,b=/\b[^\W]+/g;function strCountCharOccurances(t,e){if(1!==e.length)throw new Error("Expected char to be a single character string of length 1.");let r=0;for(const n of t)n===e&&r++;return r}function strRepeat(t,e){return new Array(e).fill(t).join("")}function strLinesTrimRight(t){return t.replace(/\s+\n/gm,"\n")}function strLinesRemoveEmpty(t){return t.replace(/\n\r?\s*\n\r?/gm,"\n").trimStart().trimEnd()}const toIntMB=t=>Math.floor(1e-6*t),getMemoryUsageFormatted=t=>{const e=process.memoryUsage();return{processAllocationMB:t(e.rss),heapAllocationMB:t(e.heapTotal),heapUsedMB:t(e.heapUsed),extenalV8:t(e.external)}};function normalizeFileExtension(t){if(""===t||"."===t)return"";if(/[<>"|?*:]/g.test(t))throw new Error(`Illegal characters in file extension: ${t}  |  Illegal characters are: <>"|?:*`);return 0===strCountCharOccurances(t,".")?"."+t:t.substring(t.lastIndexOf("."))}class StringStream extends s.Readable{constructor(t){super(),this.str=t,this.ended=!1}_read(){this.ended||(process.nextTick((()=>{this.push(Buffer.from(this.str)),this.push(null)})),this.ended=!0)}}t.A1ToColRow=A1ToColRow,t.Base=Base,t.ExtensibleFunction=class ExtensibleFunction extends Function{constructor(t,e){return Object.defineProperty(e,"name",{value:t}),super(e),Object.setPrototypeOf(e,new.target.prototype)}},t.Matrix=Matrix,t.SortedArray=class SortedArray extends Array{constructor(t={}){if(super(),this.compare=compareString,this.compareFound=!1,this.allowDuplicates=!0,Object.defineProperty(this,"compare",{enumerable:!1}),Object.defineProperty(this,"compareFound",{enumerable:!1}),Object.defineProperty(this,"allowDuplicates",{enumerable:!1}),t.compare&&(this.compare=t.compare,this.compareFound=!0),t.data){for(const e of t.data)this.push(e);!this.compareFound&&this.length&&"string"!=typeof this[0]&&(this.compare=compareNumeric,this.compareFound=!0),e.sort(this,this.compare)}!1===t.allowDuplicates&&(this.allowDuplicates=!1,this.unique())}toArray(){return Array.from(this)}add(t){if(this.compareFound||"string"!=typeof t&&(this.compare=compareNumeric,this.compareFound=!0),0===this.length)return this.push(t),this;const[e,r]=this.insertionIndex(t);return r&&!this.allowDuplicates||this.splice(e,0,t),this}addMany(...t){if(0===t.length)return this;for(const e of t)this.add(e);return this}unique(){let t=this.length;if(t<=1)return this;for(let e,r,n=1;n<t;n++)e=this[n-1],r=this[n],0===this.compare(e,r)&&(this.splice(n,1),t--,n--);return this}insertionIndex(t){if(0===this.length)return[0,!1];let e=0,r=this.length;for(;e<r;){const n=e+r>>>1,o=this.compare(this[n],t);if(0===o)return[n,!0];o<0?e=n+1:r=n}return[e,!1]}firstInsertionIndex(t){const[e,r]=this.insertionIndex(t);if(!r)return[e,r];let n=e-1;for(;n>=0;){if(0!==this.compare(this[n],t))return[n+1,r];n--}return[0,r]}lastInsertionIndex(t){const[e,r]=this.insertionIndex(t);if(!r)return[e,r];let n=e+1;for(;n<this.length;){if(0!==this.compare(this[n],t))return[n,r];n++}return[this.length,r]}indexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.insertionIndex(t);return r?e:-1}firstIndexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.firstInsertionIndex(t);return r?e:-1}lastIndexOfCompare(t){if(0===this.length)return-1;if(1===this.length)return 0===this.compare(this[0],t)?0:-1;const[e,r]=this.lastInsertionIndex(t);return r?e-1:-1}indicesOfCompare(t){const e=this.indexOfCompare(t);if(-1===e)return[];const r=[];if(!this.allowDuplicates)return r;let n=e-1;for(;n>=0&&0===this.compare(this[n],t);)r.push(n),n--;for(r.push(e),n=e+1;n<this.length&&0===this.compare(this[n],t);)r.push(n),n++;return r.sort(compareNumber),r}intersection(t){const e=[];let r=0,n=0;for(;r<this.length&&n<t.length;)this.compare(this[r],t[n])<0?r++:0===this.compare(this[r],t[n])?(e.push(this[r]),r++,n++):n++;return e}},t.StringStream=StringStream,t.Table=Table,t.Timer=class Timer{constructor(){this.t0=Date.now()}stop(){return Date.now()-this.t0}},t.alphaToCol=letterToCol,t.arr2dToCSV=arr2dToCSV,t.arrAssignFrom=arrAssignFrom,t.arrEvery=arrEvery,t.arrFilterMutable=function arrFilterMutable(t,e){return arrAssignFrom(t,t.filter(e))},t.arrFlatten=arrFlatten,t.arrFlattenMutable=function arrFlattenMutable(t,e=Number.MAX_SAFE_INTEGER){return arrAssignFrom(t,arrFlatten(t,e))},t.arrIndicesOf=function arrIndicesOf(t,e){const r=[];for(let n=0;n<t.length;n++)e===t[n]&&r.push(n);return r},t.arrMapMutable=arrMapMutable,t.arrShallowEquals=arrShallowEquals,t.arrShuffle=function arrShuffle(t){const e=t.slice();let r=!0;for(;r;){for(let e=0,r=t.length;e<r;e++){arrSwap(t,e,Math.floor(Math.random()*r))}r=arrShallowEquals(t,e)}return t},t.arrSome=function arrSome(t,e){for(let r=0,n=t.length;r<n;r++)if(!0===e(t[r],r,t))return!0;return!1},t.arrSortNumeric=function arrSortNumeric(t){return t.sort(compareNumeric)},t.arrSwap=arrSwap,t.assertValidDateDay=assertValidDateDay,t.assertValidDateMonth=assertValidDateMonth,t.assertValidDateYear=assertValidDateYear,t.bytesToInt=function bytesToInt(t){return 1===t.length&&t[0]<251?t[0]:2===t.length&&251===t[0]?251+t[1]:3===t.length&&252===t[0]?251+256*t[1]+t[2]:4===t.length&&253===t[0]?251+65536*t[1]+256*t[2]+t[3]:5===t.length&&254===t[0]?251+16777216*t[1]+65536*t[2]+256*t[3]+t[4]:t.length>5&&255===t[0]?(()=>{let e=0,r=1;const n=Math.max(2,t.length-6);for(let o=t.length-1;o>=n;o--)e+=r*t[o],r*=256;const o=t[1]+32<251?bytesToInt([t[1]+32])-11:255===t[0]&&t[1]<251?t[1]+21:3===n?bytesToInt([t[1],t[2]+21]):4===n?bytesToInt([t[1],t[2],t[3]+21]):0,s=251+e/Math.pow(2,32-o);if(!Number.isInteger(s))throw new Error(`Invalid bytes. Got [${t.join(", ")}] = ${s}`);if(s>1099511627776)throw new Error(`Bytes must correspond to an integer less than or equal to 256^5. Got [${t.join(", ")}] = ${s}`);return s})():(()=>{throw new Error(`Invalid first byte. Got length: ${t.length}, and bytes: [${t.join(", ")}]`)})()},t.colRowToA1=function colRowToA1(t,e=!1){if(2!==t.length)throw new Error(`Expected CR to to be length 2. Got: ${t.length}`);if(!Number.isInteger(t[1]))throw new Error(`Expected row to be an integer. Got: ${t[1]}`);if(t[1]<1)throw new Error(`Expected row to be greater than zero. Got: ${t[1]}`);return function colToLetter(t,e=!1){e&&t++;const r=d.get(t);if(r)return r;if(!Number.isInteger(t))throw new Error(`Expected col to be an integer. Got: ${t}`);if(t<1)throw new Error(`Expected col to be greater than zero. Got: ${t}`);let n,o="";for(;t>0;)n=(t-1)%26,o=String.fromCharCode(n+65)+o,t=(t-n-1)/26;return o}(t[0],e)+t[1].toString()},t.compareArray=function compareArray(t,e=!1){const r=e?-1:1;function recursiveCompare(e,n,o){const s=Array.isArray(e),i=Array.isArray(n);if(!s){if(i)return-1*r;{const r=t(e,n);return 0===r&&o||r}}if(!i)return 1*r;{const t=e.length,o=n.length;let s,i;t>o?(s=t,i=1*r):t<o?(s=o,i=-1*r):(s=t,i=0);for(let t=0,r=s;t<r;t++){const r=recursiveCompare(e[t],n[t],i);if(0!==r)return r}}return 0}return(t,e)=>recursiveCompare(t,e)},t.compareNumber=compareNumber,t.compareNumberDescending=function compareNumberDescending(t,e){return e-t},t.compareNumeric=compareNumeric,t.compareNumericDescending=function compareNumericDescending(t,e){return t>e?-1:t<e?1:0},t.compareString=compareString,t.compareStringDescending=function compareStringDescending(t,e){return e.localeCompare(t)},t.createFileExtensionFilter=function createFileExtensionFilter(...t){return t.length?e=>{for(const r of t.map(normalizeFileExtension))if(a.default.extname(e)===r)return!0;return!1}:()=>!0},t.ensureValidWindowsPath=function ensureValidWindowsPath(t,e){const throwOrFalse=r=>{if(e&&!0===e.assert)throw new Error(`Invalid windows path. ${r}  |  input received: ${t}`);return!1};if(0===t.length)return throwOrFalse("Path string is length 0.");if(strCountCharOccurances(t,"/")>0&&strCountCharOccurances(t,"\\")>0)return throwOrFalse("Path contains both backslash and forward slash.");const r=(e&&e.extendedMaxLength?32767:260)-12;if(t.length>r)return throwOrFalse(`Maximum length of ${r} exceeded`);let n=t;return/^\w:(\\|\/)/g.test(t)&&(n=t.substring(2)),/[<>"|?*:]/g.test(n)?throwOrFalse(`Illegal characters in: ${t}  |  Illegal characters are: <>"|?:*`):!/(\\|\/)(CON|PRN|AUX|NUL|COM[1-9]|LPT[1-9])((\\|\/)|$)/g.test(t)||throwOrFalse("Illegal name in path string")},t.getCentury=getCentury,t.getCurrentYear=getCurrentYear,t.getMemoryUsage=function getMemoryUsage(){const t=process.memoryUsage();return{processAllocationMB:toIntMB(t.rss),heapAllocationMB:toIntMB(t.heapTotal),heapUsedMB:toIntMB(t.heapUsed),extenalV8:toIntMB(t.external)}},t.getMemoryUsageFormattedEU=function getMemoryUsageFormattedEU(){return getMemoryUsageFormatted((t=>`${numFormatEU(1e-6*t,2)} MB`))},t.getMemoryUsageFormattedUS=function getMemoryUsageFormattedUS(){return getMemoryUsageFormatted((t=>`${numFormatUS(1e-6*t,2)} MB`))},t.getWorkingDirPath=function getWorkingDirPath(...t){return a.default.join(process.cwd(),...t)},t.htmlTableTo2dArray=function htmlTableTo2dArray(t,e=!0){const r=[],n=t.querySelectorAll("tr");for(let t=0;t<n.length;t++){const o=n[t],s=[],i=o.querySelectorAll(e?"th,td":"td");for(let t=0;t<i.length;t++){const e=i[t];s.push(e.innerText.trim())}!e&&o.querySelectorAll("th").length||s.length&&r.push(s)}return r},t.intToBytes=function intToBytes(t){if(!Number.isInteger(t)||t<0)throw new Error(`input must be a positive integer. Got ${t}`);if(t>1099511627776)throw new Error(`input must be less than or equal to 256^5. Got ${t}`);const e=t-251;return t<251?[t]:e<256?[251,e]:e<65536?[252,Math.floor(e/256),e%256]:e<16777216?[253,Math.floor(e/65536),Math.floor(e/256)%256,e%256]:e<4294967296?[254,Math.floor(e/16777216),Math.floor(e/65536)%256,Math.floor(e/256)%256,e%256]:(()=>{const t=Math.floor(Math.log(e)/Math.log(2))-32,r=[255,...intToBytes(t)],n=Math.floor(e/Math.pow(2,t-11));for(let t=5,e=1099511627776;t>=0;t--,e/=256)r.push(Math.floor(n/e)%256);return r})()},t.isConstructor=isConstructor,t.isEven=isEven,t.isHex=function isHex(t){return/[\da-f]+$/i.test(t)},t.isHexOrUnicode=function isHexOrUnicode(t){return/^(\\\\?u|0x)?[\da-f]+$/i.test(t)},t.isLeapYear=isLeapYear,t.isObject=isObject,t.isOdd=function isOdd(t){if(!Number.isInteger(t))throw new Error(`Expected integer. Got ${t}`);return t%2!=0},t.isPrototype=isPrototype,t.isSocialSecurityNumberDK=function isSocialSecurityNumberDK(t){try{return parseSocialSecurityNumberDK(t),!0}catch(t){return!1}},t.isValidDateDay=isValidDateDay,t.isValidDateMonth=isValidDateMonth,t.isValidDateYear=isValidDateYear,t.iteratePrototypeChain=iteratePrototypeChain,t.normalizeFileExtension=normalizeFileExtension,t.numApproximateLog10=function numApproximateLog10(t){if(!Number.isInteger(t)||t<0||t>=1e10)throw new Error(`Expected positive integer smaller than 10^10. Got ${t}`);return t<m[5]?t<m[2]?t<m[1]?0:1:t<m[4]?t<m[3]?2:3:4:t<m[7]?t<m[6]?5:6:t<m[9]?t<m[8]?7:8:9},t.numDaysInMonth=numDaysInMonth,t.numFormatEU=numFormatEU,t.numFormatUS=numFormatUS,t.parseSocialSecurityNumberDK=parseSocialSecurityNumberDK,t.randomIntBetween=function randomIntBetween(t,e){if(!Number.isInteger(t))throw new Error(`min must be an integer. Got ${t}`);if(!Number.isInteger(e))throw new Error(`max must be an integer. Got ${e}`);return Math.floor(Math.random()*(e-t+1)+t)},t.readFileStringSync=function readFileStringSync(t){return l.default.readFileSync(t,"utf8").toString()},t.regexEscapeString=regexEscapeString,t.regexGetGroupNames=function regexGetGroupNames(t){const e=[];for(const r of rexec(/\(\?<(?<name>\w+)>/g,t.toString()))e.push(r.groups.name);return e},t.regexMatchSocialSecurityNumberDK=g,t.regexMatcherToValidater=regexMatcherToValidater,t.rexec=rexec,t.round=function round(t,e=0){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)+0},t.roundDown=function roundDown(t){return Math.floor(t)},t.roundUp=function roundUp(t){return Math.ceil(t)+0},t.setEnumerable=function setEnumerable(t,...e){for(const r of e)Object.defineProperty(t,r,{enumerable:!0})},t.setIntersection=function setIntersection(t){const e=new Set(t[0].values());for(let r=1;r<t.length;r++)for(const n of e.values())t[r].has(n)||e.delete(n);return e},t.setNonConfigurable=function setNonConfigurable(t,...e){for(const r of e)Object.defineProperty(t,r,{configurable:!1})},t.setNonEnumerable=setNonEnumerable,t.setNonEnumerablePrivateProperties=setNonEnumerablePrivateProperties,t.setNonWritable=function setNonWritable(t,...e){for(const r of e)Object.defineProperty(t,r,{writable:!1})},t.setUnion=function setUnion(t){const e=new Set(t[0].values());for(let r=1;r<t.length;r++)for(const n of t[r].values())e.add(n);return e},t.setWritable=function setWritable(t,...e){for(const r of e)Object.defineProperty(t,r,{writable:!0})},t.solveSudoku=function solveSudoku(t){const e=new Sudoku(t);return e.solve(),e},t.strCountCharOccurances=strCountCharOccurances,t.strIsLowerCase=strIsLowerCase,t.strIsUpperCase=strIsUpperCase,t.strLinesRemoveEmpty=strLinesRemoveEmpty,t.strLinesTrimLeft=function strLinesTrimLeft(t){return t.replace(/\n\r?\s+/gm,"\n")},t.strLinesTrimRight=strLinesTrimRight,t.strPrettifyMinifiedCode=function strPrettifyMinifiedCode(t,e="  "){const getIndents=t=>strRepeat("\t",t);let r=0;return strLinesTrimRight(strLinesRemoveEmpty(Array.from(t).map((t=>"{"===t?(r++,"{\n"+getIndents(r)):"}"===t?(r--,"\n"+getIndents(r)+"}\n"+getIndents(r)):";"===t?";\n"+getIndents(r):t)).join(""))).replace(/\t +/g,"\t").replace(/\t/g,e)},t.strRepeat=strRepeat,t.strReplaceAll=function strReplaceAll(t,e,r,n="g"){return t.replace(new RegExp(regexEscapeString(e),n),r)},t.strSplitWordByCamelCase=function strSplitWordByCamelCase(t){function isCamelCaseWordBreakIndex(t,e){return strIsLowerCase(t[e-1])&&strIsUpperCase(t[e])&&!y.test(t[e-1])&&!y.test(t[e])}const e=[],r=t.length-1;let n=0,o=!1;for(let s=1;s<t.length;s++)if(o&&s===r){const r=t.substring(n);r&&e.push(r)}else if(isCamelCaseWordBreakIndex(t,s)){const r=t.substring(n,s);if(!r)continue;e.push(r),n=s,o=!0}return o||e.push(t),e},t.strToWords=function strToWords(t){return t.match(b)||[]},t.strWrapBetween=function strWrapBetween(t,e,r){return e+t+r},t.strWrapIn=function strWrapIn(t,e){return e+t+e},t.strWrapInAngleBrackets=function strWrapInAngleBrackets(t){return"<"+t+">"},t.strWrapInBraces=function strWrapInBraces(t){return"{"+t+"}"},t.strWrapInBrackets=function strWrapInBrackets(t){return"["+t+"]"},t.strWrapInDoubleQuotes=function strWrapInDoubleQuotes(t){return'"'+t+'"'},t.strWrapInParenthesis=function strWrapInParenthesis(t){return"("+t+")"},t.strWrapInSingleQuotes=function strWrapInSingleQuotes(t){return"'"+t+"'"},t.streamToString=function streamToString(t){var e,r,n,o,s,i,a;return __awaiter(this,void 0,void 0,(function*(){const l=[];try{for(e=!0,r=__asyncValues(t);n=yield r.next(),!(o=n.done);){a=n.value,e=!1;try{const t=a;l.push(Buffer.from(t).toString())}finally{e=!0}}}catch(t){s={error:t}}finally{try{e||o||!(i=r.return)||(yield i.call(r))}finally{if(s)throw s.error}}return l.join("")}))},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
